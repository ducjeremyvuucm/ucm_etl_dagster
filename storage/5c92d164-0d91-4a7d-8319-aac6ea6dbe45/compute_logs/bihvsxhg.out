2023-12-22 08:53:40 [46mplatform[0m > Docker volume job log path: /tmp/workspace/292/0/logs.log
2023-12-22 08:53:40 [46mplatform[0m > Executing worker wrapper. Airbyte version: 0.50.35
2023-12-22 08:53:40 [46mplatform[0m > Attempt 0 to save workflow id for cancellation
2023-12-22 08:53:40 [46mplatform[0m > start sync worker. job id: 292 attempt id: 0
2023-12-22 08:53:40 [46mplatform[0m > 
2023-12-22 08:53:40 [46mplatform[0m > ----- START REPLICATION -----
2023-12-22 08:53:40 [46mplatform[0m > 
2023-12-22 08:53:40 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_LIMIT: '2.0'
2023-12-22 08:53:40 [46mplatform[0m > Running destination...
2023-12-22 08:53:40 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_LIMIT: '2.0'
2023-12-22 08:53:40 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_REQUEST: '0.1'
2023-12-22 08:53:40 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_REQUEST: '0.1'
2023-12-22 08:53:40 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_LIMIT: '2.0'
2023-12-22 08:53:40 [46mplatform[0m > Using default value for environment variable LAUNCHDARKLY_KEY: ''
2023-12-22 08:53:40 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_LIMIT: '2.0'
2023-12-22 08:53:40 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_REQUEST: '0.1'
2023-12-22 08:53:40 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_REQUEST: '0.1'
2023-12-22 08:53:40 [46mplatform[0m > Using default value for environment variable LAUNCHDARKLY_KEY: ''
2023-12-22 08:53:40 [46mplatform[0m > Checking if airbyte/destination-bigquery:2.3.16 exists...
2023-12-22 08:53:40 [46mplatform[0m > Checking if airbyte/source-declarative-manifest:0.55.2 exists...
2023-12-22 08:53:40 [46mplatform[0m > airbyte/destination-bigquery:2.3.16 was found locally.
2023-12-22 08:53:40 [46mplatform[0m > Creating docker container = destination-bigquery-write-292-0-kfucs with resources io.airbyte.config.ResourceRequirements@f8a6ece[cpuRequest=,cpuLimit=,memoryRequest=,memoryLimit=,additionalProperties={}] and allowedHosts null
2023-12-22 08:53:40 [46mplatform[0m > airbyte/source-declarative-manifest:0.55.2 was found locally.
2023-12-22 08:53:40 [46mplatform[0m > Preparing command: docker run --rm --init -i -w /data/292/0 --log-driver none --name destination-bigquery-write-292-0-kfucs --network host -v airbyte_workspace:/data -v /tmp/airbyte_local:/local -e DEPLOYMENT_MODE=OSS -e WORKER_CONNECTOR_IMAGE=airbyte/destination-bigquery:2.3.16 -e AUTO_DETECT_SCHEMA=true -e LAUNCHDARKLY_KEY= -e SOCAT_KUBE_CPU_REQUEST=0.1 -e SOCAT_KUBE_CPU_LIMIT=2.0 -e FIELD_SELECTION_WORKSPACES= -e USE_STREAM_CAPABLE_STATE=true -e WORKER_ENVIRONMENT=DOCKER -e AIRBYTE_ROLE= -e APPLY_FIELD_SELECTION=false -e WORKER_JOB_ATTEMPT=0 -e OTEL_COLLECTOR_ENDPOINT=http://host.docker.internal:4317 -e FEATURE_FLAG_CLIENT=config -e AIRBYTE_VERSION=0.50.35 -e WORKER_JOB_ID=292 airbyte/destination-bigquery:2.3.16 write --config destination_config.json --catalog destination_catalog.json
2023-12-22 08:53:40 [46mplatform[0m > Creating docker container = source-declarative-manifest-read-292-0-paahd with resources io.airbyte.config.ResourceRequirements@19c1178d[cpuRequest=,cpuLimit=,memoryRequest=,memoryLimit=,additionalProperties={}] and allowedHosts null
2023-12-22 08:53:40 [46mplatform[0m > Preparing command: docker run --rm --init -i -w /data/292/0 --log-driver none --name source-declarative-manifest-read-292-0-paahd -e CONCURRENT_SOURCE_STREAM_READ=false --network host -v airbyte_workspace:/data -v /tmp/airbyte_local:/local -e DEPLOYMENT_MODE=OSS -e WORKER_CONNECTOR_IMAGE=airbyte/source-declarative-manifest:0.55.2 -e AUTO_DETECT_SCHEMA=true -e LAUNCHDARKLY_KEY= -e SOCAT_KUBE_CPU_REQUEST=0.1 -e SOCAT_KUBE_CPU_LIMIT=2.0 -e FIELD_SELECTION_WORKSPACES= -e USE_STREAM_CAPABLE_STATE=true -e WORKER_ENVIRONMENT=DOCKER -e AIRBYTE_ROLE= -e APPLY_FIELD_SELECTION=false -e WORKER_JOB_ATTEMPT=0 -e OTEL_COLLECTOR_ENDPOINT=http://host.docker.internal:4317 -e FEATURE_FLAG_CLIENT=config -e AIRBYTE_VERSION=0.50.35 -e WORKER_JOB_ID=292 airbyte/source-declarative-manifest:0.55.2 read --config source_config.json --catalog source_catalog.json
2023-12-22 08:53:40 [46mplatform[0m > Writing messages to protocol version 0.2.0
2023-12-22 08:53:40 [46mplatform[0m > Reading messages from protocol version 0.2.0
2023-12-22 08:53:40 [46mplatform[0m > Reading messages from protocol version 0.2.0
2023-12-22 08:53:40 [46mplatform[0m > readFromSource: start
2023-12-22 08:53:40 [46mplatform[0m > readFromDestination: start
2023-12-22 08:53:40 [46mplatform[0m > processMessage: start
2023-12-22 08:53:40 [46mplatform[0m > writeToDestination: start
2023-12-22 08:53:40 [46mplatform[0m > Starting source heartbeat check. Will check every 1 minutes.
2023-12-22 08:53:43 [43mdestination[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 08:53:43 [43mdestination[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 08:53:43 [43mdestination[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 08:53:43 [43mdestination[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 08:53:44 [44msource[0m > Starting syncing ManifestDeclarativeSource
2023-12-22 08:53:44 [44msource[0m > Marking stream payables as STARTED
2023-12-22 08:53:44 [44msource[0m > Syncing stream: payables 
2023-12-22 08:53:45 [43mdestination[0m > 2023-12-22 08:53:45 [32mINFO[m i.a.c.i.b.IntegrationCliParser(parseOptions):126 - integration args: {catalog=destination_catalog.json, write=null, config=destination_config.json}
2023-12-22 08:53:45 [43mdestination[0m > 2023-12-22 08:53:45 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):132 - Running integration: io.airbyte.integrations.destination.bigquery.BigQueryDestination
2023-12-22 08:53:45 [44msource[0m > Marking stream payables as RUNNING
2023-12-22 08:53:45 [43mdestination[0m > 2023-12-22 08:53:45 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):133 - Command: WRITE
2023-12-22 08:53:45 [43mdestination[0m > 2023-12-22 08:53:45 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):134 - Integration config: IntegrationConfig{command=WRITE, configPath='destination_config.json', catalogPath='destination_catalog.json', statePath='null'}
2023-12-22 08:53:45 [43mdestination[0m > 2023-12-22 08:53:45 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword groups - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 08:53:45 [43mdestination[0m > 2023-12-22 08:53:45 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword group - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 08:53:45 [43mdestination[0m > 2023-12-22 08:53:45 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword order - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 08:53:45 [43mdestination[0m > 2023-12-22 08:53:45 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword display_type - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 08:53:45 [43mdestination[0m > 2023-12-22 08:53:45 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword airbyte_secret - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 08:53:45 [43mdestination[0m > 2023-12-22 08:53:45 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword always_show - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 08:53:45 [43mdestination[0m > 2023-12-22 08:53:45 [32mINFO[m i.a.i.d.b.BigQueryUtils(getLoadingMethod):426 - Selected loading method is set to: GCS
2023-12-22 08:53:45 [43mdestination[0m > 2023-12-22 08:53:45 [32mINFO[m i.a.c.i.d.s.S3FormatConfigs(getS3FormatConfig):22 - S3 format config: {"format_type":"CSV","flattening":"No flattening"}
2023-12-22 08:53:45 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 08:53:45 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 08:53:45 [43mdestination[0m > 2023-12-22 08:53:45 [32mINFO[m i.a.i.d.b.BigQueryUtils(isKeepFilesInGcs):442 - All tmp files will be removed from GCS when replication is finished
2023-12-22 08:53:47 [43mdestination[0m > 2023-12-22 08:53:47 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$createWriteConfigs$1):114 - BigQuery write config: BigQueryWriteConfig[streamName=spendesk_payables, namespace=sources, datasetId=airbyte_internal, datasetLocation=europe-west3, tmpTableId=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=_airbyte_tmp_rsu_spendesk_payables}}, targetTableId=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}, tableSchema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, syncMode=overwrite]
2023-12-22 08:53:47 [43mdestination[0m > 2023-12-22 08:53:47 [32mINFO[m i.a.c.i.d.b.BufferManager(<init>):53 - Max 'memory' available for buffer allocation 2 GB
2023-12-22 08:53:47 [43mdestination[0m > 2023-12-22 08:53:47 [32mINFO[m i.a.c.i.d.FlushWorkers(start):98 - Start async buffer supervisor
2023-12-22 08:53:47 [43mdestination[0m > 2023-12-22 08:53:47 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 08:53:47 [43mdestination[0m > 2023-12-22 08:53:47 [32mINFO[m i.a.c.i.d.AsyncStreamConsumer(start):137 - class io.airbyte.cdk.integrations.destination_async.AsyncStreamConsumer started.
2023-12-22 08:53:47 [43mdestination[0m > 2023-12-22 08:53:47 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onStartFunction$3):137 - Preparing airbyte_raw tables in destination started for 1 streams
2023-12-22 08:53:47 [43mdestination[0m > 2023-12-22 08:53:47 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(prepareTables):108 - Preparing final tables
2023-12-22 08:53:47 [43mdestination[0m > 2023-12-22 08:53:47 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 08:53:47 [43mdestination[0m > 2023-12-22 08:53:47 [32mINFO[m i.a.i.b.d.t.BaseDestinationV1V2Migrator(migrateIfNecessary):26 - Assessing whether migration is necessary for stream spendesk_payables
2023-12-22 08:53:47 [43mdestination[0m > 2023-12-22 08:53:47 [32mINFO[m i.a.i.b.d.t.BaseDestinationV1V2Migrator(shouldMigrate):45 - Checking whether v1 raw table _airbyte_raw_spendesk_payables in dataset sources exists
2023-12-22 08:53:49 [43mdestination[0m > 2023-12-22 08:53:49 [32mINFO[m i.a.i.b.d.t.BaseDestinationV1V2Migrator(shouldMigrate):49 - Migration Info: Required for Sync mode: false, No existing v2 raw tables: false, A v1 raw table exists: false
2023-12-22 08:53:49 [43mdestination[0m > 2023-12-22 08:53:49 [32mINFO[m i.a.i.b.d.t.BaseDestinationV1V2Migrator(migrateIfNecessary):32 - No Migration Required for stream: spendesk_payables
2023-12-22 08:53:49 [43mdestination[0m > 2023-12-22 08:53:49 [32mINFO[m i.a.i.d.b.t.BigQueryV2TableMigrator(migrateIfNecessary):76 - No Data column Migration Required for stream sources_raw__stream_spendesk_payables
2023-12-22 08:53:49 [43mdestination[0m > 2023-12-22 08:53:49 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$prepareTablesFuture$1):129 - Final Table exists for stream spendesk_payables
2023-12-22 08:53:50 [43mdestination[0m > 2023-12-22 08:53:50 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):99 - Executing sql c84703da-2744-4ab4-a112-6c5a888a35e5: CREATE SCHEMA IF NOT EXISTS `reporting-340722`.`sources`
2023-12-22 08:53:50 [43mdestination[0m > OPTIONS(location="europe-west3");
2023-12-22 08:53:50 [43mdestination[0m > 
2023-12-22 08:53:50 [43mdestination[0m > CREATE OR REPLACE TABLE `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` (
2023-12-22 08:53:50 [43mdestination[0m >   _airbyte_raw_id STRING NOT NULL,
2023-12-22 08:53:50 [43mdestination[0m >   _airbyte_extracted_at TIMESTAMP NOT NULL,
2023-12-22 08:53:50 [43mdestination[0m >   _airbyte_meta JSON NOT NULL,
2023-12-22 08:53:50 [43mdestination[0m > `id` STRING,
2023-12-22 08:53:50 [43mdestination[0m > `type` STRING,
2023-12-22 08:53:50 [43mdestination[0m > `amount` NUMERIC,
2023-12-22 08:53:50 [43mdestination[0m > `teamId` STRING,
2023-12-22 08:53:50 [43mdestination[0m > `userId` STRING,
2023-12-22 08:53:50 [43mdestination[0m > `currency` STRING,
2023-12-22 08:53:50 [43mdestination[0m > `teamName` STRING,
2023-12-22 08:53:50 [43mdestination[0m > `companyId` STRING,
2023-12-22 08:53:50 [43mdestination[0m > `lineItems` JSON,
2023-12-22 08:53:50 [43mdestination[0m > `exportedAt` STRING,
2023-12-22 08:53:50 [43mdestination[0m > `allocations` JSON,
2023-12-22 08:53:50 [43mdestination[0m > `description` STRING,
2023-12-22 08:53:50 [43mdestination[0m > `payableDate` STRING,
2023-12-22 08:53:50 [43mdestination[0m > `costCenterId` STRING,
2023-12-22 08:53:50 [43mdestination[0m > `counterparty` JSON,
2023-12-22 08:53:50 [43mdestination[0m > `invoiceNumber` STRING,
2023-12-22 08:53:50 [43mdestination[0m > `costCenterName` STRING,
2023-12-22 08:53:50 [43mdestination[0m > `invoiceDueDate` STRING,
2023-12-22 08:53:50 [43mdestination[0m > `functionalAmount` NUMERIC,
2023-12-22 08:53:50 [43mdestination[0m > `bookkeepingStatus` STRING,
2023-12-22 08:53:50 [43mdestination[0m > `functionalCurrency` STRING,
2023-12-22 08:53:50 [43mdestination[0m > `documentaryEvidence` JSON,
2023-12-22 08:53:50 [43mdestination[0m > `analyticalProperties` JSON,
2023-12-22 08:53:50 [43mdestination[0m > `functionalExchangeRate` NUMERIC
2023-12-22 08:53:50 [43mdestination[0m > )
2023-12-22 08:53:50 [43mdestination[0m > PARTITION BY (DATE_TRUNC(_airbyte_extracted_at, DAY))
2023-12-22 08:53:50 [43mdestination[0m > CLUSTER BY `_airbyte_extracted_at`;
2023-12-22 08:53:50 [43mdestination[0m > 
2023-12-22 08:53:51 [43mdestination[0m > 2023-12-22 08:53:51 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):119 - Root-level job c84703da-2744-4ab4-a112-6c5a888a35e5 completed in 1025 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 08:53:51 [43mdestination[0m > 2023-12-22 08:53:51 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql CREATE SCHEMA IF NOT EXISTS `reporting-340722`.`sources` OPTIONS(location="europe-west3")... completed in 86 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 08:53:51 [43mdestination[0m > 2023-12-22 08:53:51 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql CREATE OR REPLACE TABLE `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` ( _airbyte_raw_... completed in 124 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 08:53:51 [43mdestination[0m > 2023-12-22 08:53:51 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$prepareTablesFuture$1):138 - Using temp final table for stream spendesk_payables, will overwrite existing table at end of sync
2023-12-22 08:53:52 [43mdestination[0m > 2023-12-22 08:53:52 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onStartFunction$3):140 - Preparing staging are in destination for schema: Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, stream: spendesk_payables, target table: GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}, stage: spendesk_payables
2023-12-22 08:53:52 [43mdestination[0m > 2023-12-22 08:53:52 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(createSchemaIfNotExists):86 - Creating dataset airbyte_internal
2023-12-22 08:53:52 [43mdestination[0m > 2023-12-22 08:53:52 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(createTableIfNotExists):102 - Creating target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}
2023-12-22 08:53:53 [43mdestination[0m > 2023-12-22 08:53:53 [32mINFO[m i.a.i.d.b.BigQueryUtils(createPartitionedTableIfNotExists):228 - Partitioned table ALREADY EXISTS: GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}
2023-12-22 08:53:53 [43mdestination[0m > 2023-12-22 08:53:53 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(createStageIfNotExists):109 - Creating staging path for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/
2023-12-22 08:53:53 [43mdestination[0m > 2023-12-22 08:53:53 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(truncateTableIfExists):207 - Truncating target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal)
2023-12-22 08:53:53 [43mdestination[0m > 2023-12-22 08:53:53 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(dropTableIfExists):175 - Deleting target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal)
2023-12-22 08:53:53 [43mdestination[0m > 2023-12-22 08:53:53 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(createTableIfNotExists):102 - Creating target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}
2023-12-22 08:53:53 [43mdestination[0m > 2023-12-22 08:53:53 [32mINFO[m i.a.i.d.b.BigQueryUtils(createPartitionedTableIfNotExists):231 - Partitioned table created successfully: GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}
2023-12-22 08:53:53 [43mdestination[0m > 2023-12-22 08:53:53 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onStartFunction$3):159 - Preparing tables in destination completed.
2023-12-22 08:53:57 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 08:53:57 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 08:54:08 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 08:54:08 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 08:54:19 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 08:54:19 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 08:54:30 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 08:54:30 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 08:54:41 [44msource[0m > Giving up _send(...) after 6 tries (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 08:54:41 [44msource[0m > Max retry limit reached. Request: <PreparedRequest [GET]>, Response: <Response [500]>
2023-12-22 08:54:41 [44msource[0m > Encountered an exception while reading stream payables
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 121, in read
    yield from self._read_stream(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 193, in _read_stream
    for record in record_iterator:
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 253, in _read_full_refresh
    for record_data_or_message in stream_instance.read_full_refresh(configured_stream.cursor_field, logger, self._slice_logger):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/streams/core.py", line 121, in read_full_refresh
    yield from self.read_records(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/declarative_stream.py", line 104, in read_records
    yield from self.retriever.read_records(stream_slice)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 304, in read_records
    for stream_data in self._read_pages(self._parse_records, self.state, stream_slice):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 282, in _read_pages
    response = self._fetch_next_page(stream_state, stream_slice, next_page_token)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 256, in _fetch_next_page
    return self.requester.send_request(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 412, in send_request
    response = self._send_with_retry(request, log_formatter=log_formatter)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 458, in _send_with_retry
    return backoff_handler(user_backoff_handler)(request, log_formatter=log_formatter)  # type: ignore
  File "/usr/local/lib/python3.9/site-packages/backoff/_sync.py", line 105, in retry
    ret = target(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/backoff/_sync.py", line 105, in retry
    ret = target(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 497, in _send
    raise UserDefinedBackoffException(backoff=custom_backoff_time, request=request, response=response)
airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]}
2023-12-22 08:54:41 [44msource[0m > Marking stream payables as STOPPED
2023-12-22 08:54:41 [44msource[0m > Finished syncing payables
2023-12-22 08:54:41 [44msource[0m > ManifestDeclarativeSource runtimes:
Syncing stream payables 0:00:57.048689
2023-12-22 08:54:41 [44msource[0m > Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]}
Traceback (most recent call last):
  File "/airbyte/integration_code/main.py", line 29, in <module>
    launch(source, sys.argv[1:])
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py", line 210, in launch
    for message in source_entrypoint.run(parsed_args):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py", line 117, in run
    yield from map(AirbyteEntrypoint.airbyte_message_to_string, self.read(source_spec, config, config_catalog, state))
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py", line 159, in read
    yield from self.source.read(self.logger, config, catalog, state)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/manifest_declarative_source.py", line 134, in read
    yield from super().read(logger, config, catalog, state)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 141, in read
    raise e
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 121, in read
    yield from self._read_stream(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 193, in _read_stream
    for record in record_iterator:
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 253, in _read_full_refresh
    for record_data_or_message in stream_instance.read_full_refresh(configured_stream.cursor_field, logger, self._slice_logger):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/streams/core.py", line 121, in read_full_refresh
    yield from self.read_records(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/declarative_stream.py", line 104, in read_records
    yield from self.retriever.read_records(stream_slice)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 304, in read_records
    for stream_data in self._read_pages(self._parse_records, self.state, stream_slice):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 282, in _read_pages
    response = self._fetch_next_page(stream_state, stream_slice, next_page_token)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 256, in _fetch_next_page
    return self.requester.send_request(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 412, in send_request
    response = self._send_with_retry(request, log_formatter=log_formatter)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 458, in _send_with_retry
    return backoff_handler(user_backoff_handler)(request, log_formatter=log_formatter)  # type: ignore
  File "/usr/local/lib/python3.9/site-packages/backoff/_sync.py", line 105, in retry
    ret = target(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/backoff/_sync.py", line 105, in retry
    ret = target(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 497, in _send
    raise UserDefinedBackoffException(backoff=custom_backoff_time, request=request, response=response)
airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]}
2023-12-22 08:54:41 [46mplatform[0m > readFromSource: source exception
io.airbyte.workers.internal.exception.SourceException: Source process exited with non-zero exit code 1
	at io.airbyte.workers.general.BufferedReplicationWorker.readFromSource(BufferedReplicationWorker.java:365) ~[io.airbyte-airbyte-commons-worker-0.50.35.jar:?]
	at io.airbyte.workers.general.BufferedReplicationWorker.lambda$runAsyncWithHeartbeatCheck$3(BufferedReplicationWorker.java:235) ~[io.airbyte-airbyte-commons-worker-0.50.35.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[?:?]
	at java.lang.Thread.run(Thread.java:1589) ~[?:?]
2023-12-22 08:54:41 [46mplatform[0m > readFromSource: done. (source.isFinished:true, fromSource.isClosed:false)
2023-12-22 08:54:47 [43mdestination[0m > 2023-12-22 08:54:47 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 08:54:47 [43mdestination[0m > 2023-12-22 08:54:47 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 08:55:47 [43mdestination[0m > 2023-12-22 08:55:47 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 08:55:47 [43mdestination[0m > 2023-12-22 08:55:47 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 08:56:47 [43mdestination[0m > 2023-12-22 08:56:47 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 08:56:47 [43mdestination[0m > 2023-12-22 08:56:47 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 08:57:47 [43mdestination[0m > 2023-12-22 08:57:47 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 08:57:47 [43mdestination[0m > 2023-12-22 08:57:47 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 08:58:47 [43mdestination[0m > 2023-12-22 08:58:47 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 08:58:47 [43mdestination[0m > 2023-12-22 08:58:47 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m i.a.c.i.d.DetectStreamToFlush(getNextStreamToFlush):122 - flushing: trigger info: sources - spendesk_payables, time trigger: true , size trigger: false current threshold b: 200 MB, queue size b: 34.09 KB, penalty b: 0 bytes, after penalty b: 34.09 KB
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):152 - Flush Worker (13cec) -- Worker picked up work.
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):154 - Flush Worker (13cec) -- Attempting to read from queue namespace: sources, stream: spendesk_payables.
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 10450847 bytes..
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):167 - Flush Worker (13cec) -- Batch contains: 29 records, 34.09 KB bytes.
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m i.a.c.i.d.r.BaseSerializedBuffer(flush):172 - Finished writing data to baba7473-ecbf-49ea-aa00-e1e78234989a546132737287665118.csv.gz (5 KB)
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m i.a.i.d.b.BigQueryAsyncFlush(flush):61 - Flushing CSV buffer for stream spendesk_payables (5 KB) to staging
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(uploadRecordsToStage):116 - Uploading records to staging for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m a.m.s.StreamTransferManager(getMultiPartOutputStreams):329 - Initiated multipart upload to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/f103a4de-ae2f-4c52-89d4-9978d37bfd8b.csv.gz with full ID ABPnzm5gH8Hlm5FLSSuvXEfczJDxoPYXc62vKEWkJrlScJ7E1EId0NO62dI__GKTTyUTHG7V
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m a.m.s.MultiPartOutputStream(close):158 - Called close() on [MultipartOutputStream for parts 1 - 10000]
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m a.m.s.StreamTransferManager(complete):367 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/f103a4de-ae2f-4c52-89d4-9978d37bfd8b.csv.gz with id ABPnzm5gH...TTyUTHG7V]: Uploading leftover stream [Part number 1 containing 0.01 MB]
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m a.m.s.StreamTransferManager(uploadStreamPart):558 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/f103a4de-ae2f-4c52-89d4-9978d37bfd8b.csv.gz with id ABPnzm5gH...TTyUTHG7V]: Finished uploading [Part number 1 containing 0.01 MB]
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m a.m.s.StreamTransferManager(complete):395 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/f103a4de-ae2f-4c52-89d4-9978d37bfd8b.csv.gz with id ABPnzm5gH...TTyUTHG7V]: Completed
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(loadDataIntoBucket):214 - Uploaded buffer file to storage: baba7473-ecbf-49ea-aa00-e1e78234989a546132737287665118.csv.gz -> ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/f103a4de-ae2f-4c52-89d4-9978d37bfd8b.csv.gz (filename: f103a4de-ae2f-4c52-89d4-9978d37bfd8b.csv.gz)
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(uploadRecordsToBucket):131 - Successfully loaded records to stage ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/ with 0 re-attempt(s)
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):134 - Uploading records from staging files to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): f103a4de-ae2f-4c52-89d4-9978d37bfd8b.csv.gz
2023-12-22 08:58:55 [43mdestination[0m > 2023-12-22 08:58:55 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):138 - Uploading staged file: gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/f103a4de-ae2f-4c52-89d4-9978d37bfd8b.csv.gz
2023-12-22 08:58:56 [43mdestination[0m > 2023-12-22 08:58:56 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):147 - [JobId{project=reporting-340722, job=bf3eb330-fab7-4035-b026-96ad43944513, location=europe-west3}] Created a new job to upload record(s) to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): Job{job=JobId{project=reporting-340722, job=bf3eb330-fab7-4035-b026-96ad43944513, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703235536267, endTime=null, startTime=1703235536389, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=9MmcOCJz5P4MQX5eyUmx+Q==, generatedId=reporting-340722:europe-west3.bf3eb330-fab7-4035-b026-96ad43944513, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/bf3eb330-fab7-4035-b026-96ad43944513?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/f103a4de-ae2f-4c52-89d4-9978d37bfd8b.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}
2023-12-22 08:58:56 [43mdestination[0m > 2023-12-22 08:58:56 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):451 - Waiting for job finish Job{job=JobId{project=reporting-340722, job=bf3eb330-fab7-4035-b026-96ad43944513, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703235536267, endTime=null, startTime=1703235536389, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=9MmcOCJz5P4MQX5eyUmx+Q==, generatedId=reporting-340722:europe-west3.bf3eb330-fab7-4035-b026-96ad43944513, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/bf3eb330-fab7-4035-b026-96ad43944513?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/f103a4de-ae2f-4c52-89d4-9978d37bfd8b.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}. Status: JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 08:58:58 [43mdestination[0m > 2023-12-22 08:58:58 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):453 - Job finish Job{job=JobId{project=reporting-340722, job=bf3eb330-fab7-4035-b026-96ad43944513, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703235536267, endTime=null, startTime=1703235536389, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=9MmcOCJz5P4MQX5eyUmx+Q==, generatedId=reporting-340722:europe-west3.bf3eb330-fab7-4035-b026-96ad43944513, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/bf3eb330-fab7-4035-b026-96ad43944513?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/f103a4de-ae2f-4c52-89d4-9978d37bfd8b.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}} with status JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 08:58:58 [43mdestination[0m > 2023-12-22 08:58:58 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):152 - [JobId{project=reporting-340722, job=bf3eb330-fab7-4035-b026-96ad43944513, location=europe-west3}] Target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal) is successfully appended with staging files
2023-12-22 08:58:58 [43mdestination[0m > 2023-12-22 08:58:58 [32mINFO[m i.a.c.i.d.r.FileBuffer(deleteFile):109 - Deleting tempFile data baba7473-ecbf-49ea-aa00-e1e78234989a546132737287665118.csv.gz
2023-12-22 08:58:58 [43mdestination[0m > 2023-12-22 08:58:58 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 08:58:58 [43mdestination[0m > 2023-12-22 08:58:58 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 34913 bytes..
2023-12-22 08:58:58 [43mdestination[0m > 2023-12-22 08:58:58 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):176 - Flush Worker (13cec) -- Worker finished flushing. Current queue size: 0
2023-12-22 08:59:47 [43mdestination[0m > 2023-12-22 08:59:47 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 08:59:47 [43mdestination[0m > 2023-12-22 08:59:47 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:00:47 [43mdestination[0m > 2023-12-22 09:00:47 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:00:47 [43mdestination[0m > 2023-12-22 09:00:47 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:01:47 [43mdestination[0m > 2023-12-22 09:01:47 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:01:47 [43mdestination[0m > 2023-12-22 09:01:47 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:02:47 [43mdestination[0m > 2023-12-22 09:02:47 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:02:47 [43mdestination[0m > 2023-12-22 09:02:47 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:03:47 [43mdestination[0m > 2023-12-22 09:03:47 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:03:47 [43mdestination[0m > 2023-12-22 09:03:47 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [32mINFO[m i.a.c.i.d.DetectStreamToFlush(getNextStreamToFlush):122 - flushing: trigger info: sources - spendesk_payables, time trigger: true , size trigger: false current threshold b: 200 MB, queue size b: 0 bytes, penalty b: 0 bytes, after penalty b: 0 bytes
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):152 - Flush Worker (78ccc) -- Worker picked up work.
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):154 - Flush Worker (78ccc) -- Attempting to read from queue namespace: sources, stream: spendesk_payables.
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):167 - Flush Worker (78ccc) -- Batch contains: 0 records, 0 bytes bytes.
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [33mWARN[m i.a.c.i.d.s.c.CsvSerializedBuffer(flushWriter):85 - Trying to flush but no printer is initialized.
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [33mWARN[m i.a.c.i.d.s.c.CsvSerializedBuffer(closeWriter):95 - Trying to close but no printer is initialized.
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [32mINFO[m i.a.c.i.d.r.BaseSerializedBuffer(flush):172 - Finished writing data to 2fb61798-5667-49ff-98de-6e35491d35d713782378065326636155.csv.gz (0 bytes)
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [32mINFO[m i.a.i.d.b.BigQueryAsyncFlush(flush):61 - Flushing CSV buffer for stream spendesk_payables (0 bytes) to staging
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(uploadRecordsToStage):116 - Uploading records to staging for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [32mINFO[m a.m.s.StreamTransferManager(getMultiPartOutputStreams):329 - Initiated multipart upload to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/715cd7c3-f68d-423c-959f-41c08050ee95.csv.gz with full ID ABPnzm5eqt5YNmdAQM9rhQWIe-xcFulcen-cF8Vp8K9B8Kd2R6iM50oObTbko7TkT6G9dUrB
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [32mINFO[m a.m.s.MultiPartOutputStream(close):158 - Called close() on [MultipartOutputStream for parts 1 - 10000]
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [32mINFO[m a.m.s.StreamTransferManager(complete):395 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/715cd7c3-f68d-423c-959f-41c08050ee95.csv.gz with id ABPnzm5eq...kT6G9dUrB]: Completed
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(loadDataIntoBucket):214 - Uploaded buffer file to storage: 2fb61798-5667-49ff-98de-6e35491d35d713782378065326636155.csv.gz -> ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/715cd7c3-f68d-423c-959f-41c08050ee95.csv.gz (filename: 715cd7c3-f68d-423c-959f-41c08050ee95.csv.gz)
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(uploadRecordsToBucket):131 - Successfully loaded records to stage ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/ with 0 re-attempt(s)
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):134 - Uploading records from staging files to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): 715cd7c3-f68d-423c-959f-41c08050ee95.csv.gz
2023-12-22 09:03:55 [43mdestination[0m > 2023-12-22 09:03:55 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):138 - Uploading staged file: gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/715cd7c3-f68d-423c-959f-41c08050ee95.csv.gz
2023-12-22 09:03:56 [43mdestination[0m > 2023-12-22 09:03:56 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):147 - [JobId{project=reporting-340722, job=62437272-9273-40e3-935b-d9b668bf01d2, location=europe-west3}] Created a new job to upload record(s) to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): Job{job=JobId{project=reporting-340722, job=62437272-9273-40e3-935b-d9b668bf01d2, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703235836196, endTime=null, startTime=1703235836318, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=eusWib4Sk3BHcww9xP285A==, generatedId=reporting-340722:europe-west3.62437272-9273-40e3-935b-d9b668bf01d2, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/62437272-9273-40e3-935b-d9b668bf01d2?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/715cd7c3-f68d-423c-959f-41c08050ee95.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}
2023-12-22 09:03:56 [43mdestination[0m > 2023-12-22 09:03:56 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):451 - Waiting for job finish Job{job=JobId{project=reporting-340722, job=62437272-9273-40e3-935b-d9b668bf01d2, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703235836196, endTime=null, startTime=1703235836318, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=eusWib4Sk3BHcww9xP285A==, generatedId=reporting-340722:europe-west3.62437272-9273-40e3-935b-d9b668bf01d2, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/62437272-9273-40e3-935b-d9b668bf01d2?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/715cd7c3-f68d-423c-959f-41c08050ee95.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}. Status: JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:03:59 [43mdestination[0m > 2023-12-22 09:03:59 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):453 - Job finish Job{job=JobId{project=reporting-340722, job=62437272-9273-40e3-935b-d9b668bf01d2, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703235836196, endTime=null, startTime=1703235836318, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=eusWib4Sk3BHcww9xP285A==, generatedId=reporting-340722:europe-west3.62437272-9273-40e3-935b-d9b668bf01d2, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/62437272-9273-40e3-935b-d9b668bf01d2?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/715cd7c3-f68d-423c-959f-41c08050ee95.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}} with status JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:03:59 [43mdestination[0m > 2023-12-22 09:03:59 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):152 - [JobId{project=reporting-340722, job=62437272-9273-40e3-935b-d9b668bf01d2, location=europe-west3}] Target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal) is successfully appended with staging files
2023-12-22 09:03:59 [43mdestination[0m > 2023-12-22 09:03:59 [32mINFO[m i.a.c.i.d.r.FileBuffer(deleteFile):109 - Deleting tempFile data 2fb61798-5667-49ff-98de-6e35491d35d713782378065326636155.csv.gz
2023-12-22 09:03:59 [43mdestination[0m > 2023-12-22 09:03:59 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:03:59 [43mdestination[0m > 2023-12-22 09:03:59 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:03:59 [43mdestination[0m > 2023-12-22 09:03:59 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):176 - Flush Worker (78ccc) -- Worker finished flushing. Current queue size: 0
2023-12-22 09:04:47 [43mdestination[0m > 2023-12-22 09:04:47 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:04:47 [43mdestination[0m > 2023-12-22 09:04:47 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:04:47 [46mplatform[0m > processMessage: done. (fromSource.isDone:true, forDest.isClosed:false)
2023-12-22 09:04:47 [46mplatform[0m > writeToDestination: done. (forDest.isDone:true, isDestRunning:true)
2023-12-22 09:04:47 [46mplatform[0m > thread status... timeout thread: false , replication thread: true
2023-12-22 09:04:47 [43mdestination[0m > 2023-12-22 09:04:47 [32mINFO[m i.a.c.i.d.FlushWorkers(close):191 - Closing flush workers -- waiting for all buffers to flush
2023-12-22 09:04:47 [43mdestination[0m > 2023-12-22 09:04:47 [32mINFO[m i.a.c.i.d.FlushWorkers(close):216 - REMAINING_BUFFERS_INFO
2023-12-22 09:04:47 [43mdestination[0m >   Namespace: sources Stream: spendesk_payables -- remaining records: 1
2023-12-22 09:04:47 [43mdestination[0m > 2023-12-22 09:04:47 [32mINFO[m i.a.c.i.d.FlushWorkers(close):217 - Waiting for all streams to flush.
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m i.a.c.i.d.DetectStreamToFlush(getNextStreamToFlush):122 - flushing: trigger info: sources - spendesk_payables, time trigger: false , size trigger: true current threshold b: 0 bytes, queue size b: 1.1 KB, penalty b: 0 bytes, after penalty b: 1.1 KB
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):152 - Flush Worker (7e451) -- Worker picked up work.
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):154 - Flush Worker (7e451) -- Attempting to read from queue namespace: sources, stream: spendesk_payables.
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 10484632 bytes..
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):167 - Flush Worker (7e451) -- Batch contains: 1 records, 1.1 KB bytes.
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m i.a.c.i.d.r.BaseSerializedBuffer(flush):172 - Finished writing data to 099e19e4-ca67-43be-a205-ea833d4b27c317853331972622228767.csv.gz (606 bytes)
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m i.a.i.d.b.BigQueryAsyncFlush(flush):61 - Flushing CSV buffer for stream spendesk_payables (606 bytes) to staging
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(uploadRecordsToStage):116 - Uploading records to staging for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m a.m.s.StreamTransferManager(getMultiPartOutputStreams):329 - Initiated multipart upload to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/fd39ed65-8c26-4f56-8936-ceea36a21df8.csv.gz with full ID ABPnzm5uLwWe1wea0noj5F7oeriRoc6TzF6jcmczw4HuhrZn9E6BEtjCh_ECaaoc_5fNrjr2
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m a.m.s.MultiPartOutputStream(close):158 - Called close() on [MultipartOutputStream for parts 1 - 10000]
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m a.m.s.StreamTransferManager(complete):367 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/fd39ed65-8c26-4f56-8936-ceea36a21df8.csv.gz with id ABPnzm5uL...c_5fNrjr2]: Uploading leftover stream [Part number 1 containing 0.00 MB]
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m i.a.c.i.d.FlushWorkers(close):220 - Closing flush workers -- all buffers flushed
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m i.a.c.i.d.FlushWorkers(close):226 - Closing flush workers -- Supervisor shutdown status: true
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m i.a.c.i.d.FlushWorkers(close):228 - Closing flush workers -- Starting worker pool shutdown..
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m a.m.s.StreamTransferManager(uploadStreamPart):558 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/fd39ed65-8c26-4f56-8936-ceea36a21df8.csv.gz with id ABPnzm5uL...c_5fNrjr2]: Finished uploading [Part number 1 containing 0.00 MB]
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m a.m.s.StreamTransferManager(complete):395 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/fd39ed65-8c26-4f56-8936-ceea36a21df8.csv.gz with id ABPnzm5uL...c_5fNrjr2]: Completed
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(loadDataIntoBucket):214 - Uploaded buffer file to storage: 099e19e4-ca67-43be-a205-ea833d4b27c317853331972622228767.csv.gz -> ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/fd39ed65-8c26-4f56-8936-ceea36a21df8.csv.gz (filename: fd39ed65-8c26-4f56-8936-ceea36a21df8.csv.gz)
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(uploadRecordsToBucket):131 - Successfully loaded records to stage ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/ with 0 re-attempt(s)
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):134 - Uploading records from staging files to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): fd39ed65-8c26-4f56-8936-ceea36a21df8.csv.gz
2023-12-22 09:04:48 [43mdestination[0m > 2023-12-22 09:04:48 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):138 - Uploading staged file: gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/fd39ed65-8c26-4f56-8936-ceea36a21df8.csv.gz
2023-12-22 09:04:49 [43mdestination[0m > 2023-12-22 09:04:49 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):147 - [JobId{project=reporting-340722, job=ff0e32ac-2899-41be-84d8-436107c7181c, location=europe-west3}] Created a new job to upload record(s) to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): Job{job=JobId{project=reporting-340722, job=ff0e32ac-2899-41be-84d8-436107c7181c, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703235889071, endTime=null, startTime=1703235889196, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=o+osU94lfKJbYNTEtSfyGg==, generatedId=reporting-340722:europe-west3.ff0e32ac-2899-41be-84d8-436107c7181c, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/ff0e32ac-2899-41be-84d8-436107c7181c?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/fd39ed65-8c26-4f56-8936-ceea36a21df8.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}
2023-12-22 09:04:49 [43mdestination[0m > 2023-12-22 09:04:49 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):451 - Waiting for job finish Job{job=JobId{project=reporting-340722, job=ff0e32ac-2899-41be-84d8-436107c7181c, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703235889071, endTime=null, startTime=1703235889196, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=o+osU94lfKJbYNTEtSfyGg==, generatedId=reporting-340722:europe-west3.ff0e32ac-2899-41be-84d8-436107c7181c, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/ff0e32ac-2899-41be-84d8-436107c7181c?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/fd39ed65-8c26-4f56-8936-ceea36a21df8.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}. Status: JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:04:51 [43mdestination[0m > 2023-12-22 09:04:51 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):453 - Job finish Job{job=JobId{project=reporting-340722, job=ff0e32ac-2899-41be-84d8-436107c7181c, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703235889071, endTime=null, startTime=1703235889196, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=o+osU94lfKJbYNTEtSfyGg==, generatedId=reporting-340722:europe-west3.ff0e32ac-2899-41be-84d8-436107c7181c, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/ff0e32ac-2899-41be-84d8-436107c7181c?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/fd39ed65-8c26-4f56-8936-ceea36a21df8.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}} with status JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:04:51 [43mdestination[0m > 2023-12-22 09:04:51 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):152 - [JobId{project=reporting-340722, job=ff0e32ac-2899-41be-84d8-436107c7181c, location=europe-west3}] Target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal) is successfully appended with staging files
2023-12-22 09:04:51 [43mdestination[0m > 2023-12-22 09:04:51 [32mINFO[m i.a.c.i.d.r.FileBuffer(deleteFile):109 - Deleting tempFile data 099e19e4-ca67-43be-a205-ea833d4b27c317853331972622228767.csv.gz
2023-12-22 09:04:51 [43mdestination[0m > 2023-12-22 09:04:51 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:04:51 [43mdestination[0m > 2023-12-22 09:04:51 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 1128 bytes..
2023-12-22 09:04:51 [43mdestination[0m > 2023-12-22 09:04:51 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):176 - Flush Worker (7e451) -- Worker finished flushing. Current queue size: 0
2023-12-22 09:04:51 [43mdestination[0m > 2023-12-22 09:04:51 [32mINFO[m i.a.c.i.d.FlushWorkers(close):231 - Closing flush workers -- Workers shutdown status: true
2023-12-22 09:04:51 [43mdestination[0m > 2023-12-22 09:04:51 [32mINFO[m i.a.c.i.d.b.BufferManager(close):92 - Buffers cleared..
2023-12-22 09:04:51 [43mdestination[0m > 2023-12-22 09:04:51 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(typeAndDedupe):242 - Typing and deduping all tables
2023-12-22 09:04:51 [43mdestination[0m > 2023-12-22 09:04:51 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$typeAndDedupeTask$2):216 - Waiting for raw table writes to pause for sources.spendesk_payables
2023-12-22 09:04:51 [43mdestination[0m > 2023-12-22 09:04:51 [32mINFO[m i.a.i.b.d.t.TypeAndDedupeTransaction(executeTypeAndDedupe):36 - Attempting typing and deduping for sources.spendesk_payables with suffix
2023-12-22 09:04:51 [43mdestination[0m > 2023-12-22 09:04:51 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):99 - Executing sql f4b2a522-a5d5-452a-a197-11cd5704cbe3: BEGIN TRANSACTION;
2023-12-22 09:04:51 [43mdestination[0m > INSERT INTO `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp`
2023-12-22 09:04:51 [43mdestination[0m > (
2023-12-22 09:04:51 [43mdestination[0m > `id`,
2023-12-22 09:04:51 [43mdestination[0m > `type`,
2023-12-22 09:04:51 [43mdestination[0m > `amount`,
2023-12-22 09:04:51 [43mdestination[0m > `teamId`,
2023-12-22 09:04:51 [43mdestination[0m > `userId`,
2023-12-22 09:04:51 [43mdestination[0m > `currency`,
2023-12-22 09:04:51 [43mdestination[0m > `teamName`,
2023-12-22 09:04:51 [43mdestination[0m > `companyId`,
2023-12-22 09:04:51 [43mdestination[0m > `lineItems`,
2023-12-22 09:04:51 [43mdestination[0m > `exportedAt`,
2023-12-22 09:04:51 [43mdestination[0m > `allocations`,
2023-12-22 09:04:51 [43mdestination[0m > `description`,
2023-12-22 09:04:51 [43mdestination[0m > `payableDate`,
2023-12-22 09:04:51 [43mdestination[0m > `costCenterId`,
2023-12-22 09:04:51 [43mdestination[0m > `counterparty`,
2023-12-22 09:04:51 [43mdestination[0m > `invoiceNumber`,
2023-12-22 09:04:51 [43mdestination[0m > `costCenterName`,
2023-12-22 09:04:51 [43mdestination[0m > `invoiceDueDate`,
2023-12-22 09:04:51 [43mdestination[0m > `functionalAmount`,
2023-12-22 09:04:51 [43mdestination[0m > `bookkeepingStatus`,
2023-12-22 09:04:51 [43mdestination[0m > `functionalCurrency`,
2023-12-22 09:04:51 [43mdestination[0m > `documentaryEvidence`,
2023-12-22 09:04:51 [43mdestination[0m > `analyticalProperties`,
2023-12-22 09:04:51 [43mdestination[0m > `functionalExchangeRate`,
2023-12-22 09:04:51 [43mdestination[0m >   _airbyte_meta,
2023-12-22 09:04:51 [43mdestination[0m >   _airbyte_raw_id,
2023-12-22 09:04:51 [43mdestination[0m >   _airbyte_extracted_at
2023-12-22 09:04:51 [43mdestination[0m > )
2023-12-22 09:04:51 [43mdestination[0m > WITH intermediate_data AS (
2023-12-22 09:04:51 [43mdestination[0m >   SELECT
2023-12-22 09:04:51 [43mdestination[0m > (CASE
2023-12-22 09:04:51 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."id"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."id"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:04:51 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."id"')
2023-12-22 09:04:51 [43mdestination[0m >     ELSE
2023-12-22 09:04:51 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."id"')
2023-12-22 09:04:51 [43mdestination[0m >   END)
2023-12-22 09:04:51 [43mdestination[0m >  as `id`,
2023-12-22 09:04:51 [43mdestination[0m > (CASE
2023-12-22 09:04:51 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."type"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."type"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:04:51 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."type"')
2023-12-22 09:04:51 [43mdestination[0m >     ELSE
2023-12-22 09:04:51 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."type"')
2023-12-22 09:04:51 [43mdestination[0m >   END)
2023-12-22 09:04:51 [43mdestination[0m >  as `type`,
2023-12-22 09:04:51 [43mdestination[0m > CAST(JSON_VALUE(`_airbyte_data`, '$."amount"') as NUMERIC) as `amount`,
2023-12-22 09:04:51 [43mdestination[0m > (CASE
2023-12-22 09:04:51 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."teamId"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."teamId"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:04:51 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."teamId"')
2023-12-22 09:04:51 [43mdestination[0m >     ELSE
2023-12-22 09:04:51 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."teamId"')
2023-12-22 09:04:51 [43mdestination[0m >   END)
2023-12-22 09:04:51 [43mdestination[0m >  as `teamId`,
2023-12-22 09:04:51 [43mdestination[0m > (CASE
2023-12-22 09:04:51 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."userId"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."userId"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:04:51 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."userId"')
2023-12-22 09:04:51 [43mdestination[0m >     ELSE
2023-12-22 09:04:51 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."userId"')
2023-12-22 09:04:51 [43mdestination[0m >   END)
2023-12-22 09:04:51 [43mdestination[0m >  as `userId`,
2023-12-22 09:04:51 [43mdestination[0m > (CASE
2023-12-22 09:04:51 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."currency"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."currency"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:04:51 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."currency"')
2023-12-22 09:04:51 [43mdestination[0m >     ELSE
2023-12-22 09:04:51 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."currency"')
2023-12-22 09:04:51 [43mdestination[0m >   END)
2023-12-22 09:04:51 [43mdestination[0m >  as `currency`,
2023-12-22 09:04:51 [43mdestination[0m > (CASE
2023-12-22 09:04:51 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."teamName"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."teamName"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:04:51 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."teamName"')
2023-12-22 09:04:51 [43mdestination[0m >     ELSE
2023-12-22 09:04:51 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."teamName"')
2023-12-22 09:04:51 [43mdestination[0m >   END)
2023-12-22 09:04:51 [43mdestination[0m >  as `teamName`,
2023-12-22 09:04:51 [43mdestination[0m > (CASE
2023-12-22 09:04:51 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."companyId"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."companyId"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:04:51 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."companyId"')
2023-12-22 09:04:51 [43mdestination[0m >     ELSE
2023-12-22 09:04:51 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."companyId"')
2023-12-22 09:04:51 [43mdestination[0m >   END)
2023-12-22 09:04:51 [43mdestination[0m >  as `companyId`,
2023-12-22 09:04:51 [43mdestination[0m > PARSE_JSON(CASE
2023-12-22 09:04:51 [43mdestination[0m >   WHEN JSON_QUERY(`_airbyte_data`, '$."lineItems"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >     OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."lineItems"'), wide_number_mode=>'round')) != 'array'
2023-12-22 09:04:51 [43mdestination[0m >     THEN NULL
2023-12-22 09:04:51 [43mdestination[0m >   ELSE JSON_QUERY(`_airbyte_data`, '$."lineItems"')
2023-12-22 09:04:51 [43mdestination[0m > END, wide_number_mode=>'round')
2023-12-22 09:04:51 [43mdestination[0m >  as `lineItems`,
2023-12-22 09:04:51 [43mdestination[0m > (CASE
2023-12-22 09:04:51 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."exportedAt"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."exportedAt"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:04:51 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."exportedAt"')
2023-12-22 09:04:51 [43mdestination[0m >     ELSE
2023-12-22 09:04:51 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."exportedAt"')
2023-12-22 09:04:51 [43mdestination[0m >   END)
2023-12-22 09:04:51 [43mdestination[0m >  as `exportedAt`,
2023-12-22 09:04:51 [43mdestination[0m > PARSE_JSON(CASE
2023-12-22 09:04:51 [43mdestination[0m >   WHEN JSON_QUERY(`_airbyte_data`, '$."allocations"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >     OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."allocations"'), wide_number_mode=>'round')) != 'array'
2023-12-22 09:04:51 [43mdestination[0m >     THEN NULL
2023-12-22 09:04:51 [43mdestination[0m >   ELSE JSON_QUERY(`_airbyte_data`, '$."allocations"')
2023-12-22 09:04:51 [43mdestination[0m > END, wide_number_mode=>'round')
2023-12-22 09:04:51 [43mdestination[0m >  as `allocations`,
2023-12-22 09:04:51 [43mdestination[0m > (CASE
2023-12-22 09:04:51 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."description"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."description"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:04:51 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."description"')
2023-12-22 09:04:51 [43mdestination[0m >     ELSE
2023-12-22 09:04:51 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."description"')
2023-12-22 09:04:51 [43mdestination[0m >   END)
2023-12-22 09:04:51 [43mdestination[0m >  as `description`,
2023-12-22 09:04:51 [43mdestination[0m > (CASE
2023-12-22 09:04:51 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."payableDate"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."payableDate"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:04:51 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."payableDate"')
2023-12-22 09:04:51 [43mdestination[0m >     ELSE
2023-12-22 09:04:51 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."payableDate"')
2023-12-22 09:04:51 [43mdestination[0m >   END)
2023-12-22 09:04:51 [43mdestination[0m >  as `payableDate`,
2023-12-22 09:04:51 [43mdestination[0m > (CASE
2023-12-22 09:04:51 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."costCenterId"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."costCenterId"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:04:51 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."costCenterId"')
2023-12-22 09:04:51 [43mdestination[0m >     ELSE
2023-12-22 09:04:51 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."costCenterId"')
2023-12-22 09:04:51 [43mdestination[0m >   END)
2023-12-22 09:04:51 [43mdestination[0m >  as `costCenterId`,
2023-12-22 09:04:51 [43mdestination[0m > PARSE_JSON(CASE
2023-12-22 09:04:51 [43mdestination[0m >   WHEN JSON_QUERY(`_airbyte_data`, '$."counterparty"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >     OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."counterparty"'), wide_number_mode=>'round')) != 'object'
2023-12-22 09:04:51 [43mdestination[0m >     THEN NULL
2023-12-22 09:04:51 [43mdestination[0m >   ELSE JSON_QUERY(`_airbyte_data`, '$."counterparty"')
2023-12-22 09:04:51 [43mdestination[0m > END, wide_number_mode=>'round')
2023-12-22 09:04:51 [43mdestination[0m >  as `counterparty`,
2023-12-22 09:04:51 [43mdestination[0m > (CASE
2023-12-22 09:04:51 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."invoiceNumber"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."invoiceNumber"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:04:51 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."invoiceNumber"')
2023-12-22 09:04:51 [43mdestination[0m >     ELSE
2023-12-22 09:04:51 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."invoiceNumber"')
2023-12-22 09:04:51 [43mdestination[0m >   END)
2023-12-22 09:04:51 [43mdestination[0m >  as `invoiceNumber`,
2023-12-22 09:04:51 [43mdestination[0m > (CASE
2023-12-22 09:04:51 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."costCenterName"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."costCenterName"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:04:51 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."costCenterName"')
2023-12-22 09:04:51 [43mdestination[0m >     ELSE
2023-12-22 09:04:51 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."costCenterName"')
2023-12-22 09:04:51 [43mdestination[0m >   END)
2023-12-22 09:04:51 [43mdestination[0m >  as `costCenterName`,
2023-12-22 09:04:51 [43mdestination[0m > (CASE
2023-12-22 09:04:51 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."invoiceDueDate"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."invoiceDueDate"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:04:51 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."invoiceDueDate"')
2023-12-22 09:04:51 [43mdestination[0m >     ELSE
2023-12-22 09:04:51 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."invoiceDueDate"')
2023-12-22 09:04:51 [43mdestination[0m >   END)
2023-12-22 09:04:51 [43mdestination[0m >  as `invoiceDueDate`,
2023-12-22 09:04:51 [43mdestination[0m > CAST(JSON_VALUE(`_airbyte_data`, '$."functionalAmount"') as NUMERIC) as `functionalAmount`,
2023-12-22 09:04:51 [43mdestination[0m > (CASE
2023-12-22 09:04:51 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."bookkeepingStatus"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."bookkeepingStatus"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:04:51 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."bookkeepingStatus"')
2023-12-22 09:04:51 [43mdestination[0m >     ELSE
2023-12-22 09:04:51 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."bookkeepingStatus"')
2023-12-22 09:04:51 [43mdestination[0m >   END)
2023-12-22 09:04:51 [43mdestination[0m >  as `bookkeepingStatus`,
2023-12-22 09:04:51 [43mdestination[0m > (CASE
2023-12-22 09:04:51 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."functionalCurrency"') IS NULL
2023-12-22 09:04:51 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."functionalCurrency"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:04:51 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."functionalCurrency"')
2023-12-22 09:04:51 [43mdestination[0m >     ELSE
2023-12-22 09:04:52 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."functionalCurrency"')
2023-12-22 09:04:52 [43mdestination[0m >   END)
2023-12-22 09:04:52 [43mdestination[0m >  as `functionalCurrency`,
2023-12-22 09:04:52 [43mdestination[0m > PARSE_JSON(CASE
2023-12-22 09:04:52 [43mdestination[0m >   WHEN JSON_QUERY(`_airbyte_data`, '$."documentaryEvidence"') IS NULL
2023-12-22 09:04:52 [43mdestination[0m >     OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."documentaryEvidence"'), wide_number_mode=>'round')) != 'object'
2023-12-22 09:04:52 [43mdestination[0m >     THEN NULL
2023-12-22 09:04:52 [43mdestination[0m >   ELSE JSON_QUERY(`_airbyte_data`, '$."documentaryEvidence"')
2023-12-22 09:04:52 [43mdestination[0m > END, wide_number_mode=>'round')
2023-12-22 09:04:52 [43mdestination[0m >  as `documentaryEvidence`,
2023-12-22 09:04:52 [43mdestination[0m > PARSE_JSON(CASE
2023-12-22 09:04:52 [43mdestination[0m >   WHEN JSON_QUERY(`_airbyte_data`, '$."analyticalProperties"') IS NULL
2023-12-22 09:04:52 [43mdestination[0m >     OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."analyticalProperties"'), wide_number_mode=>'round')) != 'array'
2023-12-22 09:04:52 [43mdestination[0m >     THEN NULL
2023-12-22 09:04:52 [43mdestination[0m >   ELSE JSON_QUERY(`_airbyte_data`, '$."analyticalProperties"')
2023-12-22 09:04:52 [43mdestination[0m > END, wide_number_mode=>'round')
2023-12-22 09:04:52 [43mdestination[0m >  as `analyticalProperties`,
2023-12-22 09:04:52 [43mdestination[0m > CAST(JSON_VALUE(`_airbyte_data`, '$."functionalExchangeRate"') as NUMERIC) as `functionalExchangeRate`,
2023-12-22 09:04:52 [43mdestination[0m >   [] AS column_errors,
2023-12-22 09:04:52 [43mdestination[0m >   _airbyte_raw_id,
2023-12-22 09:04:52 [43mdestination[0m >   _airbyte_extracted_at
2023-12-22 09:04:52 [43mdestination[0m >   FROM `reporting-340722`.`airbyte_internal`.`sources_raw__stream_spendesk_payables`
2023-12-22 09:04:52 [43mdestination[0m >   WHERE
2023-12-22 09:04:52 [43mdestination[0m >     _airbyte_loaded_at IS NULL
2023-12-22 09:04:52 [43mdestination[0m >      AND _airbyte_extracted_at > '2023-12-19T22:02:25.177Z'
2023-12-22 09:04:52 [43mdestination[0m > )
2023-12-22 09:04:52 [43mdestination[0m > SELECT
2023-12-22 09:04:52 [43mdestination[0m > `id`,
2023-12-22 09:04:52 [43mdestination[0m > `type`,
2023-12-22 09:04:52 [43mdestination[0m > `amount`,
2023-12-22 09:04:52 [43mdestination[0m > `teamId`,
2023-12-22 09:04:52 [43mdestination[0m > `userId`,
2023-12-22 09:04:52 [43mdestination[0m > `currency`,
2023-12-22 09:04:52 [43mdestination[0m > `teamName`,
2023-12-22 09:04:52 [43mdestination[0m > `companyId`,
2023-12-22 09:04:52 [43mdestination[0m > `lineItems`,
2023-12-22 09:04:52 [43mdestination[0m > `exportedAt`,
2023-12-22 09:04:52 [43mdestination[0m > `allocations`,
2023-12-22 09:04:52 [43mdestination[0m > `description`,
2023-12-22 09:04:52 [43mdestination[0m > `payableDate`,
2023-12-22 09:04:52 [43mdestination[0m > `costCenterId`,
2023-12-22 09:04:52 [43mdestination[0m > `counterparty`,
2023-12-22 09:04:52 [43mdestination[0m > `invoiceNumber`,
2023-12-22 09:04:52 [43mdestination[0m > `costCenterName`,
2023-12-22 09:04:52 [43mdestination[0m > `invoiceDueDate`,
2023-12-22 09:04:52 [43mdestination[0m > `functionalAmount`,
2023-12-22 09:04:52 [43mdestination[0m > `bookkeepingStatus`,
2023-12-22 09:04:52 [43mdestination[0m > `functionalCurrency`,
2023-12-22 09:04:52 [43mdestination[0m > `documentaryEvidence`,
2023-12-22 09:04:52 [43mdestination[0m > `analyticalProperties`,
2023-12-22 09:04:52 [43mdestination[0m > `functionalExchangeRate`,
2023-12-22 09:04:52 [43mdestination[0m >   to_json(struct(COALESCE((SELECT ARRAY_AGG(unnested_column_errors IGNORE NULLS) FROM UNNEST(column_errors) unnested_column_errors), []) AS errors)) AS _airbyte_meta,
2023-12-22 09:04:52 [43mdestination[0m >   _airbyte_raw_id,
2023-12-22 09:04:52 [43mdestination[0m >   _airbyte_extracted_at
2023-12-22 09:04:52 [43mdestination[0m > FROM intermediate_data;
2023-12-22 09:04:52 [43mdestination[0m > UPDATE `reporting-340722`.`airbyte_internal`.`sources_raw__stream_spendesk_payables`
2023-12-22 09:04:52 [43mdestination[0m > SET `_airbyte_loaded_at` = CURRENT_TIMESTAMP()
2023-12-22 09:04:52 [43mdestination[0m > WHERE `_airbyte_loaded_at` IS NULL
2023-12-22 09:04:52 [43mdestination[0m >    AND _airbyte_extracted_at > '2023-12-19T22:02:25.177Z'
2023-12-22 09:04:52 [43mdestination[0m > ;
2023-12-22 09:04:52 [43mdestination[0m > COMMIT TRANSACTION;
2023-12-22 09:04:52 [43mdestination[0m > 
2023-12-22 09:04:57 [43mdestination[0m > 2023-12-22 09:04:57 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):119 - Root-level job f4b2a522-a5d5-452a-a197-11cd5704cbe3 completed in 4332 ms; processed 64642 bytes; billed for 31457280 bytes
2023-12-22 09:04:57 [43mdestination[0m > 2023-12-22 09:04:57 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql BEGIN TRANSACTION completed in 41 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:04:57 [43mdestination[0m > 2023-12-22 09:04:57 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql INSERT INTO `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` ( `id`, `type`, `amount`, `... completed in 1436 ms; processed 32321 bytes; billed for 20971520 bytes
2023-12-22 09:04:57 [43mdestination[0m > 2023-12-22 09:04:57 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql UPDATE `reporting-340722`.`airbyte_internal`.`sources_raw__stream_spendesk_payables` SET `_airbyte_l... completed in 1548 ms; processed 32321 bytes; billed for 10485760 bytes
2023-12-22 09:04:57 [43mdestination[0m > 2023-12-22 09:04:57 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql COMMIT TRANSACTION completed in 175 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:04:57 [43mdestination[0m > 2023-12-22 09:04:57 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$typeAndDedupeTask$2):224 - Allowing other threads to proceed for sources.spendesk_payables
2023-12-22 09:04:57 [43mdestination[0m > 2023-12-22 09:04:57 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onCloseFunction$4):179 - Cleaning up destination started for 1 streams
2023-12-22 09:04:57 [43mdestination[0m > 2023-12-22 09:04:57 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(dropStageIfExists):186 - Cleaning up staging path for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables
2023-12-22 09:04:58 [43mdestination[0m > 2023-12-22 09:04:58 [32mINFO[m i.a.i.d.g.GcsStorageOperations(cleanUpObjects):43 - Deleting object ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/715cd7c3-f68d-423c-959f-41c08050ee95.csv.gz
2023-12-22 09:04:58 [43mdestination[0m > 2023-12-22 09:04:58 [32mINFO[m i.a.i.d.g.GcsStorageOperations(cleanUpObjects):43 - Deleting object ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/f103a4de-ae2f-4c52-89d4-9978d37bfd8b.csv.gz
2023-12-22 09:04:58 [43mdestination[0m > 2023-12-22 09:04:58 [32mINFO[m i.a.i.d.g.GcsStorageOperations(cleanUpObjects):43 - Deleting object ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/08/94339a5a-9d50-4776-9f95-e2617bec6363/fd39ed65-8c26-4f56-8936-ceea36a21df8.csv.gz
2023-12-22 09:04:58 [43mdestination[0m > 2023-12-22 09:04:58 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(cleanUpBucketObject):295 - Storage bucket ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables has been cleaned-up (3 objects were deleted)...
2023-12-22 09:04:58 [43mdestination[0m > 2023-12-22 09:04:58 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(commitFinalTables):258 - Committing final tables
2023-12-22 09:04:58 [43mdestination[0m > 2023-12-22 09:04:58 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$commitFinalTableTask$6):281 - Overwriting final table with tmp table for stream sources.spendesk_payables
2023-12-22 09:04:58 [43mdestination[0m > 2023-12-22 09:04:58 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):99 - Executing sql 5a03bf09-9f21-43ca-899e-dcce7e4fb608: DROP TABLE IF EXISTS `reporting-340722`.`sources`.`spendesk_payables`;
2023-12-22 09:04:58 [43mdestination[0m > ALTER TABLE `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` RENAME TO `spendesk_payables`;
2023-12-22 09:04:58 [43mdestination[0m > 
2023-12-22 09:05:00 [43mdestination[0m > 2023-12-22 09:05:00 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):119 - Root-level job 5a03bf09-9f21-43ca-899e-dcce7e4fb608 completed in 1391 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:05:01 [43mdestination[0m > 2023-12-22 09:05:01 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql DROP TABLE IF EXISTS `reporting-340722`.`sources`.`spendesk_payables` completed in 95 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:05:01 [43mdestination[0m > 2023-12-22 09:05:01 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql ALTER TABLE `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` RENAME TO `spendesk_payable... completed in 584 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:05:01 [43mdestination[0m > 2023-12-22 09:05:01 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(cleanup):299 - Cleaning Up type-and-dedupe thread pool
2023-12-22 09:05:01 [43mdestination[0m > 2023-12-22 09:05:01 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onCloseFunction$4):185 - Cleaning up destination completed.
2023-12-22 09:05:01 [43mdestination[0m > 2023-12-22 09:05:01 [32mINFO[m i.a.c.i.d.AsyncStreamConsumer(close):211 - class io.airbyte.cdk.integrations.destination_async.AsyncStreamConsumer closed
2023-12-22 09:05:01 [43mdestination[0m > 2023-12-22 09:05:01 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):228 - Completed integration: io.airbyte.integrations.destination.bigquery.BigQueryDestination
2023-12-22 09:05:01 [46mplatform[0m > readFromDestination: done. (writeToDestFailed:false, dest.isFinished:true)
2023-12-22 09:05:01 [46mplatform[0m > thread status... timeout thread: false , replication thread: true
2023-12-22 09:05:01 [46mplatform[0m > sync summary: {
  "status" : "failed",
  "recordsSynced" : 0,
  "bytesSynced" : 0,
  "startTime" : 1703235220709,
  "endTime" : 1703235901180,
  "totalStats" : {
    "bytesCommitted" : 0,
    "bytesEmitted" : 30871,
    "destinationStateMessagesEmitted" : 0,
    "destinationWriteEndTime" : 1703235901178,
    "destinationWriteStartTime" : 1703235220709,
    "meanSecondsBeforeSourceStateMessageEmitted" : 0,
    "maxSecondsBeforeSourceStateMessageEmitted" : 0,
    "maxSecondsBetweenStateMessageEmittedandCommitted" : 0,
    "meanSecondsBetweenStateMessageEmittedandCommitted" : 0,
    "recordsEmitted" : 30,
    "recordsCommitted" : 0,
    "replicationEndTime" : 1703235901180,
    "replicationStartTime" : 1703235220709,
    "sourceReadEndTime" : 0,
    "sourceReadStartTime" : 1703235220709,
    "sourceStateMessagesEmitted" : 0
  },
  "streamStats" : [ {
    "streamName" : "payables",
    "stats" : {
      "bytesCommitted" : 0,
      "bytesEmitted" : 30871,
      "recordsEmitted" : 30,
      "recordsCommitted" : 0
    }
  } ],
  "performanceMetrics" : {
    "processFromSource" : {
      "elapsedTimeInNanos" : 606095796222,
      "executionCount" : 34,
      "avgExecTimeInNanos" : 1.7826346947705883E10
    },
    "readFromSource" : {
      "elapsedTimeInNanos" : 61005242500,
      "executionCount" : 151,
      "avgExecTimeInNanos" : 4.040082284768212E8
    },
    "processFromDest" : {
      "elapsedTimeInNanos" : 0,
      "executionCount" : 0,
      "avgExecTimeInNanos" : "NaN"
    },
    "writeToDest" : {
      "elapsedTimeInNanos" : 998937,
      "executionCount" : 30,
      "avgExecTimeInNanos" : 33297.9
    },
    "readFromDest" : {
      "elapsedTimeInNanos" : 680415079062,
      "executionCount" : 259,
      "avgExecTimeInNanos" : 2.6270852473436294E9
    }
  }
}
2023-12-22 09:05:01 [46mplatform[0m > failures: [ {
  "failureOrigin" : "source",
  "failureType" : "system_error",
  "internalMessage" : "Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {\"errors\":[{\"code\":\"INTERNAL_SERVER_ERROR\",\"detail\":\"Sorry, something has gone wrong at our end. If this persists please contact support.\"}]}",
  "externalMessage" : "Something went wrong in the connector. See the logs for more details.",
  "metadata" : {
    "attemptNumber" : 0,
    "jobId" : 292,
    "from_trace_message" : true,
    "connector_command" : "read"
  },
  "stacktrace" : "Traceback (most recent call last):\n  File \"/airbyte/integration_code/main.py\", line 29, in <module>\n    launch(source, sys.argv[1:])\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py\", line 210, in launch\n    for message in source_entrypoint.run(parsed_args):\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py\", line 117, in run\n    yield from map(AirbyteEntrypoint.airbyte_message_to_string, self.read(source_spec, config, config_catalog, state))\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py\", line 159, in read\n    yield from self.source.read(self.logger, config, catalog, state)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/manifest_declarative_source.py\", line 134, in read\n    yield from super().read(logger, config, catalog, state)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py\", line 141, in read\n    raise e\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py\", line 121, in read\n    yield from self._read_stream(\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py\", line 193, in _read_stream\n    for record in record_iterator:\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py\", line 253, in _read_full_refresh\n    for record_data_or_message in stream_instance.read_full_refresh(configured_stream.cursor_field, logger, self._slice_logger):\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/streams/core.py\", line 121, in read_full_refresh\n    yield from self.read_records(\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/declarative_stream.py\", line 104, in read_records\n    yield from self.retriever.read_records(stream_slice)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py\", line 304, in read_records\n    for stream_data in self._read_pages(self._parse_records, self.state, stream_slice):\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py\", line 282, in _read_pages\n    response = self._fetch_next_page(stream_state, stream_slice, next_page_token)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py\", line 256, in _fetch_next_page\n    return self.requester.send_request(\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py\", line 412, in send_request\n    response = self._send_with_retry(request, log_formatter=log_formatter)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py\", line 458, in _send_with_retry\n    return backoff_handler(user_backoff_handler)(request, log_formatter=log_formatter)  # type: ignore\n  File \"/usr/local/lib/python3.9/site-packages/backoff/_sync.py\", line 105, in retry\n    ret = target(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/backoff/_sync.py\", line 105, in retry\n    ret = target(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py\", line 497, in _send\n    raise UserDefinedBackoffException(backoff=custom_backoff_time, request=request, response=response)\nairbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {\"errors\":[{\"code\":\"INTERNAL_SERVER_ERROR\",\"detail\":\"Sorry, something has gone wrong at our end. If this persists please contact support.\"}]}\n",
  "timestamp" : 1703235281539
}, {
  "failureOrigin" : "source",
  "internalMessage" : "Source process exited with non-zero exit code 1",
  "externalMessage" : "Something went wrong within the source connector",
  "metadata" : {
    "attemptNumber" : 0,
    "jobId" : 292,
    "connector_command" : "read"
  },
  "stacktrace" : "io.airbyte.workers.internal.exception.SourceException: Source process exited with non-zero exit code 1\n\tat io.airbyte.workers.general.BufferedReplicationWorker.readFromSource(BufferedReplicationWorker.java:365)\n\tat io.airbyte.workers.general.BufferedReplicationWorker.lambda$runAsyncWithHeartbeatCheck$3(BufferedReplicationWorker.java:235)\n\tat java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)\n\tat java.base/java.lang.Thread.run(Thread.java:1589)\n",
  "timestamp" : 1703235281769
} ]
2023-12-22 09:05:01 [46mplatform[0m > 
2023-12-22 09:05:01 [46mplatform[0m > ----- END REPLICATION -----
2023-12-22 09:05:01 [46mplatform[0m > 
2023-12-22 09:05:01 [46mplatform[0m > Retry State: RetryManager(completeFailureBackoffPolicy=BackoffPolicy(minInterval=PT10S, maxInterval=PT30M, base=3), partialFailureBackoffPolicy=null, successiveCompleteFailureLimit=5, totalCompleteFailureLimit=10, successivePartialFailureLimit=1000, totalPartialFailureLimit=10, successiveCompleteFailures=1, totalCompleteFailures=1, successivePartialFailures=0, totalPartialFailures=0)
 Backoff before next attempt: 10 seconds
2023-12-22 09:05:01 [46mplatform[0m > Retry State: RetryManager(completeFailureBackoffPolicy=BackoffPolicy(minInterval=PT10S, maxInterval=PT30M, base=3), partialFailureBackoffPolicy=null, successiveCompleteFailureLimit=5, totalCompleteFailureLimit=10, successivePartialFailureLimit=1000, totalPartialFailureLimit=10, successiveCompleteFailures=1, totalCompleteFailures=1, successivePartialFailures=0, totalPartialFailures=0)
2023-12-22 09:05:01 [46mplatform[0m > Backing off for: 10 seconds.
2023-12-22 09:05:12 [46mplatform[0m > Docker volume job log path: /tmp/workspace/292/1/logs.log
2023-12-22 09:05:12 [46mplatform[0m > Executing worker wrapper. Airbyte version: 0.50.35
2023-12-22 09:05:12 [46mplatform[0m > Attempt 0 to save workflow id for cancellation
2023-12-22 09:05:12 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:05:12 [46mplatform[0m > 
2023-12-22 09:05:12 [46mplatform[0m > ----- START CHECK -----
2023-12-22 09:05:12 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:05:12 [46mplatform[0m > 
2023-12-22 09:05:12 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:05:12 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:05:12 [46mplatform[0m > Using default value for environment variable LAUNCHDARKLY_KEY: ''
2023-12-22 09:05:12 [46mplatform[0m > Checking if airbyte/source-declarative-manifest:0.55.2 exists...
2023-12-22 09:05:12 [46mplatform[0m > airbyte/source-declarative-manifest:0.55.2 was found locally.
2023-12-22 09:05:12 [46mplatform[0m > Creating docker container = source-declarative-manifest-check-292-1-liecm with resources io.airbyte.config.ResourceRequirements@7023897[cpuRequest=,cpuLimit=,memoryRequest=,memoryLimit=,additionalProperties={}] and allowedHosts null
2023-12-22 09:05:12 [46mplatform[0m > Preparing command: docker run --rm --init -i -w /data/292/1 --log-driver none --name source-declarative-manifest-check-292-1-liecm --network host -v airbyte_workspace:/data -v /tmp/airbyte_local:/local -e DEPLOYMENT_MODE=OSS -e WORKER_CONNECTOR_IMAGE=airbyte/source-declarative-manifest:0.55.2 -e AUTO_DETECT_SCHEMA=true -e LAUNCHDARKLY_KEY= -e SOCAT_KUBE_CPU_REQUEST=0.1 -e SOCAT_KUBE_CPU_LIMIT=2.0 -e FIELD_SELECTION_WORKSPACES= -e USE_STREAM_CAPABLE_STATE=true -e WORKER_ENVIRONMENT=DOCKER -e AIRBYTE_ROLE= -e APPLY_FIELD_SELECTION=false -e WORKER_JOB_ATTEMPT=1 -e OTEL_COLLECTOR_ENDPOINT=http://host.docker.internal:4317 -e FEATURE_FLAG_CLIENT=config -e AIRBYTE_VERSION=0.50.35 -e WORKER_JOB_ID=292 airbyte/source-declarative-manifest:0.55.2 check --config source_config.json
2023-12-22 09:05:12 [46mplatform[0m > Reading messages from protocol version 0.2.0
2023-12-22 09:05:15 [46mplatform[0m > Check succeeded
2023-12-22 09:05:15 [46mplatform[0m > Check connection job received output: io.airbyte.config.StandardCheckConnectionOutput@3c4fd3cd[status=succeeded,message=<null>,additionalProperties={}]
2023-12-22 09:05:15 [46mplatform[0m > 
2023-12-22 09:05:15 [46mplatform[0m > ----- END CHECK -----
2023-12-22 09:05:15 [46mplatform[0m > 
2023-12-22 09:05:15 [46mplatform[0m > Docker volume job log path: /tmp/workspace/292/1/logs.log
2023-12-22 09:05:15 [46mplatform[0m > Executing worker wrapper. Airbyte version: 0.50.35
2023-12-22 09:05:15 [46mplatform[0m > Attempt 0 to save workflow id for cancellation
2023-12-22 09:05:15 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:05:15 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:05:15 [46mplatform[0m > 
2023-12-22 09:05:15 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:05:15 [46mplatform[0m > ----- START CHECK -----
2023-12-22 09:05:15 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:05:15 [46mplatform[0m > 
2023-12-22 09:05:15 [46mplatform[0m > Using default value for environment variable LAUNCHDARKLY_KEY: ''
2023-12-22 09:05:15 [46mplatform[0m > Checking if airbyte/destination-bigquery:2.3.16 exists...
2023-12-22 09:05:15 [46mplatform[0m > airbyte/destination-bigquery:2.3.16 was found locally.
2023-12-22 09:05:15 [46mplatform[0m > Creating docker container = destination-bigquery-check-292-1-mnumf with resources io.airbyte.config.ResourceRequirements@5b75b15d[cpuRequest=,cpuLimit=,memoryRequest=,memoryLimit=,additionalProperties={}] and allowedHosts null
2023-12-22 09:05:15 [46mplatform[0m > Preparing command: docker run --rm --init -i -w /data/292/1 --log-driver none --name destination-bigquery-check-292-1-mnumf --network host -v airbyte_workspace:/data -v /tmp/airbyte_local:/local -e DEPLOYMENT_MODE=OSS -e WORKER_CONNECTOR_IMAGE=airbyte/destination-bigquery:2.3.16 -e AUTO_DETECT_SCHEMA=true -e LAUNCHDARKLY_KEY= -e SOCAT_KUBE_CPU_REQUEST=0.1 -e SOCAT_KUBE_CPU_LIMIT=2.0 -e FIELD_SELECTION_WORKSPACES= -e USE_STREAM_CAPABLE_STATE=true -e WORKER_ENVIRONMENT=DOCKER -e AIRBYTE_ROLE= -e APPLY_FIELD_SELECTION=false -e WORKER_JOB_ATTEMPT=1 -e OTEL_COLLECTOR_ENDPOINT=http://host.docker.internal:4317 -e FEATURE_FLAG_CLIENT=config -e AIRBYTE_VERSION=0.50.35 -e WORKER_JOB_ID=292 airbyte/destination-bigquery:2.3.16 check --config source_config.json
2023-12-22 09:05:15 [46mplatform[0m > Reading messages from protocol version 0.2.0
2023-12-22 09:05:17 [46mplatform[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:05:17 [46mplatform[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:05:17 [46mplatform[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:05:17 [46mplatform[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:05:17 [46mplatform[0m > 2023-12-22 09:05:17 [32mINFO[m i.a.c.i.b.IntegrationCliParser(parseOptions):126 - integration args: {check=null, config=source_config.json}
2023-12-22 09:05:17 [46mplatform[0m > 2023-12-22 09:05:17 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):132 - Running integration: io.airbyte.integrations.destination.bigquery.BigQueryDestination
2023-12-22 09:05:17 [46mplatform[0m > 2023-12-22 09:05:17 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):133 - Command: CHECK
2023-12-22 09:05:17 [46mplatform[0m > 2023-12-22 09:05:17 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):134 - Integration config: IntegrationConfig{command=CHECK, configPath='source_config.json', catalogPath='null', statePath='null'}
2023-12-22 09:05:18 [46mplatform[0m > 2023-12-22 09:05:18 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword groups - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:05:18 [46mplatform[0m > 2023-12-22 09:05:18 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword group - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:05:18 [46mplatform[0m > 2023-12-22 09:05:18 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword order - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:05:18 [46mplatform[0m > 2023-12-22 09:05:18 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword display_type - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:05:18 [46mplatform[0m > 2023-12-22 09:05:18 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword airbyte_secret - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:05:18 [46mplatform[0m > 2023-12-22 09:05:18 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword always_show - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:05:18 [46mplatform[0m > 2023-12-22 09:05:18 [32mINFO[m i.a.i.d.b.BigQueryUtils(getLoadingMethod):426 - Selected loading method is set to: GCS
2023-12-22 09:05:23 [46mplatform[0m > 2023-12-22 09:05:23 [32mINFO[m i.a.c.i.d.s.S3FormatConfigs(getS3FormatConfig):22 - S3 format config: {"format_type":"CSV","flattening":"No flattening"}
2023-12-22 09:05:23 [46mplatform[0m > 2023-12-22 09:05:23 [32mINFO[m i.a.c.i.d.s.S3BaseChecks(testSingleUpload):40 - Started testing if all required credentials assigned to user for single file uploading
2023-12-22 09:05:24 [46mplatform[0m > 2023-12-22 09:05:24 [32mINFO[m i.a.c.i.d.s.S3BaseChecks(testSingleUpload):48 - Finished checking for normal upload mode
2023-12-22 09:05:24 [46mplatform[0m > 2023-12-22 09:05:24 [32mINFO[m i.a.c.i.d.s.S3BaseChecks(testMultipartUpload):52 - Started testing if all required credentials assigned to user for multipart upload
2023-12-22 09:05:24 [46mplatform[0m > 2023-12-22 09:05:24 [32mINFO[m a.m.s.StreamTransferManager(getMultiPartOutputStreams):329 - Initiated multipart upload to ucm-analytics-bucket/ucm-analytics-bucket/sources/test_1703235924247 with full ID ABPnzm7m9PScaua8AxXbqPXuDAh9in6osLOLEuEaKvA7GChwQxFyuVLDZkc_wrAa0jkgA-ES
2023-12-22 09:05:24 [46mplatform[0m > 2023-12-22 09:05:24 [32mINFO[m a.m.s.MultiPartOutputStream(close):158 - Called close() on [MultipartOutputStream for parts 1 - 10000]
2023-12-22 09:05:24 [46mplatform[0m > 2023-12-22 09:05:24 [32mINFO[m a.m.s.MultiPartOutputStream(close):158 - Called close() on [MultipartOutputStream for parts 1 - 10000]
2023-12-22 09:05:24 [46mplatform[0m > 2023-12-22 09:05:24 [33mWARN[m a.m.s.MultiPartOutputStream(close):160 - [MultipartOutputStream for parts 1 - 10000] is already closed
2023-12-22 09:05:24 [46mplatform[0m > 2023-12-22 09:05:24 [32mINFO[m a.m.s.StreamTransferManager(complete):367 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/test_1703235924247 with id ABPnzm7m9...a0jkgA-ES]: Uploading leftover stream [Part number 1 containing 3.34 MB]
2023-12-22 09:05:25 [46mplatform[0m > 2023-12-22 09:05:25 [32mINFO[m a.m.s.StreamTransferManager(uploadStreamPart):558 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/test_1703235924247 with id ABPnzm7m9...a0jkgA-ES]: Finished uploading [Part number 1 containing 3.34 MB]
2023-12-22 09:05:25 [46mplatform[0m > 2023-12-22 09:05:25 [32mINFO[m a.m.s.StreamTransferManager(complete):395 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/test_1703235924247 with id ABPnzm7m9...a0jkgA-ES]: Completed
2023-12-22 09:05:25 [46mplatform[0m > 2023-12-22 09:05:25 [32mINFO[m i.a.c.i.d.s.S3BaseChecks(testMultipartUpload):74 - Finished verification for multipart upload mode
2023-12-22 09:05:26 [46mplatform[0m > 2023-12-22 09:05:26 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):228 - Completed integration: io.airbyte.integrations.destination.bigquery.BigQueryDestination
2023-12-22 09:05:26 [46mplatform[0m > Check connection job received output: io.airbyte.config.StandardCheckConnectionOutput@764b4d17[status=succeeded,message=<null>,additionalProperties={}]
2023-12-22 09:05:26 [46mplatform[0m > 
2023-12-22 09:05:26 [46mplatform[0m > ----- END CHECK -----
2023-12-22 09:05:26 [46mplatform[0m > 
2023-12-22 09:05:26 [46mplatform[0m > Docker volume job log path: /tmp/workspace/292/1/logs.log
2023-12-22 09:05:26 [46mplatform[0m > Executing worker wrapper. Airbyte version: 0.50.35
2023-12-22 09:05:26 [46mplatform[0m > Attempt 0 to save workflow id for cancellation
2023-12-22 09:05:27 [46mplatform[0m > start sync worker. job id: 292 attempt id: 1
2023-12-22 09:05:27 [46mplatform[0m > 
2023-12-22 09:05:27 [46mplatform[0m > ----- START REPLICATION -----
2023-12-22 09:05:27 [46mplatform[0m > 
2023-12-22 09:05:27 [46mplatform[0m > Running destination...
2023-12-22 09:05:27 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:05:27 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:05:27 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:05:27 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:05:27 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:05:27 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:05:27 [46mplatform[0m > Using default value for environment variable LAUNCHDARKLY_KEY: ''
2023-12-22 09:05:27 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:05:27 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:05:27 [46mplatform[0m > Using default value for environment variable LAUNCHDARKLY_KEY: ''
2023-12-22 09:05:27 [46mplatform[0m > Checking if airbyte/destination-bigquery:2.3.16 exists...
2023-12-22 09:05:27 [46mplatform[0m > Checking if airbyte/source-declarative-manifest:0.55.2 exists...
2023-12-22 09:05:27 [46mplatform[0m > airbyte/destination-bigquery:2.3.16 was found locally.
2023-12-22 09:05:27 [46mplatform[0m > airbyte/source-declarative-manifest:0.55.2 was found locally.
2023-12-22 09:05:27 [46mplatform[0m > Creating docker container = destination-bigquery-write-292-1-ovmfd with resources io.airbyte.config.ResourceRequirements@6edbd1f1[cpuRequest=,cpuLimit=,memoryRequest=,memoryLimit=,additionalProperties={}] and allowedHosts null
2023-12-22 09:05:27 [46mplatform[0m > Preparing command: docker run --rm --init -i -w /data/292/1 --log-driver none --name destination-bigquery-write-292-1-ovmfd --network host -v airbyte_workspace:/data -v /tmp/airbyte_local:/local -e DEPLOYMENT_MODE=OSS -e WORKER_CONNECTOR_IMAGE=airbyte/destination-bigquery:2.3.16 -e AUTO_DETECT_SCHEMA=true -e LAUNCHDARKLY_KEY= -e SOCAT_KUBE_CPU_REQUEST=0.1 -e SOCAT_KUBE_CPU_LIMIT=2.0 -e FIELD_SELECTION_WORKSPACES= -e USE_STREAM_CAPABLE_STATE=true -e WORKER_ENVIRONMENT=DOCKER -e AIRBYTE_ROLE= -e APPLY_FIELD_SELECTION=false -e WORKER_JOB_ATTEMPT=1 -e OTEL_COLLECTOR_ENDPOINT=http://host.docker.internal:4317 -e FEATURE_FLAG_CLIENT=config -e AIRBYTE_VERSION=0.50.35 -e WORKER_JOB_ID=292 airbyte/destination-bigquery:2.3.16 write --config destination_config.json --catalog destination_catalog.json
2023-12-22 09:05:27 [46mplatform[0m > Creating docker container = source-declarative-manifest-read-292-1-ncmol with resources io.airbyte.config.ResourceRequirements@357c4044[cpuRequest=,cpuLimit=,memoryRequest=,memoryLimit=,additionalProperties={}] and allowedHosts null
2023-12-22 09:05:27 [46mplatform[0m > Preparing command: docker run --rm --init -i -w /data/292/1 --log-driver none --name source-declarative-manifest-read-292-1-ncmol -e CONCURRENT_SOURCE_STREAM_READ=false --network host -v airbyte_workspace:/data -v /tmp/airbyte_local:/local -e DEPLOYMENT_MODE=OSS -e WORKER_CONNECTOR_IMAGE=airbyte/source-declarative-manifest:0.55.2 -e AUTO_DETECT_SCHEMA=true -e LAUNCHDARKLY_KEY= -e SOCAT_KUBE_CPU_REQUEST=0.1 -e SOCAT_KUBE_CPU_LIMIT=2.0 -e FIELD_SELECTION_WORKSPACES= -e USE_STREAM_CAPABLE_STATE=true -e WORKER_ENVIRONMENT=DOCKER -e AIRBYTE_ROLE= -e APPLY_FIELD_SELECTION=false -e WORKER_JOB_ATTEMPT=1 -e OTEL_COLLECTOR_ENDPOINT=http://host.docker.internal:4317 -e FEATURE_FLAG_CLIENT=config -e AIRBYTE_VERSION=0.50.35 -e WORKER_JOB_ID=292 airbyte/source-declarative-manifest:0.55.2 read --config source_config.json --catalog source_catalog.json
2023-12-22 09:05:27 [46mplatform[0m > Writing messages to protocol version 0.2.0
2023-12-22 09:05:27 [46mplatform[0m > Reading messages from protocol version 0.2.0
2023-12-22 09:05:27 [46mplatform[0m > Reading messages from protocol version 0.2.0
2023-12-22 09:05:27 [46mplatform[0m > readFromSource: start
2023-12-22 09:05:27 [46mplatform[0m > Starting source heartbeat check. Will check every 1 minutes.
2023-12-22 09:05:27 [46mplatform[0m > processMessage: start
2023-12-22 09:05:27 [46mplatform[0m > writeToDestination: start
2023-12-22 09:05:27 [46mplatform[0m > readFromDestination: start
2023-12-22 09:05:30 [43mdestination[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:05:30 [43mdestination[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:05:30 [43mdestination[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:05:30 [43mdestination[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:05:30 [44msource[0m > Starting syncing ManifestDeclarativeSource
2023-12-22 09:05:30 [44msource[0m > Marking stream payables as STARTED
2023-12-22 09:05:30 [44msource[0m > Syncing stream: payables 
2023-12-22 09:05:31 [44msource[0m > Marking stream payables as RUNNING
2023-12-22 09:05:31 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:05:31 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 09:05:31 [43mdestination[0m > 2023-12-22 09:05:31 [32mINFO[m i.a.c.i.b.IntegrationCliParser(parseOptions):126 - integration args: {catalog=destination_catalog.json, write=null, config=destination_config.json}
2023-12-22 09:05:31 [43mdestination[0m > 2023-12-22 09:05:31 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):132 - Running integration: io.airbyte.integrations.destination.bigquery.BigQueryDestination
2023-12-22 09:05:31 [43mdestination[0m > 2023-12-22 09:05:31 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):133 - Command: WRITE
2023-12-22 09:05:31 [43mdestination[0m > 2023-12-22 09:05:31 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):134 - Integration config: IntegrationConfig{command=WRITE, configPath='destination_config.json', catalogPath='destination_catalog.json', statePath='null'}
2023-12-22 09:05:31 [43mdestination[0m > 2023-12-22 09:05:31 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword groups - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:05:31 [43mdestination[0m > 2023-12-22 09:05:31 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword group - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:05:31 [43mdestination[0m > 2023-12-22 09:05:31 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword order - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:05:31 [43mdestination[0m > 2023-12-22 09:05:31 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword display_type - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:05:31 [43mdestination[0m > 2023-12-22 09:05:31 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword airbyte_secret - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:05:31 [43mdestination[0m > 2023-12-22 09:05:31 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword always_show - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:05:32 [43mdestination[0m > 2023-12-22 09:05:31 [32mINFO[m i.a.i.d.b.BigQueryUtils(getLoadingMethod):426 - Selected loading method is set to: GCS
2023-12-22 09:05:32 [43mdestination[0m > 2023-12-22 09:05:32 [32mINFO[m i.a.c.i.d.s.S3FormatConfigs(getS3FormatConfig):22 - S3 format config: {"format_type":"CSV","flattening":"No flattening"}
2023-12-22 09:05:32 [43mdestination[0m > 2023-12-22 09:05:32 [32mINFO[m i.a.i.d.b.BigQueryUtils(isKeepFilesInGcs):442 - All tmp files will be removed from GCS when replication is finished
2023-12-22 09:05:33 [43mdestination[0m > 2023-12-22 09:05:33 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$createWriteConfigs$1):114 - BigQuery write config: BigQueryWriteConfig[streamName=spendesk_payables, namespace=sources, datasetId=airbyte_internal, datasetLocation=europe-west3, tmpTableId=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=_airbyte_tmp_oox_spendesk_payables}}, targetTableId=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}, tableSchema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, syncMode=overwrite]
2023-12-22 09:05:33 [43mdestination[0m > 2023-12-22 09:05:33 [32mINFO[m i.a.c.i.d.b.BufferManager(<init>):53 - Max 'memory' available for buffer allocation 2 GB
2023-12-22 09:05:33 [43mdestination[0m > 2023-12-22 09:05:33 [32mINFO[m i.a.c.i.d.FlushWorkers(start):98 - Start async buffer supervisor
2023-12-22 09:05:33 [43mdestination[0m > 2023-12-22 09:05:33 [32mINFO[m i.a.c.i.d.AsyncStreamConsumer(start):137 - class io.airbyte.cdk.integrations.destination_async.AsyncStreamConsumer started.
2023-12-22 09:05:33 [43mdestination[0m > 2023-12-22 09:05:33 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onStartFunction$3):137 - Preparing airbyte_raw tables in destination started for 1 streams
2023-12-22 09:05:33 [43mdestination[0m > 2023-12-22 09:05:33 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(prepareTables):108 - Preparing final tables
2023-12-22 09:05:33 [43mdestination[0m > 2023-12-22 09:05:33 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:05:33 [43mdestination[0m > 2023-12-22 09:05:33 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:05:33 [43mdestination[0m > 2023-12-22 09:05:33 [32mINFO[m i.a.i.b.d.t.BaseDestinationV1V2Migrator(migrateIfNecessary):26 - Assessing whether migration is necessary for stream spendesk_payables
2023-12-22 09:05:33 [43mdestination[0m > 2023-12-22 09:05:33 [32mINFO[m i.a.i.b.d.t.BaseDestinationV1V2Migrator(shouldMigrate):45 - Checking whether v1 raw table _airbyte_raw_spendesk_payables in dataset sources exists
2023-12-22 09:05:35 [43mdestination[0m > 2023-12-22 09:05:35 [32mINFO[m i.a.i.b.d.t.BaseDestinationV1V2Migrator(shouldMigrate):49 - Migration Info: Required for Sync mode: false, No existing v2 raw tables: false, A v1 raw table exists: false
2023-12-22 09:05:35 [43mdestination[0m > 2023-12-22 09:05:35 [32mINFO[m i.a.i.b.d.t.BaseDestinationV1V2Migrator(migrateIfNecessary):32 - No Migration Required for stream: spendesk_payables
2023-12-22 09:05:35 [43mdestination[0m > 2023-12-22 09:05:35 [32mINFO[m i.a.i.d.b.t.BigQueryV2TableMigrator(migrateIfNecessary):76 - No Data column Migration Required for stream sources_raw__stream_spendesk_payables
2023-12-22 09:05:35 [43mdestination[0m > 2023-12-22 09:05:35 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$prepareTablesFuture$1):129 - Final Table exists for stream spendesk_payables
2023-12-22 09:05:35 [43mdestination[0m > 2023-12-22 09:05:35 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):99 - Executing sql 9235da33-da22-4a63-9e55-f15959ca46f2: CREATE SCHEMA IF NOT EXISTS `reporting-340722`.`sources`
2023-12-22 09:05:35 [43mdestination[0m > OPTIONS(location="europe-west3");
2023-12-22 09:05:35 [43mdestination[0m > 
2023-12-22 09:05:35 [43mdestination[0m > CREATE OR REPLACE TABLE `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` (
2023-12-22 09:05:35 [43mdestination[0m >   _airbyte_raw_id STRING NOT NULL,
2023-12-22 09:05:35 [43mdestination[0m >   _airbyte_extracted_at TIMESTAMP NOT NULL,
2023-12-22 09:05:35 [43mdestination[0m >   _airbyte_meta JSON NOT NULL,
2023-12-22 09:05:35 [43mdestination[0m > `id` STRING,
2023-12-22 09:05:35 [43mdestination[0m > `type` STRING,
2023-12-22 09:05:35 [43mdestination[0m > `amount` NUMERIC,
2023-12-22 09:05:35 [43mdestination[0m > `teamId` STRING,
2023-12-22 09:05:35 [43mdestination[0m > `userId` STRING,
2023-12-22 09:05:35 [43mdestination[0m > `currency` STRING,
2023-12-22 09:05:35 [43mdestination[0m > `teamName` STRING,
2023-12-22 09:05:35 [43mdestination[0m > `companyId` STRING,
2023-12-22 09:05:35 [43mdestination[0m > `lineItems` JSON,
2023-12-22 09:05:35 [43mdestination[0m > `exportedAt` STRING,
2023-12-22 09:05:35 [43mdestination[0m > `allocations` JSON,
2023-12-22 09:05:35 [43mdestination[0m > `description` STRING,
2023-12-22 09:05:35 [43mdestination[0m > `payableDate` STRING,
2023-12-22 09:05:35 [43mdestination[0m > `costCenterId` STRING,
2023-12-22 09:05:35 [43mdestination[0m > `counterparty` JSON,
2023-12-22 09:05:35 [43mdestination[0m > `invoiceNumber` STRING,
2023-12-22 09:05:35 [43mdestination[0m > `costCenterName` STRING,
2023-12-22 09:05:35 [43mdestination[0m > `invoiceDueDate` STRING,
2023-12-22 09:05:35 [43mdestination[0m > `functionalAmount` NUMERIC,
2023-12-22 09:05:35 [43mdestination[0m > `bookkeepingStatus` STRING,
2023-12-22 09:05:35 [43mdestination[0m > `functionalCurrency` STRING,
2023-12-22 09:05:35 [43mdestination[0m > `documentaryEvidence` JSON,
2023-12-22 09:05:35 [43mdestination[0m > `analyticalProperties` JSON,
2023-12-22 09:05:35 [43mdestination[0m > `functionalExchangeRate` NUMERIC
2023-12-22 09:05:35 [43mdestination[0m > )
2023-12-22 09:05:35 [43mdestination[0m > PARTITION BY (DATE_TRUNC(_airbyte_extracted_at, DAY))
2023-12-22 09:05:35 [43mdestination[0m > CLUSTER BY `_airbyte_extracted_at`;
2023-12-22 09:05:35 [43mdestination[0m > 
2023-12-22 09:05:37 [43mdestination[0m > 2023-12-22 09:05:37 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):119 - Root-level job 9235da33-da22-4a63-9e55-f15959ca46f2 completed in 855 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:05:37 [43mdestination[0m > 2023-12-22 09:05:37 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql CREATE SCHEMA IF NOT EXISTS `reporting-340722`.`sources` OPTIONS(location="europe-west3")... completed in 81 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:05:37 [43mdestination[0m > 2023-12-22 09:05:37 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql CREATE OR REPLACE TABLE `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` ( _airbyte_raw_... completed in 155 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:05:37 [43mdestination[0m > 2023-12-22 09:05:37 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$prepareTablesFuture$1):138 - Using temp final table for stream spendesk_payables, will overwrite existing table at end of sync
2023-12-22 09:05:37 [43mdestination[0m > 2023-12-22 09:05:37 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onStartFunction$3):140 - Preparing staging are in destination for schema: Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, stream: spendesk_payables, target table: GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}, stage: spendesk_payables
2023-12-22 09:05:37 [43mdestination[0m > 2023-12-22 09:05:37 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(createSchemaIfNotExists):86 - Creating dataset airbyte_internal
2023-12-22 09:05:38 [43mdestination[0m > 2023-12-22 09:05:38 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(createTableIfNotExists):102 - Creating target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}
2023-12-22 09:05:38 [43mdestination[0m > 2023-12-22 09:05:38 [32mINFO[m i.a.i.d.b.BigQueryUtils(createPartitionedTableIfNotExists):228 - Partitioned table ALREADY EXISTS: GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}
2023-12-22 09:05:38 [43mdestination[0m > 2023-12-22 09:05:38 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(createStageIfNotExists):109 - Creating staging path for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/
2023-12-22 09:05:38 [43mdestination[0m > 2023-12-22 09:05:38 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(truncateTableIfExists):207 - Truncating target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal)
2023-12-22 09:05:38 [43mdestination[0m > 2023-12-22 09:05:38 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(dropTableIfExists):175 - Deleting target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal)
2023-12-22 09:05:38 [43mdestination[0m > 2023-12-22 09:05:38 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(createTableIfNotExists):102 - Creating target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}
2023-12-22 09:05:38 [43mdestination[0m > 2023-12-22 09:05:38 [32mINFO[m i.a.i.d.b.BigQueryUtils(createPartitionedTableIfNotExists):231 - Partitioned table created successfully: GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}
2023-12-22 09:05:38 [43mdestination[0m > 2023-12-22 09:05:38 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onStartFunction$3):159 - Preparing tables in destination completed.
2023-12-22 09:05:42 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:05:42 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 09:05:53 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:05:53 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 09:06:04 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:06:04 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 09:06:15 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:06:15 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 09:06:26 [44msource[0m > Giving up _send(...) after 6 tries (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:06:26 [44msource[0m > Max retry limit reached. Request: <PreparedRequest [GET]>, Response: <Response [500]>
2023-12-22 09:06:26 [44msource[0m > Encountered an exception while reading stream payables
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 121, in read
    yield from self._read_stream(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 193, in _read_stream
    for record in record_iterator:
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 253, in _read_full_refresh
    for record_data_or_message in stream_instance.read_full_refresh(configured_stream.cursor_field, logger, self._slice_logger):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/streams/core.py", line 121, in read_full_refresh
    yield from self.read_records(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/declarative_stream.py", line 104, in read_records
    yield from self.retriever.read_records(stream_slice)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 304, in read_records
    for stream_data in self._read_pages(self._parse_records, self.state, stream_slice):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 282, in _read_pages
    response = self._fetch_next_page(stream_state, stream_slice, next_page_token)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 256, in _fetch_next_page
    return self.requester.send_request(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 412, in send_request
    response = self._send_with_retry(request, log_formatter=log_formatter)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 458, in _send_with_retry
    return backoff_handler(user_backoff_handler)(request, log_formatter=log_formatter)  # type: ignore
  File "/usr/local/lib/python3.9/site-packages/backoff/_sync.py", line 105, in retry
    ret = target(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/backoff/_sync.py", line 105, in retry
    ret = target(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 497, in _send
    raise UserDefinedBackoffException(backoff=custom_backoff_time, request=request, response=response)
airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]}
2023-12-22 09:06:26 [44msource[0m > Marking stream payables as STOPPED
2023-12-22 09:06:26 [44msource[0m > Finished syncing payables
2023-12-22 09:06:26 [44msource[0m > ManifestDeclarativeSource runtimes:
Syncing stream payables 0:00:56.166674
2023-12-22 09:06:26 [44msource[0m > Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]}
Traceback (most recent call last):
  File "/airbyte/integration_code/main.py", line 29, in <module>
    launch(source, sys.argv[1:])
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py", line 210, in launch
    for message in source_entrypoint.run(parsed_args):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py", line 117, in run
    yield from map(AirbyteEntrypoint.airbyte_message_to_string, self.read(source_spec, config, config_catalog, state))
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py", line 159, in read
    yield from self.source.read(self.logger, config, catalog, state)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/manifest_declarative_source.py", line 134, in read
    yield from super().read(logger, config, catalog, state)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 141, in read
    raise e
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 121, in read
    yield from self._read_stream(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 193, in _read_stream
    for record in record_iterator:
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 253, in _read_full_refresh
    for record_data_or_message in stream_instance.read_full_refresh(configured_stream.cursor_field, logger, self._slice_logger):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/streams/core.py", line 121, in read_full_refresh
    yield from self.read_records(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/declarative_stream.py", line 104, in read_records
    yield from self.retriever.read_records(stream_slice)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 304, in read_records
    for stream_data in self._read_pages(self._parse_records, self.state, stream_slice):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 282, in _read_pages
    response = self._fetch_next_page(stream_state, stream_slice, next_page_token)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 256, in _fetch_next_page
    return self.requester.send_request(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 412, in send_request
    response = self._send_with_retry(request, log_formatter=log_formatter)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 458, in _send_with_retry
    return backoff_handler(user_backoff_handler)(request, log_formatter=log_formatter)  # type: ignore
  File "/usr/local/lib/python3.9/site-packages/backoff/_sync.py", line 105, in retry
    ret = target(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/backoff/_sync.py", line 105, in retry
    ret = target(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 497, in _send
    raise UserDefinedBackoffException(backoff=custom_backoff_time, request=request, response=response)
airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]}
2023-12-22 09:06:27 [46mplatform[0m > readFromSource: source exception
io.airbyte.workers.internal.exception.SourceException: Source process exited with non-zero exit code 1
	at io.airbyte.workers.general.BufferedReplicationWorker.readFromSource(BufferedReplicationWorker.java:365) ~[io.airbyte-airbyte-commons-worker-0.50.35.jar:?]
	at io.airbyte.workers.general.BufferedReplicationWorker.lambda$runAsyncWithHeartbeatCheck$3(BufferedReplicationWorker.java:235) ~[io.airbyte-airbyte-commons-worker-0.50.35.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[?:?]
	at java.lang.Thread.run(Thread.java:1589) ~[?:?]
2023-12-22 09:06:27 [46mplatform[0m > readFromSource: done. (source.isFinished:true, fromSource.isClosed:false)
2023-12-22 09:06:33 [43mdestination[0m > 2023-12-22 09:06:33 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:06:33 [43mdestination[0m > 2023-12-22 09:06:33 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:07:33 [43mdestination[0m > 2023-12-22 09:07:33 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:07:33 [43mdestination[0m > 2023-12-22 09:07:33 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:08:33 [43mdestination[0m > 2023-12-22 09:08:33 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:08:33 [43mdestination[0m > 2023-12-22 09:08:33 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:09:33 [43mdestination[0m > 2023-12-22 09:09:33 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:09:33 [43mdestination[0m > 2023-12-22 09:09:33 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:10:33 [43mdestination[0m > 2023-12-22 09:10:33 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:10:33 [43mdestination[0m > 2023-12-22 09:10:33 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:10:40 [43mdestination[0m > 2023-12-22 09:10:40 [32mINFO[m i.a.c.i.d.DetectStreamToFlush(getNextStreamToFlush):122 - flushing: trigger info: sources - spendesk_payables, time trigger: true , size trigger: false current threshold b: 200 MB, queue size b: 34.09 KB, penalty b: 0 bytes, after penalty b: 34.09 KB
2023-12-22 09:10:40 [43mdestination[0m > 2023-12-22 09:10:40 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):152 - Flush Worker (6f74a) -- Worker picked up work.
2023-12-22 09:10:40 [43mdestination[0m > 2023-12-22 09:10:40 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):154 - Flush Worker (6f74a) -- Attempting to read from queue namespace: sources, stream: spendesk_payables.
2023-12-22 09:10:40 [43mdestination[0m > 2023-12-22 09:10:40 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 10450847 bytes..
2023-12-22 09:10:40 [43mdestination[0m > 2023-12-22 09:10:40 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):167 - Flush Worker (6f74a) -- Batch contains: 29 records, 34.09 KB bytes.
2023-12-22 09:10:40 [43mdestination[0m > 2023-12-22 09:10:40 [32mINFO[m i.a.c.i.d.r.BaseSerializedBuffer(flush):172 - Finished writing data to f4d24ab6-7cb7-4de9-bb34-9e18b90048515365638993628630546.csv.gz (5 KB)
2023-12-22 09:10:40 [43mdestination[0m > 2023-12-22 09:10:40 [32mINFO[m i.a.i.d.b.BigQueryAsyncFlush(flush):61 - Flushing CSV buffer for stream spendesk_payables (5 KB) to staging
2023-12-22 09:10:40 [43mdestination[0m > 2023-12-22 09:10:40 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(uploadRecordsToStage):116 - Uploading records to staging for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/
2023-12-22 09:10:40 [43mdestination[0m > 2023-12-22 09:10:40 [32mINFO[m a.m.s.StreamTransferManager(getMultiPartOutputStreams):329 - Initiated multipart upload to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1c0c0b21-5950-4f76-b979-e96c59bcfbac.csv.gz with full ID ABPnzm7iwzjuSxlR8uo0UWn2MEpnsfVcwn8T8bbEk6EXrH3FT2kKPiL1yJRl9vzE7_KKFd9N
2023-12-22 09:10:40 [43mdestination[0m > 2023-12-22 09:10:40 [32mINFO[m a.m.s.MultiPartOutputStream(close):158 - Called close() on [MultipartOutputStream for parts 1 - 10000]
2023-12-22 09:10:40 [43mdestination[0m > 2023-12-22 09:10:40 [32mINFO[m a.m.s.StreamTransferManager(complete):367 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1c0c0b21-5950-4f76-b979-e96c59bcfbac.csv.gz with id ABPnzm7iw...E7_KKFd9N]: Uploading leftover stream [Part number 1 containing 0.01 MB]
2023-12-22 09:10:41 [43mdestination[0m > 2023-12-22 09:10:41 [32mINFO[m a.m.s.StreamTransferManager(uploadStreamPart):558 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1c0c0b21-5950-4f76-b979-e96c59bcfbac.csv.gz with id ABPnzm7iw...E7_KKFd9N]: Finished uploading [Part number 1 containing 0.01 MB]
2023-12-22 09:10:41 [43mdestination[0m > 2023-12-22 09:10:41 [32mINFO[m a.m.s.StreamTransferManager(complete):395 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1c0c0b21-5950-4f76-b979-e96c59bcfbac.csv.gz with id ABPnzm7iw...E7_KKFd9N]: Completed
2023-12-22 09:10:41 [43mdestination[0m > 2023-12-22 09:10:41 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(loadDataIntoBucket):214 - Uploaded buffer file to storage: f4d24ab6-7cb7-4de9-bb34-9e18b90048515365638993628630546.csv.gz -> ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1c0c0b21-5950-4f76-b979-e96c59bcfbac.csv.gz (filename: 1c0c0b21-5950-4f76-b979-e96c59bcfbac.csv.gz)
2023-12-22 09:10:41 [43mdestination[0m > 2023-12-22 09:10:41 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(uploadRecordsToBucket):131 - Successfully loaded records to stage ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/ with 0 re-attempt(s)
2023-12-22 09:10:41 [43mdestination[0m > 2023-12-22 09:10:41 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):134 - Uploading records from staging files to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): 1c0c0b21-5950-4f76-b979-e96c59bcfbac.csv.gz
2023-12-22 09:10:41 [43mdestination[0m > 2023-12-22 09:10:41 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):138 - Uploading staged file: gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1c0c0b21-5950-4f76-b979-e96c59bcfbac.csv.gz
2023-12-22 09:10:41 [43mdestination[0m > 2023-12-22 09:10:41 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):147 - [JobId{project=reporting-340722, job=59bfa216-9af4-491d-9c59-2e1f80eb71a0, location=europe-west3}] Created a new job to upload record(s) to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): Job{job=JobId{project=reporting-340722, job=59bfa216-9af4-491d-9c59-2e1f80eb71a0, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703236241439, endTime=null, startTime=1703236241532, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=I74FGP7PePPnRjMbEMfmcA==, generatedId=reporting-340722:europe-west3.59bfa216-9af4-491d-9c59-2e1f80eb71a0, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/59bfa216-9af4-491d-9c59-2e1f80eb71a0?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1c0c0b21-5950-4f76-b979-e96c59bcfbac.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}
2023-12-22 09:10:41 [43mdestination[0m > 2023-12-22 09:10:41 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):451 - Waiting for job finish Job{job=JobId{project=reporting-340722, job=59bfa216-9af4-491d-9c59-2e1f80eb71a0, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703236241439, endTime=null, startTime=1703236241532, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=I74FGP7PePPnRjMbEMfmcA==, generatedId=reporting-340722:europe-west3.59bfa216-9af4-491d-9c59-2e1f80eb71a0, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/59bfa216-9af4-491d-9c59-2e1f80eb71a0?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1c0c0b21-5950-4f76-b979-e96c59bcfbac.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}. Status: JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:10:43 [43mdestination[0m > 2023-12-22 09:10:43 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):453 - Job finish Job{job=JobId{project=reporting-340722, job=59bfa216-9af4-491d-9c59-2e1f80eb71a0, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703236241439, endTime=null, startTime=1703236241532, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=I74FGP7PePPnRjMbEMfmcA==, generatedId=reporting-340722:europe-west3.59bfa216-9af4-491d-9c59-2e1f80eb71a0, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/59bfa216-9af4-491d-9c59-2e1f80eb71a0?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1c0c0b21-5950-4f76-b979-e96c59bcfbac.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}} with status JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:10:43 [43mdestination[0m > 2023-12-22 09:10:43 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):152 - [JobId{project=reporting-340722, job=59bfa216-9af4-491d-9c59-2e1f80eb71a0, location=europe-west3}] Target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal) is successfully appended with staging files
2023-12-22 09:10:43 [43mdestination[0m > 2023-12-22 09:10:43 [32mINFO[m i.a.c.i.d.r.FileBuffer(deleteFile):109 - Deleting tempFile data f4d24ab6-7cb7-4de9-bb34-9e18b90048515365638993628630546.csv.gz
2023-12-22 09:10:43 [43mdestination[0m > 2023-12-22 09:10:43 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:10:43 [43mdestination[0m > 2023-12-22 09:10:43 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 34913 bytes..
2023-12-22 09:10:43 [43mdestination[0m > 2023-12-22 09:10:43 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):176 - Flush Worker (6f74a) -- Worker finished flushing. Current queue size: 0
2023-12-22 09:11:33 [43mdestination[0m > 2023-12-22 09:11:33 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:11:33 [43mdestination[0m > 2023-12-22 09:11:33 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:12:33 [43mdestination[0m > 2023-12-22 09:12:33 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:12:33 [43mdestination[0m > 2023-12-22 09:12:33 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:13:33 [43mdestination[0m > 2023-12-22 09:13:33 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:13:33 [43mdestination[0m > 2023-12-22 09:13:33 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:14:33 [43mdestination[0m > 2023-12-22 09:14:33 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:14:33 [43mdestination[0m > 2023-12-22 09:14:33 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:15:33 [43mdestination[0m > 2023-12-22 09:15:33 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:15:33 [43mdestination[0m > 2023-12-22 09:15:33 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:15:40 [43mdestination[0m > 2023-12-22 09:15:40 [32mINFO[m i.a.c.i.d.DetectStreamToFlush(getNextStreamToFlush):122 - flushing: trigger info: sources - spendesk_payables, time trigger: true , size trigger: false current threshold b: 200 MB, queue size b: 0 bytes, penalty b: 0 bytes, after penalty b: 0 bytes
2023-12-22 09:15:40 [43mdestination[0m > 2023-12-22 09:15:40 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):152 - Flush Worker (20611) -- Worker picked up work.
2023-12-22 09:15:40 [43mdestination[0m > 2023-12-22 09:15:40 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):154 - Flush Worker (20611) -- Attempting to read from queue namespace: sources, stream: spendesk_payables.
2023-12-22 09:15:40 [43mdestination[0m > 2023-12-22 09:15:40 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:15:40 [43mdestination[0m > 2023-12-22 09:15:40 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):167 - Flush Worker (20611) -- Batch contains: 0 records, 0 bytes bytes.
2023-12-22 09:15:40 [43mdestination[0m > 2023-12-22 09:15:40 [33mWARN[m i.a.c.i.d.s.c.CsvSerializedBuffer(flushWriter):85 - Trying to flush but no printer is initialized.
2023-12-22 09:15:40 [43mdestination[0m > 2023-12-22 09:15:40 [33mWARN[m i.a.c.i.d.s.c.CsvSerializedBuffer(closeWriter):95 - Trying to close but no printer is initialized.
2023-12-22 09:15:40 [43mdestination[0m > 2023-12-22 09:15:40 [32mINFO[m i.a.c.i.d.r.BaseSerializedBuffer(flush):172 - Finished writing data to 43e79519-af43-4631-8106-acf5c6302b7312463152181654008385.csv.gz (0 bytes)
2023-12-22 09:15:40 [43mdestination[0m > 2023-12-22 09:15:40 [32mINFO[m i.a.i.d.b.BigQueryAsyncFlush(flush):61 - Flushing CSV buffer for stream spendesk_payables (0 bytes) to staging
2023-12-22 09:15:40 [43mdestination[0m > 2023-12-22 09:15:40 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(uploadRecordsToStage):116 - Uploading records to staging for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/
2023-12-22 09:15:40 [43mdestination[0m > 2023-12-22 09:15:40 [32mINFO[m a.m.s.StreamTransferManager(getMultiPartOutputStreams):329 - Initiated multipart upload to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/cdfcb020-5f21-42f5-89cd-153d1437f260.csv.gz with full ID ABPnzm4LPQkzbymq7nYEwCX2XaEi3eErOqthVMIVjWEGabSqBO83VZ0MV2XY2BTghovCkJ1s
2023-12-22 09:15:40 [43mdestination[0m > 2023-12-22 09:15:40 [32mINFO[m a.m.s.MultiPartOutputStream(close):158 - Called close() on [MultipartOutputStream for parts 1 - 10000]
2023-12-22 09:15:40 [43mdestination[0m > 2023-12-22 09:15:40 [32mINFO[m a.m.s.StreamTransferManager(complete):395 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/cdfcb020-5f21-42f5-89cd-153d1437f260.csv.gz with id ABPnzm4LP...ghovCkJ1s]: Completed
2023-12-22 09:15:41 [43mdestination[0m > 2023-12-22 09:15:41 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(loadDataIntoBucket):214 - Uploaded buffer file to storage: 43e79519-af43-4631-8106-acf5c6302b7312463152181654008385.csv.gz -> ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/cdfcb020-5f21-42f5-89cd-153d1437f260.csv.gz (filename: cdfcb020-5f21-42f5-89cd-153d1437f260.csv.gz)
2023-12-22 09:15:41 [43mdestination[0m > 2023-12-22 09:15:41 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(uploadRecordsToBucket):131 - Successfully loaded records to stage ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/ with 0 re-attempt(s)
2023-12-22 09:15:41 [43mdestination[0m > 2023-12-22 09:15:41 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):134 - Uploading records from staging files to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): cdfcb020-5f21-42f5-89cd-153d1437f260.csv.gz
2023-12-22 09:15:41 [43mdestination[0m > 2023-12-22 09:15:41 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):138 - Uploading staged file: gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/cdfcb020-5f21-42f5-89cd-153d1437f260.csv.gz
2023-12-22 09:15:41 [43mdestination[0m > 2023-12-22 09:15:41 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):147 - [JobId{project=reporting-340722, job=2e39cd57-cce5-47f0-a718-aabcd8d847ed, location=europe-west3}] Created a new job to upload record(s) to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): Job{job=JobId{project=reporting-340722, job=2e39cd57-cce5-47f0-a718-aabcd8d847ed, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703236541277, endTime=null, startTime=1703236541397, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=XWvZKsGPsnEFYS0IFsW04g==, generatedId=reporting-340722:europe-west3.2e39cd57-cce5-47f0-a718-aabcd8d847ed, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/2e39cd57-cce5-47f0-a718-aabcd8d847ed?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/cdfcb020-5f21-42f5-89cd-153d1437f260.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}
2023-12-22 09:15:41 [43mdestination[0m > 2023-12-22 09:15:41 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):451 - Waiting for job finish Job{job=JobId{project=reporting-340722, job=2e39cd57-cce5-47f0-a718-aabcd8d847ed, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703236541277, endTime=null, startTime=1703236541397, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=XWvZKsGPsnEFYS0IFsW04g==, generatedId=reporting-340722:europe-west3.2e39cd57-cce5-47f0-a718-aabcd8d847ed, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/2e39cd57-cce5-47f0-a718-aabcd8d847ed?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/cdfcb020-5f21-42f5-89cd-153d1437f260.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}. Status: JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:15:44 [43mdestination[0m > 2023-12-22 09:15:44 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):453 - Job finish Job{job=JobId{project=reporting-340722, job=2e39cd57-cce5-47f0-a718-aabcd8d847ed, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703236541277, endTime=null, startTime=1703236541397, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=XWvZKsGPsnEFYS0IFsW04g==, generatedId=reporting-340722:europe-west3.2e39cd57-cce5-47f0-a718-aabcd8d847ed, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/2e39cd57-cce5-47f0-a718-aabcd8d847ed?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/cdfcb020-5f21-42f5-89cd-153d1437f260.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}} with status JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:15:44 [43mdestination[0m > 2023-12-22 09:15:44 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):152 - [JobId{project=reporting-340722, job=2e39cd57-cce5-47f0-a718-aabcd8d847ed, location=europe-west3}] Target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal) is successfully appended with staging files
2023-12-22 09:15:44 [43mdestination[0m > 2023-12-22 09:15:44 [32mINFO[m i.a.c.i.d.r.FileBuffer(deleteFile):109 - Deleting tempFile data 43e79519-af43-4631-8106-acf5c6302b7312463152181654008385.csv.gz
2023-12-22 09:15:44 [43mdestination[0m > 2023-12-22 09:15:44 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:15:44 [43mdestination[0m > 2023-12-22 09:15:44 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:15:44 [43mdestination[0m > 2023-12-22 09:15:44 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):176 - Flush Worker (20611) -- Worker finished flushing. Current queue size: 0
2023-12-22 09:16:33 [43mdestination[0m > 2023-12-22 09:16:33 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:16:33 [43mdestination[0m > 2023-12-22 09:16:33 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:16:41 [46mplatform[0m > processMessage: done. (fromSource.isDone:true, forDest.isClosed:false)
2023-12-22 09:16:41 [46mplatform[0m > writeToDestination: done. (forDest.isDone:true, isDestRunning:true)
2023-12-22 09:16:41 [46mplatform[0m > thread status... timeout thread: false , replication thread: true
2023-12-22 09:16:41 [43mdestination[0m > 2023-12-22 09:16:41 [32mINFO[m i.a.c.i.d.FlushWorkers(close):191 - Closing flush workers -- waiting for all buffers to flush
2023-12-22 09:16:41 [43mdestination[0m > 2023-12-22 09:16:41 [32mINFO[m i.a.c.i.d.FlushWorkers(close):216 - REMAINING_BUFFERS_INFO
2023-12-22 09:16:41 [43mdestination[0m >   Namespace: sources Stream: spendesk_payables -- remaining records: 1
2023-12-22 09:16:41 [43mdestination[0m > 2023-12-22 09:16:41 [32mINFO[m i.a.c.i.d.FlushWorkers(close):217 - Waiting for all streams to flush.
2023-12-22 09:16:42 [43mdestination[0m > 2023-12-22 09:16:42 [32mINFO[m i.a.c.i.d.DetectStreamToFlush(getNextStreamToFlush):122 - flushing: trigger info: sources - spendesk_payables, time trigger: false , size trigger: true current threshold b: 0 bytes, queue size b: 1.1 KB, penalty b: 0 bytes, after penalty b: 1.1 KB
2023-12-22 09:16:42 [43mdestination[0m > 2023-12-22 09:16:42 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):152 - Flush Worker (67d75) -- Worker picked up work.
2023-12-22 09:16:42 [43mdestination[0m > 2023-12-22 09:16:42 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):154 - Flush Worker (67d75) -- Attempting to read from queue namespace: sources, stream: spendesk_payables.
2023-12-22 09:16:42 [43mdestination[0m > 2023-12-22 09:16:42 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 10484632 bytes..
2023-12-22 09:16:42 [43mdestination[0m > 2023-12-22 09:16:42 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):167 - Flush Worker (67d75) -- Batch contains: 1 records, 1.1 KB bytes.
2023-12-22 09:16:42 [43mdestination[0m > 2023-12-22 09:16:42 [32mINFO[m i.a.c.i.d.r.BaseSerializedBuffer(flush):172 - Finished writing data to f940bc2f-aa70-4de6-80a1-856daea102a912552959931452095131.csv.gz (606 bytes)
2023-12-22 09:16:42 [43mdestination[0m > 2023-12-22 09:16:42 [32mINFO[m i.a.i.d.b.BigQueryAsyncFlush(flush):61 - Flushing CSV buffer for stream spendesk_payables (606 bytes) to staging
2023-12-22 09:16:42 [43mdestination[0m > 2023-12-22 09:16:42 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(uploadRecordsToStage):116 - Uploading records to staging for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/
2023-12-22 09:16:42 [43mdestination[0m > 2023-12-22 09:16:42 [32mINFO[m a.m.s.StreamTransferManager(getMultiPartOutputStreams):329 - Initiated multipart upload to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1d55cb34-4d49-4883-9a93-abb5dcf6dbc2.csv.gz with full ID ABPnzm6aqnbLthICD6ufhboZDIQk5abf99oL7eA_lzd1vGv6ZlVQD661JoDKL2PENvhHBq_a
2023-12-22 09:16:42 [43mdestination[0m > 2023-12-22 09:16:42 [32mINFO[m a.m.s.MultiPartOutputStream(close):158 - Called close() on [MultipartOutputStream for parts 1 - 10000]
2023-12-22 09:16:42 [43mdestination[0m > 2023-12-22 09:16:42 [32mINFO[m a.m.s.StreamTransferManager(complete):367 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1d55cb34-4d49-4883-9a93-abb5dcf6dbc2.csv.gz with id ABPnzm6aq...ENvhHBq_a]: Uploading leftover stream [Part number 1 containing 0.00 MB]
2023-12-22 09:16:42 [43mdestination[0m > 2023-12-22 09:16:42 [32mINFO[m i.a.c.i.d.FlushWorkers(close):220 - Closing flush workers -- all buffers flushed
2023-12-22 09:16:42 [43mdestination[0m > 2023-12-22 09:16:42 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:16:42 [43mdestination[0m > 2023-12-22 09:16:42 [32mINFO[m i.a.c.i.d.FlushWorkers(close):226 - Closing flush workers -- Supervisor shutdown status: true
2023-12-22 09:16:42 [43mdestination[0m > 2023-12-22 09:16:42 [32mINFO[m i.a.c.i.d.FlushWorkers(close):228 - Closing flush workers -- Starting worker pool shutdown..
2023-12-22 09:16:43 [43mdestination[0m > 2023-12-22 09:16:43 [32mINFO[m a.m.s.StreamTransferManager(uploadStreamPart):558 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1d55cb34-4d49-4883-9a93-abb5dcf6dbc2.csv.gz with id ABPnzm6aq...ENvhHBq_a]: Finished uploading [Part number 1 containing 0.00 MB]
2023-12-22 09:16:43 [43mdestination[0m > 2023-12-22 09:16:43 [32mINFO[m a.m.s.StreamTransferManager(complete):395 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1d55cb34-4d49-4883-9a93-abb5dcf6dbc2.csv.gz with id ABPnzm6aq...ENvhHBq_a]: Completed
2023-12-22 09:16:43 [43mdestination[0m > 2023-12-22 09:16:43 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(loadDataIntoBucket):214 - Uploaded buffer file to storage: f940bc2f-aa70-4de6-80a1-856daea102a912552959931452095131.csv.gz -> ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1d55cb34-4d49-4883-9a93-abb5dcf6dbc2.csv.gz (filename: 1d55cb34-4d49-4883-9a93-abb5dcf6dbc2.csv.gz)
2023-12-22 09:16:43 [43mdestination[0m > 2023-12-22 09:16:43 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(uploadRecordsToBucket):131 - Successfully loaded records to stage ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/ with 0 re-attempt(s)
2023-12-22 09:16:43 [43mdestination[0m > 2023-12-22 09:16:43 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):134 - Uploading records from staging files to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): 1d55cb34-4d49-4883-9a93-abb5dcf6dbc2.csv.gz
2023-12-22 09:16:43 [43mdestination[0m > 2023-12-22 09:16:43 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):138 - Uploading staged file: gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1d55cb34-4d49-4883-9a93-abb5dcf6dbc2.csv.gz
2023-12-22 09:16:43 [43mdestination[0m > 2023-12-22 09:16:43 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):147 - [JobId{project=reporting-340722, job=6f0e6d74-37a2-424d-9895-d7bdecd65b67, location=europe-west3}] Created a new job to upload record(s) to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): Job{job=JobId{project=reporting-340722, job=6f0e6d74-37a2-424d-9895-d7bdecd65b67, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703236603403, endTime=null, startTime=1703236603472, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=nwpRAJszPQJDoi03JRj2xg==, generatedId=reporting-340722:europe-west3.6f0e6d74-37a2-424d-9895-d7bdecd65b67, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/6f0e6d74-37a2-424d-9895-d7bdecd65b67?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1d55cb34-4d49-4883-9a93-abb5dcf6dbc2.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}
2023-12-22 09:16:43 [43mdestination[0m > 2023-12-22 09:16:43 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):451 - Waiting for job finish Job{job=JobId{project=reporting-340722, job=6f0e6d74-37a2-424d-9895-d7bdecd65b67, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703236603403, endTime=null, startTime=1703236603472, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=nwpRAJszPQJDoi03JRj2xg==, generatedId=reporting-340722:europe-west3.6f0e6d74-37a2-424d-9895-d7bdecd65b67, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/6f0e6d74-37a2-424d-9895-d7bdecd65b67?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1d55cb34-4d49-4883-9a93-abb5dcf6dbc2.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}. Status: JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:16:45 [43mdestination[0m > 2023-12-22 09:16:45 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):453 - Job finish Job{job=JobId{project=reporting-340722, job=6f0e6d74-37a2-424d-9895-d7bdecd65b67, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703236603403, endTime=null, startTime=1703236603472, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=nwpRAJszPQJDoi03JRj2xg==, generatedId=reporting-340722:europe-west3.6f0e6d74-37a2-424d-9895-d7bdecd65b67, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/6f0e6d74-37a2-424d-9895-d7bdecd65b67?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1d55cb34-4d49-4883-9a93-abb5dcf6dbc2.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}} with status JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:16:45 [43mdestination[0m > 2023-12-22 09:16:45 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):152 - [JobId{project=reporting-340722, job=6f0e6d74-37a2-424d-9895-d7bdecd65b67, location=europe-west3}] Target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal) is successfully appended with staging files
2023-12-22 09:16:45 [43mdestination[0m > 2023-12-22 09:16:45 [32mINFO[m i.a.c.i.d.r.FileBuffer(deleteFile):109 - Deleting tempFile data f940bc2f-aa70-4de6-80a1-856daea102a912552959931452095131.csv.gz
2023-12-22 09:16:45 [43mdestination[0m > 2023-12-22 09:16:45 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:16:45 [43mdestination[0m > 2023-12-22 09:16:45 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 1128 bytes..
2023-12-22 09:16:45 [43mdestination[0m > 2023-12-22 09:16:45 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):176 - Flush Worker (67d75) -- Worker finished flushing. Current queue size: 0
2023-12-22 09:16:45 [43mdestination[0m > 2023-12-22 09:16:45 [32mINFO[m i.a.c.i.d.FlushWorkers(close):231 - Closing flush workers -- Workers shutdown status: true
2023-12-22 09:16:45 [43mdestination[0m > 2023-12-22 09:16:45 [32mINFO[m i.a.c.i.d.b.BufferManager(close):92 - Buffers cleared..
2023-12-22 09:16:45 [43mdestination[0m > 2023-12-22 09:16:45 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(typeAndDedupe):242 - Typing and deduping all tables
2023-12-22 09:16:45 [43mdestination[0m > 2023-12-22 09:16:45 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$typeAndDedupeTask$2):216 - Waiting for raw table writes to pause for sources.spendesk_payables
2023-12-22 09:16:45 [43mdestination[0m > 2023-12-22 09:16:45 [32mINFO[m i.a.i.b.d.t.TypeAndDedupeTransaction(executeTypeAndDedupe):36 - Attempting typing and deduping for sources.spendesk_payables with suffix
2023-12-22 09:16:45 [43mdestination[0m > 2023-12-22 09:16:45 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):99 - Executing sql b25a4bbb-a6bc-41a0-84cc-74a046feaf56: BEGIN TRANSACTION;
2023-12-22 09:16:45 [43mdestination[0m > INSERT INTO `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp`
2023-12-22 09:16:45 [43mdestination[0m > (
2023-12-22 09:16:45 [43mdestination[0m > `id`,
2023-12-22 09:16:45 [43mdestination[0m > `type`,
2023-12-22 09:16:45 [43mdestination[0m > `amount`,
2023-12-22 09:16:45 [43mdestination[0m > `teamId`,
2023-12-22 09:16:45 [43mdestination[0m > `userId`,
2023-12-22 09:16:45 [43mdestination[0m > `currency`,
2023-12-22 09:16:45 [43mdestination[0m > `teamName`,
2023-12-22 09:16:45 [43mdestination[0m > `companyId`,
2023-12-22 09:16:45 [43mdestination[0m > `lineItems`,
2023-12-22 09:16:45 [43mdestination[0m > `exportedAt`,
2023-12-22 09:16:45 [43mdestination[0m > `allocations`,
2023-12-22 09:16:45 [43mdestination[0m > `description`,
2023-12-22 09:16:45 [43mdestination[0m > `payableDate`,
2023-12-22 09:16:45 [43mdestination[0m > `costCenterId`,
2023-12-22 09:16:45 [43mdestination[0m > `counterparty`,
2023-12-22 09:16:45 [43mdestination[0m > `invoiceNumber`,
2023-12-22 09:16:45 [43mdestination[0m > `costCenterName`,
2023-12-22 09:16:45 [43mdestination[0m > `invoiceDueDate`,
2023-12-22 09:16:45 [43mdestination[0m > `functionalAmount`,
2023-12-22 09:16:45 [43mdestination[0m > `bookkeepingStatus`,
2023-12-22 09:16:45 [43mdestination[0m > `functionalCurrency`,
2023-12-22 09:16:45 [43mdestination[0m > `documentaryEvidence`,
2023-12-22 09:16:45 [43mdestination[0m > `analyticalProperties`,
2023-12-22 09:16:45 [43mdestination[0m > `functionalExchangeRate`,
2023-12-22 09:16:45 [43mdestination[0m >   _airbyte_meta,
2023-12-22 09:16:45 [43mdestination[0m >   _airbyte_raw_id,
2023-12-22 09:16:45 [43mdestination[0m >   _airbyte_extracted_at
2023-12-22 09:16:45 [43mdestination[0m > )
2023-12-22 09:16:45 [43mdestination[0m > WITH intermediate_data AS (
2023-12-22 09:16:45 [43mdestination[0m >   SELECT
2023-12-22 09:16:45 [43mdestination[0m > (CASE
2023-12-22 09:16:45 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."id"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."id"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:16:45 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."id"')
2023-12-22 09:16:45 [43mdestination[0m >     ELSE
2023-12-22 09:16:45 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."id"')
2023-12-22 09:16:45 [43mdestination[0m >   END)
2023-12-22 09:16:45 [43mdestination[0m >  as `id`,
2023-12-22 09:16:45 [43mdestination[0m > (CASE
2023-12-22 09:16:45 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."type"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."type"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:16:45 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."type"')
2023-12-22 09:16:45 [43mdestination[0m >     ELSE
2023-12-22 09:16:45 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."type"')
2023-12-22 09:16:45 [43mdestination[0m >   END)
2023-12-22 09:16:45 [43mdestination[0m >  as `type`,
2023-12-22 09:16:45 [43mdestination[0m > CAST(JSON_VALUE(`_airbyte_data`, '$."amount"') as NUMERIC) as `amount`,
2023-12-22 09:16:45 [43mdestination[0m > (CASE
2023-12-22 09:16:45 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."teamId"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."teamId"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:16:45 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."teamId"')
2023-12-22 09:16:45 [43mdestination[0m >     ELSE
2023-12-22 09:16:45 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."teamId"')
2023-12-22 09:16:45 [43mdestination[0m >   END)
2023-12-22 09:16:45 [43mdestination[0m >  as `teamId`,
2023-12-22 09:16:45 [43mdestination[0m > (CASE
2023-12-22 09:16:45 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."userId"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."userId"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:16:45 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."userId"')
2023-12-22 09:16:45 [43mdestination[0m >     ELSE
2023-12-22 09:16:45 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."userId"')
2023-12-22 09:16:45 [43mdestination[0m >   END)
2023-12-22 09:16:45 [43mdestination[0m >  as `userId`,
2023-12-22 09:16:45 [43mdestination[0m > (CASE
2023-12-22 09:16:45 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."currency"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."currency"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:16:45 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."currency"')
2023-12-22 09:16:45 [43mdestination[0m >     ELSE
2023-12-22 09:16:45 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."currency"')
2023-12-22 09:16:45 [43mdestination[0m >   END)
2023-12-22 09:16:45 [43mdestination[0m >  as `currency`,
2023-12-22 09:16:45 [43mdestination[0m > (CASE
2023-12-22 09:16:45 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."teamName"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."teamName"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:16:45 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."teamName"')
2023-12-22 09:16:45 [43mdestination[0m >     ELSE
2023-12-22 09:16:45 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."teamName"')
2023-12-22 09:16:45 [43mdestination[0m >   END)
2023-12-22 09:16:45 [43mdestination[0m >  as `teamName`,
2023-12-22 09:16:45 [43mdestination[0m > (CASE
2023-12-22 09:16:45 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."companyId"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."companyId"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:16:45 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."companyId"')
2023-12-22 09:16:45 [43mdestination[0m >     ELSE
2023-12-22 09:16:45 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."companyId"')
2023-12-22 09:16:45 [43mdestination[0m >   END)
2023-12-22 09:16:45 [43mdestination[0m >  as `companyId`,
2023-12-22 09:16:45 [43mdestination[0m > PARSE_JSON(CASE
2023-12-22 09:16:45 [43mdestination[0m >   WHEN JSON_QUERY(`_airbyte_data`, '$."lineItems"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >     OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."lineItems"'), wide_number_mode=>'round')) != 'array'
2023-12-22 09:16:45 [43mdestination[0m >     THEN NULL
2023-12-22 09:16:45 [43mdestination[0m >   ELSE JSON_QUERY(`_airbyte_data`, '$."lineItems"')
2023-12-22 09:16:45 [43mdestination[0m > END, wide_number_mode=>'round')
2023-12-22 09:16:45 [43mdestination[0m >  as `lineItems`,
2023-12-22 09:16:45 [43mdestination[0m > (CASE
2023-12-22 09:16:45 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."exportedAt"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."exportedAt"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:16:45 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."exportedAt"')
2023-12-22 09:16:45 [43mdestination[0m >     ELSE
2023-12-22 09:16:45 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."exportedAt"')
2023-12-22 09:16:45 [43mdestination[0m >   END)
2023-12-22 09:16:45 [43mdestination[0m >  as `exportedAt`,
2023-12-22 09:16:45 [43mdestination[0m > PARSE_JSON(CASE
2023-12-22 09:16:45 [43mdestination[0m >   WHEN JSON_QUERY(`_airbyte_data`, '$."allocations"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >     OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."allocations"'), wide_number_mode=>'round')) != 'array'
2023-12-22 09:16:45 [43mdestination[0m >     THEN NULL
2023-12-22 09:16:45 [43mdestination[0m >   ELSE JSON_QUERY(`_airbyte_data`, '$."allocations"')
2023-12-22 09:16:45 [43mdestination[0m > END, wide_number_mode=>'round')
2023-12-22 09:16:45 [43mdestination[0m >  as `allocations`,
2023-12-22 09:16:45 [43mdestination[0m > (CASE
2023-12-22 09:16:45 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."description"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."description"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:16:45 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."description"')
2023-12-22 09:16:45 [43mdestination[0m >     ELSE
2023-12-22 09:16:45 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."description"')
2023-12-22 09:16:45 [43mdestination[0m >   END)
2023-12-22 09:16:45 [43mdestination[0m >  as `description`,
2023-12-22 09:16:45 [43mdestination[0m > (CASE
2023-12-22 09:16:45 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."payableDate"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."payableDate"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:16:45 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."payableDate"')
2023-12-22 09:16:45 [43mdestination[0m >     ELSE
2023-12-22 09:16:45 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."payableDate"')
2023-12-22 09:16:45 [43mdestination[0m >   END)
2023-12-22 09:16:45 [43mdestination[0m >  as `payableDate`,
2023-12-22 09:16:45 [43mdestination[0m > (CASE
2023-12-22 09:16:45 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."costCenterId"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."costCenterId"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:16:45 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."costCenterId"')
2023-12-22 09:16:45 [43mdestination[0m >     ELSE
2023-12-22 09:16:45 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."costCenterId"')
2023-12-22 09:16:45 [43mdestination[0m >   END)
2023-12-22 09:16:45 [43mdestination[0m >  as `costCenterId`,
2023-12-22 09:16:45 [43mdestination[0m > PARSE_JSON(CASE
2023-12-22 09:16:45 [43mdestination[0m >   WHEN JSON_QUERY(`_airbyte_data`, '$."counterparty"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >     OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."counterparty"'), wide_number_mode=>'round')) != 'object'
2023-12-22 09:16:45 [43mdestination[0m >     THEN NULL
2023-12-22 09:16:45 [43mdestination[0m >   ELSE JSON_QUERY(`_airbyte_data`, '$."counterparty"')
2023-12-22 09:16:45 [43mdestination[0m > END, wide_number_mode=>'round')
2023-12-22 09:16:45 [43mdestination[0m >  as `counterparty`,
2023-12-22 09:16:45 [43mdestination[0m > (CASE
2023-12-22 09:16:45 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."invoiceNumber"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."invoiceNumber"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:16:45 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."invoiceNumber"')
2023-12-22 09:16:45 [43mdestination[0m >     ELSE
2023-12-22 09:16:45 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."invoiceNumber"')
2023-12-22 09:16:45 [43mdestination[0m >   END)
2023-12-22 09:16:45 [43mdestination[0m >  as `invoiceNumber`,
2023-12-22 09:16:45 [43mdestination[0m > (CASE
2023-12-22 09:16:45 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."costCenterName"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."costCenterName"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:16:45 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."costCenterName"')
2023-12-22 09:16:45 [43mdestination[0m >     ELSE
2023-12-22 09:16:45 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."costCenterName"')
2023-12-22 09:16:45 [43mdestination[0m >   END)
2023-12-22 09:16:45 [43mdestination[0m >  as `costCenterName`,
2023-12-22 09:16:45 [43mdestination[0m > (CASE
2023-12-22 09:16:45 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."invoiceDueDate"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."invoiceDueDate"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:16:45 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."invoiceDueDate"')
2023-12-22 09:16:45 [43mdestination[0m >     ELSE
2023-12-22 09:16:45 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."invoiceDueDate"')
2023-12-22 09:16:45 [43mdestination[0m >   END)
2023-12-22 09:16:45 [43mdestination[0m >  as `invoiceDueDate`,
2023-12-22 09:16:45 [43mdestination[0m > CAST(JSON_VALUE(`_airbyte_data`, '$."functionalAmount"') as NUMERIC) as `functionalAmount`,
2023-12-22 09:16:45 [43mdestination[0m > (CASE
2023-12-22 09:16:45 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."bookkeepingStatus"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."bookkeepingStatus"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:16:45 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."bookkeepingStatus"')
2023-12-22 09:16:45 [43mdestination[0m >     ELSE
2023-12-22 09:16:45 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."bookkeepingStatus"')
2023-12-22 09:16:45 [43mdestination[0m >   END)
2023-12-22 09:16:45 [43mdestination[0m >  as `bookkeepingStatus`,
2023-12-22 09:16:45 [43mdestination[0m > (CASE
2023-12-22 09:16:45 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."functionalCurrency"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."functionalCurrency"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:16:45 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."functionalCurrency"')
2023-12-22 09:16:45 [43mdestination[0m >     ELSE
2023-12-22 09:16:45 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."functionalCurrency"')
2023-12-22 09:16:45 [43mdestination[0m >   END)
2023-12-22 09:16:45 [43mdestination[0m >  as `functionalCurrency`,
2023-12-22 09:16:45 [43mdestination[0m > PARSE_JSON(CASE
2023-12-22 09:16:45 [43mdestination[0m >   WHEN JSON_QUERY(`_airbyte_data`, '$."documentaryEvidence"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >     OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."documentaryEvidence"'), wide_number_mode=>'round')) != 'object'
2023-12-22 09:16:45 [43mdestination[0m >     THEN NULL
2023-12-22 09:16:45 [43mdestination[0m >   ELSE JSON_QUERY(`_airbyte_data`, '$."documentaryEvidence"')
2023-12-22 09:16:45 [43mdestination[0m > END, wide_number_mode=>'round')
2023-12-22 09:16:45 [43mdestination[0m >  as `documentaryEvidence`,
2023-12-22 09:16:45 [43mdestination[0m > PARSE_JSON(CASE
2023-12-22 09:16:45 [43mdestination[0m >   WHEN JSON_QUERY(`_airbyte_data`, '$."analyticalProperties"') IS NULL
2023-12-22 09:16:45 [43mdestination[0m >     OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."analyticalProperties"'), wide_number_mode=>'round')) != 'array'
2023-12-22 09:16:45 [43mdestination[0m >     THEN NULL
2023-12-22 09:16:45 [43mdestination[0m >   ELSE JSON_QUERY(`_airbyte_data`, '$."analyticalProperties"')
2023-12-22 09:16:45 [43mdestination[0m > END, wide_number_mode=>'round')
2023-12-22 09:16:45 [43mdestination[0m >  as `analyticalProperties`,
2023-12-22 09:16:45 [43mdestination[0m > CAST(JSON_VALUE(`_airbyte_data`, '$."functionalExchangeRate"') as NUMERIC) as `functionalExchangeRate`,
2023-12-22 09:16:45 [43mdestination[0m >   [] AS column_errors,
2023-12-22 09:16:45 [43mdestination[0m >   _airbyte_raw_id,
2023-12-22 09:16:45 [43mdestination[0m >   _airbyte_extracted_at
2023-12-22 09:16:45 [43mdestination[0m >   FROM `reporting-340722`.`airbyte_internal`.`sources_raw__stream_spendesk_payables`
2023-12-22 09:16:45 [43mdestination[0m >   WHERE
2023-12-22 09:16:45 [43mdestination[0m >     _airbyte_loaded_at IS NULL
2023-12-22 09:16:45 [43mdestination[0m >      AND _airbyte_extracted_at > '2023-12-22T08:53:45.201Z'
2023-12-22 09:16:45 [43mdestination[0m > )
2023-12-22 09:16:45 [43mdestination[0m > SELECT
2023-12-22 09:16:45 [43mdestination[0m > `id`,
2023-12-22 09:16:45 [43mdestination[0m > `type`,
2023-12-22 09:16:45 [43mdestination[0m > `amount`,
2023-12-22 09:16:45 [43mdestination[0m > `teamId`,
2023-12-22 09:16:45 [43mdestination[0m > `userId`,
2023-12-22 09:16:45 [43mdestination[0m > `currency`,
2023-12-22 09:16:45 [43mdestination[0m > `teamName`,
2023-12-22 09:16:45 [43mdestination[0m > `companyId`,
2023-12-22 09:16:45 [43mdestination[0m > `lineItems`,
2023-12-22 09:16:45 [43mdestination[0m > `exportedAt`,
2023-12-22 09:16:45 [43mdestination[0m > `allocations`,
2023-12-22 09:16:45 [43mdestination[0m > `description`,
2023-12-22 09:16:45 [43mdestination[0m > `payableDate`,
2023-12-22 09:16:45 [43mdestination[0m > `costCenterId`,
2023-12-22 09:16:45 [43mdestination[0m > `counterparty`,
2023-12-22 09:16:45 [43mdestination[0m > `invoiceNumber`,
2023-12-22 09:16:45 [43mdestination[0m > `costCenterName`,
2023-12-22 09:16:45 [43mdestination[0m > `invoiceDueDate`,
2023-12-22 09:16:45 [43mdestination[0m > `functionalAmount`,
2023-12-22 09:16:45 [43mdestination[0m > `bookkeepingStatus`,
2023-12-22 09:16:45 [43mdestination[0m > `functionalCurrency`,
2023-12-22 09:16:45 [43mdestination[0m > `documentaryEvidence`,
2023-12-22 09:16:45 [43mdestination[0m > `analyticalProperties`,
2023-12-22 09:16:45 [43mdestination[0m > `functionalExchangeRate`,
2023-12-22 09:16:45 [43mdestination[0m >   to_json(struct(COALESCE((SELECT ARRAY_AGG(unnested_column_errors IGNORE NULLS) FROM UNNEST(column_errors) unnested_column_errors), []) AS errors)) AS _airbyte_meta,
2023-12-22 09:16:45 [43mdestination[0m >   _airbyte_raw_id,
2023-12-22 09:16:45 [43mdestination[0m >   _airbyte_extracted_at
2023-12-22 09:16:45 [43mdestination[0m > FROM intermediate_data;
2023-12-22 09:16:45 [43mdestination[0m > UPDATE `reporting-340722`.`airbyte_internal`.`sources_raw__stream_spendesk_payables`
2023-12-22 09:16:45 [43mdestination[0m > SET `_airbyte_loaded_at` = CURRENT_TIMESTAMP()
2023-12-22 09:16:45 [43mdestination[0m > WHERE `_airbyte_loaded_at` IS NULL
2023-12-22 09:16:45 [43mdestination[0m >    AND _airbyte_extracted_at > '2023-12-22T08:53:45.201Z'
2023-12-22 09:16:45 [43mdestination[0m > ;
2023-12-22 09:16:45 [43mdestination[0m > COMMIT TRANSACTION;
2023-12-22 09:16:45 [43mdestination[0m > 
2023-12-22 09:16:51 [43mdestination[0m > 2023-12-22 09:16:51 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):119 - Root-level job b25a4bbb-a6bc-41a0-84cc-74a046feaf56 completed in 4915 ms; processed 64642 bytes; billed for 31457280 bytes
2023-12-22 09:16:51 [43mdestination[0m > 2023-12-22 09:16:51 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql BEGIN TRANSACTION completed in 44 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:16:51 [43mdestination[0m > 2023-12-22 09:16:51 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql INSERT INTO `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` ( `id`, `type`, `amount`, `... completed in 1708 ms; processed 32321 bytes; billed for 20971520 bytes
2023-12-22 09:16:51 [43mdestination[0m > 2023-12-22 09:16:51 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql UPDATE `reporting-340722`.`airbyte_internal`.`sources_raw__stream_spendesk_payables` SET `_airbyte_l... completed in 1647 ms; processed 32321 bytes; billed for 10485760 bytes
2023-12-22 09:16:51 [43mdestination[0m > 2023-12-22 09:16:51 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql COMMIT TRANSACTION completed in 159 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:16:51 [43mdestination[0m > 2023-12-22 09:16:51 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$typeAndDedupeTask$2):224 - Allowing other threads to proceed for sources.spendesk_payables
2023-12-22 09:16:51 [43mdestination[0m > 2023-12-22 09:16:51 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onCloseFunction$4):179 - Cleaning up destination started for 1 streams
2023-12-22 09:16:51 [43mdestination[0m > 2023-12-22 09:16:51 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(dropStageIfExists):186 - Cleaning up staging path for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables
2023-12-22 09:16:51 [43mdestination[0m > 2023-12-22 09:16:51 [32mINFO[m i.a.i.d.g.GcsStorageOperations(cleanUpObjects):43 - Deleting object ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1c0c0b21-5950-4f76-b979-e96c59bcfbac.csv.gz
2023-12-22 09:16:51 [43mdestination[0m > 2023-12-22 09:16:51 [32mINFO[m i.a.i.d.g.GcsStorageOperations(cleanUpObjects):43 - Deleting object ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/1d55cb34-4d49-4883-9a93-abb5dcf6dbc2.csv.gz
2023-12-22 09:16:51 [43mdestination[0m > 2023-12-22 09:16:51 [32mINFO[m i.a.i.d.g.GcsStorageOperations(cleanUpObjects):43 - Deleting object ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/0652e5c6-f25b-4df4-9a02-0ca95ecb9c00/cdfcb020-5f21-42f5-89cd-153d1437f260.csv.gz
2023-12-22 09:16:52 [43mdestination[0m > 2023-12-22 09:16:52 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(cleanUpBucketObject):295 - Storage bucket ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables has been cleaned-up (3 objects were deleted)...
2023-12-22 09:16:52 [43mdestination[0m > 2023-12-22 09:16:52 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(commitFinalTables):258 - Committing final tables
2023-12-22 09:16:52 [43mdestination[0m > 2023-12-22 09:16:52 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$commitFinalTableTask$6):281 - Overwriting final table with tmp table for stream sources.spendesk_payables
2023-12-22 09:16:52 [43mdestination[0m > 2023-12-22 09:16:52 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):99 - Executing sql 85df82a2-9eab-4698-a36c-db9494ba1397: DROP TABLE IF EXISTS `reporting-340722`.`sources`.`spendesk_payables`;
2023-12-22 09:16:52 [43mdestination[0m > ALTER TABLE `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` RENAME TO `spendesk_payables`;
2023-12-22 09:16:52 [43mdestination[0m > 
2023-12-22 09:16:54 [43mdestination[0m > 2023-12-22 09:16:54 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):119 - Root-level job 85df82a2-9eab-4698-a36c-db9494ba1397 completed in 1183 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:16:54 [43mdestination[0m > 2023-12-22 09:16:54 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql DROP TABLE IF EXISTS `reporting-340722`.`sources`.`spendesk_payables` completed in 115 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:16:54 [43mdestination[0m > 2023-12-22 09:16:54 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql ALTER TABLE `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` RENAME TO `spendesk_payable... completed in 583 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:16:54 [43mdestination[0m > 2023-12-22 09:16:54 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(cleanup):299 - Cleaning Up type-and-dedupe thread pool
2023-12-22 09:16:54 [43mdestination[0m > 2023-12-22 09:16:54 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onCloseFunction$4):185 - Cleaning up destination completed.
2023-12-22 09:16:54 [43mdestination[0m > 2023-12-22 09:16:54 [32mINFO[m i.a.c.i.d.AsyncStreamConsumer(close):211 - class io.airbyte.cdk.integrations.destination_async.AsyncStreamConsumer closed
2023-12-22 09:16:54 [43mdestination[0m > 2023-12-22 09:16:54 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):228 - Completed integration: io.airbyte.integrations.destination.bigquery.BigQueryDestination
2023-12-22 09:16:54 [46mplatform[0m > readFromDestination: done. (writeToDestFailed:false, dest.isFinished:true)
2023-12-22 09:16:54 [46mplatform[0m > thread status... timeout thread: false , replication thread: true
2023-12-22 09:16:54 [46mplatform[0m > sync summary: {
  "status" : "failed",
  "recordsSynced" : 0,
  "bytesSynced" : 0,
  "startTime" : 1703235927000,
  "endTime" : 1703236614707,
  "totalStats" : {
    "bytesCommitted" : 0,
    "bytesEmitted" : 30871,
    "destinationStateMessagesEmitted" : 0,
    "destinationWriteEndTime" : 1703236614703,
    "destinationWriteStartTime" : 1703235927001,
    "meanSecondsBeforeSourceStateMessageEmitted" : 0,
    "maxSecondsBeforeSourceStateMessageEmitted" : 0,
    "maxSecondsBetweenStateMessageEmittedandCommitted" : 0,
    "meanSecondsBetweenStateMessageEmittedandCommitted" : 0,
    "recordsEmitted" : 30,
    "recordsCommitted" : 0,
    "replicationEndTime" : 1703236614706,
    "replicationStartTime" : 1703235927000,
    "sourceReadEndTime" : 0,
    "sourceReadStartTime" : 1703235927001,
    "sourceStateMessagesEmitted" : 0
  },
  "streamStats" : [ {
    "streamName" : "payables",
    "stats" : {
      "bytesCommitted" : 0,
      "bytesEmitted" : 30871,
      "recordsEmitted" : 30,
      "recordsCommitted" : 0
    }
  } ],
  "performanceMetrics" : {
    "processFromSource" : {
      "elapsedTimeInNanos" : 615031800217,
      "executionCount" : 34,
      "avgExecTimeInNanos" : 1.8089170594617645E10
    },
    "readFromSource" : {
      "elapsedTimeInNanos" : 60118672128,
      "executionCount" : 163,
      "avgExecTimeInNanos" : 3.688262093742331E8
    },
    "processFromDest" : {
      "elapsedTimeInNanos" : 0,
      "executionCount" : 0,
      "avgExecTimeInNanos" : "NaN"
    },
    "writeToDest" : {
      "elapsedTimeInNanos" : 1799384,
      "executionCount" : 30,
      "avgExecTimeInNanos" : 59979.46666666667
    },
    "readFromDest" : {
      "elapsedTimeInNanos" : 687640382233,
      "executionCount" : 351,
      "avgExecTimeInNanos" : 1.9590894080712252E9
    }
  }
}
2023-12-22 09:16:54 [46mplatform[0m > failures: [ {
  "failureOrigin" : "source",
  "failureType" : "system_error",
  "internalMessage" : "Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {\"errors\":[{\"code\":\"INTERNAL_SERVER_ERROR\",\"detail\":\"Sorry, something has gone wrong at our end. If this persists please contact support.\"}]}",
  "externalMessage" : "Something went wrong in the connector. See the logs for more details.",
  "metadata" : {
    "attemptNumber" : 1,
    "jobId" : 292,
    "from_trace_message" : true,
    "connector_command" : "read"
  },
  "stacktrace" : "Traceback (most recent call last):\n  File \"/airbyte/integration_code/main.py\", line 29, in <module>\n    launch(source, sys.argv[1:])\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py\", line 210, in launch\n    for message in source_entrypoint.run(parsed_args):\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py\", line 117, in run\n    yield from map(AirbyteEntrypoint.airbyte_message_to_string, self.read(source_spec, config, config_catalog, state))\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py\", line 159, in read\n    yield from self.source.read(self.logger, config, catalog, state)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/manifest_declarative_source.py\", line 134, in read\n    yield from super().read(logger, config, catalog, state)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py\", line 141, in read\n    raise e\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py\", line 121, in read\n    yield from self._read_stream(\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py\", line 193, in _read_stream\n    for record in record_iterator:\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py\", line 253, in _read_full_refresh\n    for record_data_or_message in stream_instance.read_full_refresh(configured_stream.cursor_field, logger, self._slice_logger):\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/streams/core.py\", line 121, in read_full_refresh\n    yield from self.read_records(\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/declarative_stream.py\", line 104, in read_records\n    yield from self.retriever.read_records(stream_slice)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py\", line 304, in read_records\n    for stream_data in self._read_pages(self._parse_records, self.state, stream_slice):\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py\", line 282, in _read_pages\n    response = self._fetch_next_page(stream_state, stream_slice, next_page_token)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py\", line 256, in _fetch_next_page\n    return self.requester.send_request(\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py\", line 412, in send_request\n    response = self._send_with_retry(request, log_formatter=log_formatter)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py\", line 458, in _send_with_retry\n    return backoff_handler(user_backoff_handler)(request, log_formatter=log_formatter)  # type: ignore\n  File \"/usr/local/lib/python3.9/site-packages/backoff/_sync.py\", line 105, in retry\n    ret = target(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/backoff/_sync.py\", line 105, in retry\n    ret = target(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py\", line 497, in _send\n    raise UserDefinedBackoffException(backoff=custom_backoff_time, request=request, response=response)\nairbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {\"errors\":[{\"code\":\"INTERNAL_SERVER_ERROR\",\"detail\":\"Sorry, something has gone wrong at our end. If this persists please contact support.\"}]}\n",
  "timestamp" : 1703235986966
}, {
  "failureOrigin" : "source",
  "internalMessage" : "Source process exited with non-zero exit code 1",
  "externalMessage" : "Something went wrong within the source connector",
  "metadata" : {
    "attemptNumber" : 1,
    "jobId" : 292,
    "connector_command" : "read"
  },
  "stacktrace" : "io.airbyte.workers.internal.exception.SourceException: Source process exited with non-zero exit code 1\n\tat io.airbyte.workers.general.BufferedReplicationWorker.readFromSource(BufferedReplicationWorker.java:365)\n\tat io.airbyte.workers.general.BufferedReplicationWorker.lambda$runAsyncWithHeartbeatCheck$3(BufferedReplicationWorker.java:235)\n\tat java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)\n\tat java.base/java.lang.Thread.run(Thread.java:1589)\n",
  "timestamp" : 1703235987170
} ]
2023-12-22 09:16:54 [46mplatform[0m > 
2023-12-22 09:16:54 [46mplatform[0m > ----- END REPLICATION -----
2023-12-22 09:16:54 [46mplatform[0m > 
2023-12-22 09:16:54 [46mplatform[0m > Retry State: RetryManager(completeFailureBackoffPolicy=BackoffPolicy(minInterval=PT10S, maxInterval=PT30M, base=3), partialFailureBackoffPolicy=null, successiveCompleteFailureLimit=5, totalCompleteFailureLimit=10, successivePartialFailureLimit=1000, totalPartialFailureLimit=10, successiveCompleteFailures=2, totalCompleteFailures=2, successivePartialFailures=0, totalPartialFailures=0)
 Backoff before next attempt: 30 seconds
2023-12-22 09:16:55 [46mplatform[0m > Retry State: RetryManager(completeFailureBackoffPolicy=BackoffPolicy(minInterval=PT10S, maxInterval=PT30M, base=3), partialFailureBackoffPolicy=null, successiveCompleteFailureLimit=5, totalCompleteFailureLimit=10, successivePartialFailureLimit=1000, totalPartialFailureLimit=10, successiveCompleteFailures=2, totalCompleteFailures=2, successivePartialFailures=0, totalPartialFailures=0)
2023-12-22 09:16:55 [46mplatform[0m > Backing off for: 30 seconds.
2023-12-22 09:17:25 [46mplatform[0m > Docker volume job log path: /tmp/workspace/292/2/logs.log
2023-12-22 09:17:25 [46mplatform[0m > Executing worker wrapper. Airbyte version: 0.50.35
2023-12-22 09:17:25 [46mplatform[0m > Attempt 0 to save workflow id for cancellation
2023-12-22 09:17:25 [46mplatform[0m > 
2023-12-22 09:17:25 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:17:25 [46mplatform[0m > ----- START CHECK -----
2023-12-22 09:17:25 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:17:25 [46mplatform[0m > 
2023-12-22 09:17:25 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:17:25 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:17:25 [46mplatform[0m > Using default value for environment variable LAUNCHDARKLY_KEY: ''
2023-12-22 09:17:25 [46mplatform[0m > Checking if airbyte/source-declarative-manifest:0.55.2 exists...
2023-12-22 09:17:25 [46mplatform[0m > airbyte/source-declarative-manifest:0.55.2 was found locally.
2023-12-22 09:17:25 [46mplatform[0m > Creating docker container = source-declarative-manifest-check-292-2-nrczr with resources io.airbyte.config.ResourceRequirements@28f893d8[cpuRequest=,cpuLimit=,memoryRequest=,memoryLimit=,additionalProperties={}] and allowedHosts null
2023-12-22 09:17:25 [46mplatform[0m > Preparing command: docker run --rm --init -i -w /data/292/2 --log-driver none --name source-declarative-manifest-check-292-2-nrczr --network host -v airbyte_workspace:/data -v /tmp/airbyte_local:/local -e DEPLOYMENT_MODE=OSS -e WORKER_CONNECTOR_IMAGE=airbyte/source-declarative-manifest:0.55.2 -e AUTO_DETECT_SCHEMA=true -e LAUNCHDARKLY_KEY= -e SOCAT_KUBE_CPU_REQUEST=0.1 -e SOCAT_KUBE_CPU_LIMIT=2.0 -e FIELD_SELECTION_WORKSPACES= -e USE_STREAM_CAPABLE_STATE=true -e WORKER_ENVIRONMENT=DOCKER -e AIRBYTE_ROLE= -e APPLY_FIELD_SELECTION=false -e WORKER_JOB_ATTEMPT=2 -e OTEL_COLLECTOR_ENDPOINT=http://host.docker.internal:4317 -e FEATURE_FLAG_CLIENT=config -e AIRBYTE_VERSION=0.50.35 -e WORKER_JOB_ID=292 airbyte/source-declarative-manifest:0.55.2 check --config source_config.json
2023-12-22 09:17:25 [46mplatform[0m > Reading messages from protocol version 0.2.0
2023-12-22 09:17:28 [46mplatform[0m > Check succeeded
2023-12-22 09:17:28 [46mplatform[0m > Check connection job received output: io.airbyte.config.StandardCheckConnectionOutput@7c92f1d2[status=succeeded,message=<null>,additionalProperties={}]
2023-12-22 09:17:28 [46mplatform[0m > 
2023-12-22 09:17:28 [46mplatform[0m > ----- END CHECK -----
2023-12-22 09:17:28 [46mplatform[0m > 
2023-12-22 09:17:28 [46mplatform[0m > Docker volume job log path: /tmp/workspace/292/2/logs.log
2023-12-22 09:17:28 [46mplatform[0m > Executing worker wrapper. Airbyte version: 0.50.35
2023-12-22 09:17:28 [46mplatform[0m > Attempt 0 to save workflow id for cancellation
2023-12-22 09:17:28 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:17:28 [46mplatform[0m > 
2023-12-22 09:17:28 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:17:28 [46mplatform[0m > ----- START CHECK -----
2023-12-22 09:17:28 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:17:28 [46mplatform[0m > 
2023-12-22 09:17:28 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:17:28 [46mplatform[0m > Using default value for environment variable LAUNCHDARKLY_KEY: ''
2023-12-22 09:17:28 [46mplatform[0m > Checking if airbyte/destination-bigquery:2.3.16 exists...
2023-12-22 09:17:28 [46mplatform[0m > airbyte/destination-bigquery:2.3.16 was found locally.
2023-12-22 09:17:28 [46mplatform[0m > Creating docker container = destination-bigquery-check-292-2-qyyxr with resources io.airbyte.config.ResourceRequirements@422ce524[cpuRequest=,cpuLimit=,memoryRequest=,memoryLimit=,additionalProperties={}] and allowedHosts null
2023-12-22 09:17:28 [46mplatform[0m > Preparing command: docker run --rm --init -i -w /data/292/2 --log-driver none --name destination-bigquery-check-292-2-qyyxr --network host -v airbyte_workspace:/data -v /tmp/airbyte_local:/local -e DEPLOYMENT_MODE=OSS -e WORKER_CONNECTOR_IMAGE=airbyte/destination-bigquery:2.3.16 -e AUTO_DETECT_SCHEMA=true -e LAUNCHDARKLY_KEY= -e SOCAT_KUBE_CPU_REQUEST=0.1 -e SOCAT_KUBE_CPU_LIMIT=2.0 -e FIELD_SELECTION_WORKSPACES= -e USE_STREAM_CAPABLE_STATE=true -e WORKER_ENVIRONMENT=DOCKER -e AIRBYTE_ROLE= -e APPLY_FIELD_SELECTION=false -e WORKER_JOB_ATTEMPT=2 -e OTEL_COLLECTOR_ENDPOINT=http://host.docker.internal:4317 -e FEATURE_FLAG_CLIENT=config -e AIRBYTE_VERSION=0.50.35 -e WORKER_JOB_ID=292 airbyte/destination-bigquery:2.3.16 check --config source_config.json
2023-12-22 09:17:28 [46mplatform[0m > Reading messages from protocol version 0.2.0
2023-12-22 09:17:30 [46mplatform[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:17:30 [46mplatform[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:17:30 [46mplatform[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:17:30 [46mplatform[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:17:30 [46mplatform[0m > 2023-12-22 09:17:30 [32mINFO[m i.a.c.i.b.IntegrationCliParser(parseOptions):126 - integration args: {check=null, config=source_config.json}
2023-12-22 09:17:30 [46mplatform[0m > 2023-12-22 09:17:30 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):132 - Running integration: io.airbyte.integrations.destination.bigquery.BigQueryDestination
2023-12-22 09:17:30 [46mplatform[0m > 2023-12-22 09:17:30 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):133 - Command: CHECK
2023-12-22 09:17:30 [46mplatform[0m > 2023-12-22 09:17:30 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):134 - Integration config: IntegrationConfig{command=CHECK, configPath='source_config.json', catalogPath='null', statePath='null'}
2023-12-22 09:17:31 [46mplatform[0m > 2023-12-22 09:17:31 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword groups - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:17:31 [46mplatform[0m > 2023-12-22 09:17:31 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword group - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:17:31 [46mplatform[0m > 2023-12-22 09:17:31 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword order - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:17:31 [46mplatform[0m > 2023-12-22 09:17:31 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword display_type - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:17:31 [46mplatform[0m > 2023-12-22 09:17:31 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword airbyte_secret - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:17:31 [46mplatform[0m > 2023-12-22 09:17:31 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword always_show - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:17:31 [46mplatform[0m > 2023-12-22 09:17:31 [32mINFO[m i.a.i.d.b.BigQueryUtils(getLoadingMethod):426 - Selected loading method is set to: GCS
2023-12-22 09:17:36 [46mplatform[0m > 2023-12-22 09:17:36 [32mINFO[m i.a.c.i.d.s.S3FormatConfigs(getS3FormatConfig):22 - S3 format config: {"format_type":"CSV","flattening":"No flattening"}
2023-12-22 09:17:36 [46mplatform[0m > 2023-12-22 09:17:36 [32mINFO[m i.a.c.i.d.s.S3BaseChecks(testSingleUpload):40 - Started testing if all required credentials assigned to user for single file uploading
2023-12-22 09:17:37 [46mplatform[0m > 2023-12-22 09:17:37 [32mINFO[m i.a.c.i.d.s.S3BaseChecks(testSingleUpload):48 - Finished checking for normal upload mode
2023-12-22 09:17:37 [46mplatform[0m > 2023-12-22 09:17:37 [32mINFO[m i.a.c.i.d.s.S3BaseChecks(testMultipartUpload):52 - Started testing if all required credentials assigned to user for multipart upload
2023-12-22 09:17:37 [46mplatform[0m > 2023-12-22 09:17:37 [32mINFO[m a.m.s.StreamTransferManager(getMultiPartOutputStreams):329 - Initiated multipart upload to ucm-analytics-bucket/ucm-analytics-bucket/sources/test_1703236657127 with full ID ABPnzm6AtyoLcv8K9cAkDsWA-hFsEz-1fMx3JGPMY9Lxpj5vRP80INiBPKcL_U7F4N3UqWE9
2023-12-22 09:17:37 [46mplatform[0m > 2023-12-22 09:17:37 [32mINFO[m a.m.s.MultiPartOutputStream(close):158 - Called close() on [MultipartOutputStream for parts 1 - 10000]
2023-12-22 09:17:37 [46mplatform[0m > 2023-12-22 09:17:37 [32mINFO[m a.m.s.MultiPartOutputStream(close):158 - Called close() on [MultipartOutputStream for parts 1 - 10000]
2023-12-22 09:17:37 [46mplatform[0m > 2023-12-22 09:17:37 [33mWARN[m a.m.s.MultiPartOutputStream(close):160 - [MultipartOutputStream for parts 1 - 10000] is already closed
2023-12-22 09:17:37 [46mplatform[0m > 2023-12-22 09:17:37 [32mINFO[m a.m.s.StreamTransferManager(complete):367 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/test_1703236657127 with id ABPnzm6At...F4N3UqWE9]: Uploading leftover stream [Part number 1 containing 3.34 MB]
2023-12-22 09:17:38 [46mplatform[0m > 2023-12-22 09:17:38 [32mINFO[m a.m.s.StreamTransferManager(uploadStreamPart):558 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/test_1703236657127 with id ABPnzm6At...F4N3UqWE9]: Finished uploading [Part number 1 containing 3.34 MB]
2023-12-22 09:17:38 [46mplatform[0m > 2023-12-22 09:17:38 [32mINFO[m a.m.s.StreamTransferManager(complete):395 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/test_1703236657127 with id ABPnzm6At...F4N3UqWE9]: Completed
2023-12-22 09:17:38 [46mplatform[0m > 2023-12-22 09:17:38 [32mINFO[m i.a.c.i.d.s.S3BaseChecks(testMultipartUpload):74 - Finished verification for multipart upload mode
2023-12-22 09:17:39 [46mplatform[0m > 2023-12-22 09:17:39 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):228 - Completed integration: io.airbyte.integrations.destination.bigquery.BigQueryDestination
2023-12-22 09:17:39 [46mplatform[0m > Check connection job received output: io.airbyte.config.StandardCheckConnectionOutput@260d4590[status=succeeded,message=<null>,additionalProperties={}]
2023-12-22 09:17:39 [46mplatform[0m > 
2023-12-22 09:17:39 [46mplatform[0m > ----- END CHECK -----
2023-12-22 09:17:39 [46mplatform[0m > 
2023-12-22 09:17:39 [46mplatform[0m > Docker volume job log path: /tmp/workspace/292/2/logs.log
2023-12-22 09:17:39 [46mplatform[0m > Executing worker wrapper. Airbyte version: 0.50.35
2023-12-22 09:17:39 [46mplatform[0m > Attempt 0 to save workflow id for cancellation
2023-12-22 09:17:39 [46mplatform[0m > start sync worker. job id: 292 attempt id: 2
2023-12-22 09:17:39 [46mplatform[0m > 
2023-12-22 09:17:39 [46mplatform[0m > ----- START REPLICATION -----
2023-12-22 09:17:39 [46mplatform[0m > 
2023-12-22 09:17:39 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:17:39 [46mplatform[0m > Running destination...
2023-12-22 09:17:39 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:17:39 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:17:39 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:17:39 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:17:39 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:17:39 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:17:39 [46mplatform[0m > Using default value for environment variable LAUNCHDARKLY_KEY: ''
2023-12-22 09:17:39 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:17:39 [46mplatform[0m > Using default value for environment variable LAUNCHDARKLY_KEY: ''
2023-12-22 09:17:39 [46mplatform[0m > Checking if airbyte/destination-bigquery:2.3.16 exists...
2023-12-22 09:17:39 [46mplatform[0m > Checking if airbyte/source-declarative-manifest:0.55.2 exists...
2023-12-22 09:17:39 [46mplatform[0m > airbyte/destination-bigquery:2.3.16 was found locally.
2023-12-22 09:17:39 [46mplatform[0m > Creating docker container = destination-bigquery-write-292-2-hlmmn with resources io.airbyte.config.ResourceRequirements@8967872[cpuRequest=,cpuLimit=,memoryRequest=,memoryLimit=,additionalProperties={}] and allowedHosts null
2023-12-22 09:17:39 [46mplatform[0m > Preparing command: docker run --rm --init -i -w /data/292/2 --log-driver none --name destination-bigquery-write-292-2-hlmmn --network host -v airbyte_workspace:/data -v /tmp/airbyte_local:/local -e DEPLOYMENT_MODE=OSS -e WORKER_CONNECTOR_IMAGE=airbyte/destination-bigquery:2.3.16 -e AUTO_DETECT_SCHEMA=true -e LAUNCHDARKLY_KEY= -e SOCAT_KUBE_CPU_REQUEST=0.1 -e SOCAT_KUBE_CPU_LIMIT=2.0 -e FIELD_SELECTION_WORKSPACES= -e USE_STREAM_CAPABLE_STATE=true -e WORKER_ENVIRONMENT=DOCKER -e AIRBYTE_ROLE= -e APPLY_FIELD_SELECTION=false -e WORKER_JOB_ATTEMPT=2 -e OTEL_COLLECTOR_ENDPOINT=http://host.docker.internal:4317 -e FEATURE_FLAG_CLIENT=config -e AIRBYTE_VERSION=0.50.35 -e WORKER_JOB_ID=292 airbyte/destination-bigquery:2.3.16 write --config destination_config.json --catalog destination_catalog.json
2023-12-22 09:17:39 [46mplatform[0m > airbyte/source-declarative-manifest:0.55.2 was found locally.
2023-12-22 09:17:39 [46mplatform[0m > Creating docker container = source-declarative-manifest-read-292-2-ygokd with resources io.airbyte.config.ResourceRequirements@6323f496[cpuRequest=,cpuLimit=,memoryRequest=,memoryLimit=,additionalProperties={}] and allowedHosts null
2023-12-22 09:17:39 [46mplatform[0m > Writing messages to protocol version 0.2.0
2023-12-22 09:17:39 [46mplatform[0m > Preparing command: docker run --rm --init -i -w /data/292/2 --log-driver none --name source-declarative-manifest-read-292-2-ygokd -e CONCURRENT_SOURCE_STREAM_READ=false --network host -v airbyte_workspace:/data -v /tmp/airbyte_local:/local -e DEPLOYMENT_MODE=OSS -e WORKER_CONNECTOR_IMAGE=airbyte/source-declarative-manifest:0.55.2 -e AUTO_DETECT_SCHEMA=true -e LAUNCHDARKLY_KEY= -e SOCAT_KUBE_CPU_REQUEST=0.1 -e SOCAT_KUBE_CPU_LIMIT=2.0 -e FIELD_SELECTION_WORKSPACES= -e USE_STREAM_CAPABLE_STATE=true -e WORKER_ENVIRONMENT=DOCKER -e AIRBYTE_ROLE= -e APPLY_FIELD_SELECTION=false -e WORKER_JOB_ATTEMPT=2 -e OTEL_COLLECTOR_ENDPOINT=http://host.docker.internal:4317 -e FEATURE_FLAG_CLIENT=config -e AIRBYTE_VERSION=0.50.35 -e WORKER_JOB_ID=292 airbyte/source-declarative-manifest:0.55.2 read --config source_config.json --catalog source_catalog.json
2023-12-22 09:17:39 [46mplatform[0m > Reading messages from protocol version 0.2.0
2023-12-22 09:17:39 [46mplatform[0m > Reading messages from protocol version 0.2.0
2023-12-22 09:17:39 [46mplatform[0m > readFromSource: start
2023-12-22 09:17:39 [46mplatform[0m > Starting source heartbeat check. Will check every 1 minutes.
2023-12-22 09:17:39 [46mplatform[0m > processMessage: start
2023-12-22 09:17:39 [46mplatform[0m > writeToDestination: start
2023-12-22 09:17:39 [46mplatform[0m > readFromDestination: start
2023-12-22 09:17:42 [43mdestination[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:17:42 [43mdestination[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:17:42 [43mdestination[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:17:42 [43mdestination[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:17:43 [44msource[0m > Starting syncing ManifestDeclarativeSource
2023-12-22 09:17:43 [44msource[0m > Marking stream payables as STARTED
2023-12-22 09:17:43 [44msource[0m > Syncing stream: payables 
2023-12-22 09:17:44 [44msource[0m > Marking stream payables as RUNNING
2023-12-22 09:17:44 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:17:44 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 09:17:44 [43mdestination[0m > 2023-12-22 09:17:44 [32mINFO[m i.a.c.i.b.IntegrationCliParser(parseOptions):126 - integration args: {catalog=destination_catalog.json, write=null, config=destination_config.json}
2023-12-22 09:17:44 [43mdestination[0m > 2023-12-22 09:17:44 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):132 - Running integration: io.airbyte.integrations.destination.bigquery.BigQueryDestination
2023-12-22 09:17:44 [43mdestination[0m > 2023-12-22 09:17:44 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):133 - Command: WRITE
2023-12-22 09:17:44 [43mdestination[0m > 2023-12-22 09:17:44 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):134 - Integration config: IntegrationConfig{command=WRITE, configPath='destination_config.json', catalogPath='destination_catalog.json', statePath='null'}
2023-12-22 09:17:44 [43mdestination[0m > 2023-12-22 09:17:44 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword groups - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:17:44 [43mdestination[0m > 2023-12-22 09:17:44 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword group - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:17:44 [43mdestination[0m > 2023-12-22 09:17:44 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword order - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:17:44 [43mdestination[0m > 2023-12-22 09:17:44 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword display_type - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:17:44 [43mdestination[0m > 2023-12-22 09:17:44 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword airbyte_secret - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:17:44 [43mdestination[0m > 2023-12-22 09:17:44 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword always_show - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:17:44 [43mdestination[0m > 2023-12-22 09:17:44 [32mINFO[m i.a.i.d.b.BigQueryUtils(getLoadingMethod):426 - Selected loading method is set to: GCS
2023-12-22 09:17:44 [43mdestination[0m > 2023-12-22 09:17:44 [32mINFO[m i.a.c.i.d.s.S3FormatConfigs(getS3FormatConfig):22 - S3 format config: {"format_type":"CSV","flattening":"No flattening"}
2023-12-22 09:17:44 [43mdestination[0m > 2023-12-22 09:17:44 [32mINFO[m i.a.i.d.b.BigQueryUtils(isKeepFilesInGcs):442 - All tmp files will be removed from GCS when replication is finished
2023-12-22 09:17:46 [43mdestination[0m > 2023-12-22 09:17:46 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$createWriteConfigs$1):114 - BigQuery write config: BigQueryWriteConfig[streamName=spendesk_payables, namespace=sources, datasetId=airbyte_internal, datasetLocation=europe-west3, tmpTableId=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=_airbyte_tmp_yiv_spendesk_payables}}, targetTableId=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}, tableSchema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, syncMode=overwrite]
2023-12-22 09:17:46 [43mdestination[0m > 2023-12-22 09:17:46 [32mINFO[m i.a.c.i.d.b.BufferManager(<init>):53 - Max 'memory' available for buffer allocation 2 GB
2023-12-22 09:17:46 [43mdestination[0m > 2023-12-22 09:17:46 [32mINFO[m i.a.c.i.d.FlushWorkers(start):98 - Start async buffer supervisor
2023-12-22 09:17:46 [43mdestination[0m > 2023-12-22 09:17:46 [32mINFO[m i.a.c.i.d.AsyncStreamConsumer(start):137 - class io.airbyte.cdk.integrations.destination_async.AsyncStreamConsumer started.
2023-12-22 09:17:46 [43mdestination[0m > 2023-12-22 09:17:46 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:17:46 [43mdestination[0m > 2023-12-22 09:17:46 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onStartFunction$3):137 - Preparing airbyte_raw tables in destination started for 1 streams
2023-12-22 09:17:46 [43mdestination[0m > 2023-12-22 09:17:46 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(prepareTables):108 - Preparing final tables
2023-12-22 09:17:46 [43mdestination[0m > 2023-12-22 09:17:46 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:17:46 [43mdestination[0m > 2023-12-22 09:17:46 [32mINFO[m i.a.i.b.d.t.BaseDestinationV1V2Migrator(migrateIfNecessary):26 - Assessing whether migration is necessary for stream spendesk_payables
2023-12-22 09:17:46 [43mdestination[0m > 2023-12-22 09:17:46 [32mINFO[m i.a.i.b.d.t.BaseDestinationV1V2Migrator(shouldMigrate):45 - Checking whether v1 raw table _airbyte_raw_spendesk_payables in dataset sources exists
2023-12-22 09:17:47 [43mdestination[0m > 2023-12-22 09:17:47 [32mINFO[m i.a.i.b.d.t.BaseDestinationV1V2Migrator(shouldMigrate):49 - Migration Info: Required for Sync mode: false, No existing v2 raw tables: false, A v1 raw table exists: false
2023-12-22 09:17:47 [43mdestination[0m > 2023-12-22 09:17:47 [32mINFO[m i.a.i.b.d.t.BaseDestinationV1V2Migrator(migrateIfNecessary):32 - No Migration Required for stream: spendesk_payables
2023-12-22 09:17:48 [43mdestination[0m > 2023-12-22 09:17:48 [32mINFO[m i.a.i.d.b.t.BigQueryV2TableMigrator(migrateIfNecessary):76 - No Data column Migration Required for stream sources_raw__stream_spendesk_payables
2023-12-22 09:17:48 [43mdestination[0m > 2023-12-22 09:17:48 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$prepareTablesFuture$1):129 - Final Table exists for stream spendesk_payables
2023-12-22 09:17:48 [43mdestination[0m > 2023-12-22 09:17:48 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):99 - Executing sql a4cdc316-8af0-484d-a61b-d05fc2fca7b4: CREATE SCHEMA IF NOT EXISTS `reporting-340722`.`sources`
2023-12-22 09:17:48 [43mdestination[0m > OPTIONS(location="europe-west3");
2023-12-22 09:17:48 [43mdestination[0m > 
2023-12-22 09:17:48 [43mdestination[0m > CREATE OR REPLACE TABLE `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` (
2023-12-22 09:17:48 [43mdestination[0m >   _airbyte_raw_id STRING NOT NULL,
2023-12-22 09:17:48 [43mdestination[0m >   _airbyte_extracted_at TIMESTAMP NOT NULL,
2023-12-22 09:17:48 [43mdestination[0m >   _airbyte_meta JSON NOT NULL,
2023-12-22 09:17:48 [43mdestination[0m > `id` STRING,
2023-12-22 09:17:48 [43mdestination[0m > `type` STRING,
2023-12-22 09:17:48 [43mdestination[0m > `amount` NUMERIC,
2023-12-22 09:17:48 [43mdestination[0m > `teamId` STRING,
2023-12-22 09:17:48 [43mdestination[0m > `userId` STRING,
2023-12-22 09:17:48 [43mdestination[0m > `currency` STRING,
2023-12-22 09:17:48 [43mdestination[0m > `teamName` STRING,
2023-12-22 09:17:48 [43mdestination[0m > `companyId` STRING,
2023-12-22 09:17:48 [43mdestination[0m > `lineItems` JSON,
2023-12-22 09:17:48 [43mdestination[0m > `exportedAt` STRING,
2023-12-22 09:17:48 [43mdestination[0m > `allocations` JSON,
2023-12-22 09:17:48 [43mdestination[0m > `description` STRING,
2023-12-22 09:17:48 [43mdestination[0m > `payableDate` STRING,
2023-12-22 09:17:48 [43mdestination[0m > `costCenterId` STRING,
2023-12-22 09:17:48 [43mdestination[0m > `counterparty` JSON,
2023-12-22 09:17:48 [43mdestination[0m > `invoiceNumber` STRING,
2023-12-22 09:17:48 [43mdestination[0m > `costCenterName` STRING,
2023-12-22 09:17:48 [43mdestination[0m > `invoiceDueDate` STRING,
2023-12-22 09:17:48 [43mdestination[0m > `functionalAmount` NUMERIC,
2023-12-22 09:17:48 [43mdestination[0m > `bookkeepingStatus` STRING,
2023-12-22 09:17:48 [43mdestination[0m > `functionalCurrency` STRING,
2023-12-22 09:17:48 [43mdestination[0m > `documentaryEvidence` JSON,
2023-12-22 09:17:48 [43mdestination[0m > `analyticalProperties` JSON,
2023-12-22 09:17:48 [43mdestination[0m > `functionalExchangeRate` NUMERIC
2023-12-22 09:17:48 [43mdestination[0m > )
2023-12-22 09:17:48 [43mdestination[0m > PARTITION BY (DATE_TRUNC(_airbyte_extracted_at, DAY))
2023-12-22 09:17:48 [43mdestination[0m > CLUSTER BY `_airbyte_extracted_at`;
2023-12-22 09:17:48 [43mdestination[0m > 
2023-12-22 09:17:49 [43mdestination[0m > 2023-12-22 09:17:49 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):119 - Root-level job a4cdc316-8af0-484d-a61b-d05fc2fca7b4 completed in 859 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:17:49 [43mdestination[0m > 2023-12-22 09:17:49 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql CREATE SCHEMA IF NOT EXISTS `reporting-340722`.`sources` OPTIONS(location="europe-west3")... completed in 75 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:17:50 [43mdestination[0m > 2023-12-22 09:17:50 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql CREATE OR REPLACE TABLE `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` ( _airbyte_raw_... completed in 107 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:17:50 [43mdestination[0m > 2023-12-22 09:17:50 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$prepareTablesFuture$1):138 - Using temp final table for stream spendesk_payables, will overwrite existing table at end of sync
2023-12-22 09:17:50 [43mdestination[0m > 2023-12-22 09:17:50 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onStartFunction$3):140 - Preparing staging are in destination for schema: Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, stream: spendesk_payables, target table: GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}, stage: spendesk_payables
2023-12-22 09:17:50 [43mdestination[0m > 2023-12-22 09:17:50 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(createSchemaIfNotExists):86 - Creating dataset airbyte_internal
2023-12-22 09:17:50 [43mdestination[0m > 2023-12-22 09:17:50 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(createTableIfNotExists):102 - Creating target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}
2023-12-22 09:17:51 [43mdestination[0m > 2023-12-22 09:17:51 [32mINFO[m i.a.i.d.b.BigQueryUtils(createPartitionedTableIfNotExists):228 - Partitioned table ALREADY EXISTS: GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}
2023-12-22 09:17:51 [43mdestination[0m > 2023-12-22 09:17:51 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(createStageIfNotExists):109 - Creating staging path for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/
2023-12-22 09:17:51 [43mdestination[0m > 2023-12-22 09:17:51 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(truncateTableIfExists):207 - Truncating target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal)
2023-12-22 09:17:51 [43mdestination[0m > 2023-12-22 09:17:51 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(dropTableIfExists):175 - Deleting target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal)
2023-12-22 09:17:51 [43mdestination[0m > 2023-12-22 09:17:51 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(createTableIfNotExists):102 - Creating target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}
2023-12-22 09:17:51 [43mdestination[0m > 2023-12-22 09:17:51 [32mINFO[m i.a.i.d.b.BigQueryUtils(createPartitionedTableIfNotExists):231 - Partitioned table created successfully: GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}
2023-12-22 09:17:51 [43mdestination[0m > 2023-12-22 09:17:51 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onStartFunction$3):159 - Preparing tables in destination completed.
2023-12-22 09:17:55 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:17:55 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 09:18:06 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:18:06 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 09:18:17 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:18:17 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 09:18:28 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:18:28 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 09:18:39 [44msource[0m > Giving up _send(...) after 6 tries (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:18:39 [44msource[0m > Max retry limit reached. Request: <PreparedRequest [GET]>, Response: <Response [500]>
2023-12-22 09:18:39 [44msource[0m > Encountered an exception while reading stream payables
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 121, in read
    yield from self._read_stream(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 193, in _read_stream
    for record in record_iterator:
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 253, in _read_full_refresh
    for record_data_or_message in stream_instance.read_full_refresh(configured_stream.cursor_field, logger, self._slice_logger):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/streams/core.py", line 121, in read_full_refresh
    yield from self.read_records(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/declarative_stream.py", line 104, in read_records
    yield from self.retriever.read_records(stream_slice)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 304, in read_records
    for stream_data in self._read_pages(self._parse_records, self.state, stream_slice):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 282, in _read_pages
    response = self._fetch_next_page(stream_state, stream_slice, next_page_token)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 256, in _fetch_next_page
    return self.requester.send_request(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 412, in send_request
    response = self._send_with_retry(request, log_formatter=log_formatter)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 458, in _send_with_retry
    return backoff_handler(user_backoff_handler)(request, log_formatter=log_formatter)  # type: ignore
  File "/usr/local/lib/python3.9/site-packages/backoff/_sync.py", line 105, in retry
    ret = target(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/backoff/_sync.py", line 105, in retry
    ret = target(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 497, in _send
    raise UserDefinedBackoffException(backoff=custom_backoff_time, request=request, response=response)
airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]}
2023-12-22 09:18:39 [44msource[0m > Marking stream payables as STOPPED
2023-12-22 09:18:39 [44msource[0m > Finished syncing payables
2023-12-22 09:18:39 [44msource[0m > ManifestDeclarativeSource runtimes:
Syncing stream payables 0:00:56.182000
2023-12-22 09:18:39 [44msource[0m > Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]}
Traceback (most recent call last):
  File "/airbyte/integration_code/main.py", line 29, in <module>
    launch(source, sys.argv[1:])
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py", line 210, in launch
    for message in source_entrypoint.run(parsed_args):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py", line 117, in run
    yield from map(AirbyteEntrypoint.airbyte_message_to_string, self.read(source_spec, config, config_catalog, state))
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py", line 159, in read
    yield from self.source.read(self.logger, config, catalog, state)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/manifest_declarative_source.py", line 134, in read
    yield from super().read(logger, config, catalog, state)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 141, in read
    raise e
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 121, in read
    yield from self._read_stream(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 193, in _read_stream
    for record in record_iterator:
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 253, in _read_full_refresh
    for record_data_or_message in stream_instance.read_full_refresh(configured_stream.cursor_field, logger, self._slice_logger):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/streams/core.py", line 121, in read_full_refresh
    yield from self.read_records(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/declarative_stream.py", line 104, in read_records
    yield from self.retriever.read_records(stream_slice)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 304, in read_records
    for stream_data in self._read_pages(self._parse_records, self.state, stream_slice):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 282, in _read_pages
    response = self._fetch_next_page(stream_state, stream_slice, next_page_token)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 256, in _fetch_next_page
    return self.requester.send_request(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 412, in send_request
    response = self._send_with_retry(request, log_formatter=log_formatter)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 458, in _send_with_retry
    return backoff_handler(user_backoff_handler)(request, log_formatter=log_formatter)  # type: ignore
  File "/usr/local/lib/python3.9/site-packages/backoff/_sync.py", line 105, in retry
    ret = target(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/backoff/_sync.py", line 105, in retry
    ret = target(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 497, in _send
    raise UserDefinedBackoffException(backoff=custom_backoff_time, request=request, response=response)
airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]}
2023-12-22 09:18:40 [46mplatform[0m > readFromSource: source exception
io.airbyte.workers.internal.exception.SourceException: Source process exited with non-zero exit code 1
	at io.airbyte.workers.general.BufferedReplicationWorker.readFromSource(BufferedReplicationWorker.java:365) ~[io.airbyte-airbyte-commons-worker-0.50.35.jar:?]
	at io.airbyte.workers.general.BufferedReplicationWorker.lambda$runAsyncWithHeartbeatCheck$3(BufferedReplicationWorker.java:235) ~[io.airbyte-airbyte-commons-worker-0.50.35.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[?:?]
	at java.lang.Thread.run(Thread.java:1589) ~[?:?]
2023-12-22 09:18:40 [46mplatform[0m > readFromSource: done. (source.isFinished:true, fromSource.isClosed:false)
2023-12-22 09:18:46 [43mdestination[0m > 2023-12-22 09:18:46 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:18:46 [43mdestination[0m > 2023-12-22 09:18:46 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:19:46 [43mdestination[0m > 2023-12-22 09:19:46 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:19:46 [43mdestination[0m > 2023-12-22 09:19:46 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:20:46 [43mdestination[0m > 2023-12-22 09:20:46 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:20:46 [43mdestination[0m > 2023-12-22 09:20:46 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:21:46 [43mdestination[0m > 2023-12-22 09:21:46 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:21:46 [43mdestination[0m > 2023-12-22 09:21:46 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:22:46 [43mdestination[0m > 2023-12-22 09:22:46 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:22:46 [43mdestination[0m > 2023-12-22 09:22:46 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m i.a.c.i.d.DetectStreamToFlush(getNextStreamToFlush):122 - flushing: trigger info: sources - spendesk_payables, time trigger: true , size trigger: false current threshold b: 200 MB, queue size b: 34.09 KB, penalty b: 0 bytes, after penalty b: 34.09 KB
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):152 - Flush Worker (e686c) -- Worker picked up work.
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):154 - Flush Worker (e686c) -- Attempting to read from queue namespace: sources, stream: spendesk_payables.
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 10450847 bytes..
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):167 - Flush Worker (e686c) -- Batch contains: 29 records, 34.09 KB bytes.
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m i.a.c.i.d.r.BaseSerializedBuffer(flush):172 - Finished writing data to 9acaa177-3644-4d65-8e64-676a6482593c16118490105478271836.csv.gz (5 KB)
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m i.a.i.d.b.BigQueryAsyncFlush(flush):61 - Flushing CSV buffer for stream spendesk_payables (5 KB) to staging
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(uploadRecordsToStage):116 - Uploading records to staging for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m a.m.s.StreamTransferManager(getMultiPartOutputStreams):329 - Initiated multipart upload to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/f3c0cce7-1307-4999-8728-4b2237083b20.csv.gz with full ID ABPnzm79jb5oa0KIdMZgHu3CkgDr7k7K9BX55CQ4qwx4CJCh8WHgyUxvSKJSmJ3dsvdlRDDZ
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m a.m.s.MultiPartOutputStream(close):158 - Called close() on [MultipartOutputStream for parts 1 - 10000]
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m a.m.s.StreamTransferManager(complete):367 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/f3c0cce7-1307-4999-8728-4b2237083b20.csv.gz with id ABPnzm79j...dsvdlRDDZ]: Uploading leftover stream [Part number 1 containing 0.01 MB]
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m a.m.s.StreamTransferManager(uploadStreamPart):558 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/f3c0cce7-1307-4999-8728-4b2237083b20.csv.gz with id ABPnzm79j...dsvdlRDDZ]: Finished uploading [Part number 1 containing 0.01 MB]
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m a.m.s.StreamTransferManager(complete):395 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/f3c0cce7-1307-4999-8728-4b2237083b20.csv.gz with id ABPnzm79j...dsvdlRDDZ]: Completed
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(loadDataIntoBucket):214 - Uploaded buffer file to storage: 9acaa177-3644-4d65-8e64-676a6482593c16118490105478271836.csv.gz -> ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/f3c0cce7-1307-4999-8728-4b2237083b20.csv.gz (filename: f3c0cce7-1307-4999-8728-4b2237083b20.csv.gz)
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(uploadRecordsToBucket):131 - Successfully loaded records to stage ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/ with 0 re-attempt(s)
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):134 - Uploading records from staging files to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): f3c0cce7-1307-4999-8728-4b2237083b20.csv.gz
2023-12-22 09:22:53 [43mdestination[0m > 2023-12-22 09:22:53 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):138 - Uploading staged file: gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/f3c0cce7-1307-4999-8728-4b2237083b20.csv.gz
2023-12-22 09:22:54 [43mdestination[0m > 2023-12-22 09:22:54 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):147 - [JobId{project=reporting-340722, job=ac82245d-ecd1-43de-b5f1-882757542af4, location=europe-west3}] Created a new job to upload record(s) to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): Job{job=JobId{project=reporting-340722, job=ac82245d-ecd1-43de-b5f1-882757542af4, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703236974239, endTime=null, startTime=1703236974335, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=KImZK/SLoTKYuazmkWZRLw==, generatedId=reporting-340722:europe-west3.ac82245d-ecd1-43de-b5f1-882757542af4, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/ac82245d-ecd1-43de-b5f1-882757542af4?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/f3c0cce7-1307-4999-8728-4b2237083b20.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}
2023-12-22 09:22:54 [43mdestination[0m > 2023-12-22 09:22:54 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):451 - Waiting for job finish Job{job=JobId{project=reporting-340722, job=ac82245d-ecd1-43de-b5f1-882757542af4, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703236974239, endTime=null, startTime=1703236974335, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=KImZK/SLoTKYuazmkWZRLw==, generatedId=reporting-340722:europe-west3.ac82245d-ecd1-43de-b5f1-882757542af4, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/ac82245d-ecd1-43de-b5f1-882757542af4?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/f3c0cce7-1307-4999-8728-4b2237083b20.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}. Status: JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:22:57 [43mdestination[0m > 2023-12-22 09:22:57 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):453 - Job finish Job{job=JobId{project=reporting-340722, job=ac82245d-ecd1-43de-b5f1-882757542af4, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703236974239, endTime=null, startTime=1703236974335, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=KImZK/SLoTKYuazmkWZRLw==, generatedId=reporting-340722:europe-west3.ac82245d-ecd1-43de-b5f1-882757542af4, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/ac82245d-ecd1-43de-b5f1-882757542af4?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/f3c0cce7-1307-4999-8728-4b2237083b20.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}} with status JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:22:57 [43mdestination[0m > 2023-12-22 09:22:57 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):152 - [JobId{project=reporting-340722, job=ac82245d-ecd1-43de-b5f1-882757542af4, location=europe-west3}] Target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal) is successfully appended with staging files
2023-12-22 09:22:57 [43mdestination[0m > 2023-12-22 09:22:57 [32mINFO[m i.a.c.i.d.r.FileBuffer(deleteFile):109 - Deleting tempFile data 9acaa177-3644-4d65-8e64-676a6482593c16118490105478271836.csv.gz
2023-12-22 09:22:57 [43mdestination[0m > 2023-12-22 09:22:57 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:22:57 [43mdestination[0m > 2023-12-22 09:22:57 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 34913 bytes..
2023-12-22 09:22:57 [43mdestination[0m > 2023-12-22 09:22:57 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):176 - Flush Worker (e686c) -- Worker finished flushing. Current queue size: 0
2023-12-22 09:23:46 [43mdestination[0m > 2023-12-22 09:23:46 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:23:46 [43mdestination[0m > 2023-12-22 09:23:46 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:24:46 [43mdestination[0m > 2023-12-22 09:24:46 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:24:46 [43mdestination[0m > 2023-12-22 09:24:46 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:25:46 [43mdestination[0m > 2023-12-22 09:25:46 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:25:46 [43mdestination[0m > 2023-12-22 09:25:46 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:26:46 [43mdestination[0m > 2023-12-22 09:26:46 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:26:46 [43mdestination[0m > 2023-12-22 09:26:46 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:27:46 [43mdestination[0m > 2023-12-22 09:27:46 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:27:46 [43mdestination[0m > 2023-12-22 09:27:46 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [32mINFO[m i.a.c.i.d.DetectStreamToFlush(getNextStreamToFlush):122 - flushing: trigger info: sources - spendesk_payables, time trigger: true , size trigger: false current threshold b: 200 MB, queue size b: 0 bytes, penalty b: 0 bytes, after penalty b: 0 bytes
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):152 - Flush Worker (08086) -- Worker picked up work.
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):154 - Flush Worker (08086) -- Attempting to read from queue namespace: sources, stream: spendesk_payables.
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):167 - Flush Worker (08086) -- Batch contains: 0 records, 0 bytes bytes.
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [33mWARN[m i.a.c.i.d.s.c.CsvSerializedBuffer(flushWriter):85 - Trying to flush but no printer is initialized.
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [33mWARN[m i.a.c.i.d.s.c.CsvSerializedBuffer(closeWriter):95 - Trying to close but no printer is initialized.
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [32mINFO[m i.a.c.i.d.r.BaseSerializedBuffer(flush):172 - Finished writing data to 57657324-4976-49a8-90ff-983b4bb153b4127736070750620156.csv.gz (0 bytes)
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [32mINFO[m i.a.i.d.b.BigQueryAsyncFlush(flush):61 - Flushing CSV buffer for stream spendesk_payables (0 bytes) to staging
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(uploadRecordsToStage):116 - Uploading records to staging for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [32mINFO[m a.m.s.StreamTransferManager(getMultiPartOutputStreams):329 - Initiated multipart upload to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/c31d5150-45f8-4252-a47f-b23f9f1cf4a6.csv.gz with full ID ABPnzm6Xlj6SpQF2diVEf7DwlsMI3RtJ2LyjhZFPwTdY9TGSFIgQeuBqW5xOTCqDzaK7DaEt
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [32mINFO[m a.m.s.MultiPartOutputStream(close):158 - Called close() on [MultipartOutputStream for parts 1 - 10000]
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [32mINFO[m a.m.s.StreamTransferManager(complete):395 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/c31d5150-45f8-4252-a47f-b23f9f1cf4a6.csv.gz with id ABPnzm6Xl...DzaK7DaEt]: Completed
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(loadDataIntoBucket):214 - Uploaded buffer file to storage: 57657324-4976-49a8-90ff-983b4bb153b4127736070750620156.csv.gz -> ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/c31d5150-45f8-4252-a47f-b23f9f1cf4a6.csv.gz (filename: c31d5150-45f8-4252-a47f-b23f9f1cf4a6.csv.gz)
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(uploadRecordsToBucket):131 - Successfully loaded records to stage ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/ with 0 re-attempt(s)
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):134 - Uploading records from staging files to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): c31d5150-45f8-4252-a47f-b23f9f1cf4a6.csv.gz
2023-12-22 09:27:54 [43mdestination[0m > 2023-12-22 09:27:54 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):138 - Uploading staged file: gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/c31d5150-45f8-4252-a47f-b23f9f1cf4a6.csv.gz
2023-12-22 09:27:55 [43mdestination[0m > 2023-12-22 09:27:55 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):147 - [JobId{project=reporting-340722, job=d2fa01cd-6d15-444b-ba10-23a67185b636, location=europe-west3}] Created a new job to upload record(s) to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): Job{job=JobId{project=reporting-340722, job=d2fa01cd-6d15-444b-ba10-23a67185b636, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703237274927, endTime=null, startTime=1703237275077, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=NR1IQfTNglR9D50bT0PGwQ==, generatedId=reporting-340722:europe-west3.d2fa01cd-6d15-444b-ba10-23a67185b636, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/d2fa01cd-6d15-444b-ba10-23a67185b636?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/c31d5150-45f8-4252-a47f-b23f9f1cf4a6.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}
2023-12-22 09:27:55 [43mdestination[0m > 2023-12-22 09:27:55 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):451 - Waiting for job finish Job{job=JobId{project=reporting-340722, job=d2fa01cd-6d15-444b-ba10-23a67185b636, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703237274927, endTime=null, startTime=1703237275077, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=NR1IQfTNglR9D50bT0PGwQ==, generatedId=reporting-340722:europe-west3.d2fa01cd-6d15-444b-ba10-23a67185b636, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/d2fa01cd-6d15-444b-ba10-23a67185b636?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/c31d5150-45f8-4252-a47f-b23f9f1cf4a6.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}. Status: JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:27:57 [43mdestination[0m > 2023-12-22 09:27:57 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):453 - Job finish Job{job=JobId{project=reporting-340722, job=d2fa01cd-6d15-444b-ba10-23a67185b636, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703237274927, endTime=null, startTime=1703237275077, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=NR1IQfTNglR9D50bT0PGwQ==, generatedId=reporting-340722:europe-west3.d2fa01cd-6d15-444b-ba10-23a67185b636, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/d2fa01cd-6d15-444b-ba10-23a67185b636?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/c31d5150-45f8-4252-a47f-b23f9f1cf4a6.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}} with status JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:27:57 [43mdestination[0m > 2023-12-22 09:27:57 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):152 - [JobId{project=reporting-340722, job=d2fa01cd-6d15-444b-ba10-23a67185b636, location=europe-west3}] Target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal) is successfully appended with staging files
2023-12-22 09:27:57 [43mdestination[0m > 2023-12-22 09:27:57 [32mINFO[m i.a.c.i.d.r.FileBuffer(deleteFile):109 - Deleting tempFile data 57657324-4976-49a8-90ff-983b4bb153b4127736070750620156.csv.gz
2023-12-22 09:27:57 [43mdestination[0m > 2023-12-22 09:27:57 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:27:57 [43mdestination[0m > 2023-12-22 09:27:57 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:27:57 [43mdestination[0m > 2023-12-22 09:27:57 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):176 - Flush Worker (08086) -- Worker finished flushing. Current queue size: 0
2023-12-22 09:28:46 [43mdestination[0m > 2023-12-22 09:28:46 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:28:46 [43mdestination[0m > 2023-12-22 09:28:46 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:28:52 [46mplatform[0m > processMessage: done. (fromSource.isDone:true, forDest.isClosed:false)
2023-12-22 09:28:52 [46mplatform[0m > writeToDestination: done. (forDest.isDone:true, isDestRunning:true)
2023-12-22 09:28:52 [46mplatform[0m > thread status... timeout thread: false , replication thread: true
2023-12-22 09:28:52 [43mdestination[0m > 2023-12-22 09:28:52 [32mINFO[m i.a.c.i.d.FlushWorkers(close):191 - Closing flush workers -- waiting for all buffers to flush
2023-12-22 09:28:52 [43mdestination[0m > 2023-12-22 09:28:52 [32mINFO[m i.a.c.i.d.FlushWorkers(close):216 - REMAINING_BUFFERS_INFO
2023-12-22 09:28:52 [43mdestination[0m >   Namespace: sources Stream: spendesk_payables -- remaining records: 1
2023-12-22 09:28:52 [43mdestination[0m > 2023-12-22 09:28:52 [32mINFO[m i.a.c.i.d.FlushWorkers(close):217 - Waiting for all streams to flush.
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m i.a.c.i.d.DetectStreamToFlush(getNextStreamToFlush):122 - flushing: trigger info: sources - spendesk_payables, time trigger: false , size trigger: true current threshold b: 0 bytes, queue size b: 1.1 KB, penalty b: 0 bytes, after penalty b: 1.1 KB
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):152 - Flush Worker (350f2) -- Worker picked up work.
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):154 - Flush Worker (350f2) -- Attempting to read from queue namespace: sources, stream: spendesk_payables.
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 10484632 bytes..
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):167 - Flush Worker (350f2) -- Batch contains: 1 records, 1.1 KB bytes.
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m i.a.c.i.d.r.BaseSerializedBuffer(flush):172 - Finished writing data to 666b85ad-2ae5-4bcb-8ccd-815b7ef7cced3076691418907267780.csv.gz (605 bytes)
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m i.a.i.d.b.BigQueryAsyncFlush(flush):61 - Flushing CSV buffer for stream spendesk_payables (605 bytes) to staging
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(uploadRecordsToStage):116 - Uploading records to staging for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m a.m.s.StreamTransferManager(getMultiPartOutputStreams):329 - Initiated multipart upload to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/7861255a-6af2-488e-bab5-c93ca069e82b.csv.gz with full ID ABPnzm71iRvpTE0sHjZ03pBVws3pJW_6eJ3ZkDwAHOiv0nhX54f2Xz3CzsvfgLRpfav9F0aI
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m a.m.s.MultiPartOutputStream(close):158 - Called close() on [MultipartOutputStream for parts 1 - 10000]
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m a.m.s.StreamTransferManager(complete):367 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/7861255a-6af2-488e-bab5-c93ca069e82b.csv.gz with id ABPnzm71i...pfav9F0aI]: Uploading leftover stream [Part number 1 containing 0.00 MB]
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m a.m.s.StreamTransferManager(uploadStreamPart):558 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/7861255a-6af2-488e-bab5-c93ca069e82b.csv.gz with id ABPnzm71i...pfav9F0aI]: Finished uploading [Part number 1 containing 0.00 MB]
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m a.m.s.StreamTransferManager(complete):395 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/7861255a-6af2-488e-bab5-c93ca069e82b.csv.gz with id ABPnzm71i...pfav9F0aI]: Completed
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(loadDataIntoBucket):214 - Uploaded buffer file to storage: 666b85ad-2ae5-4bcb-8ccd-815b7ef7cced3076691418907267780.csv.gz -> ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/7861255a-6af2-488e-bab5-c93ca069e82b.csv.gz (filename: 7861255a-6af2-488e-bab5-c93ca069e82b.csv.gz)
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(uploadRecordsToBucket):131 - Successfully loaded records to stage ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/ with 0 re-attempt(s)
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):134 - Uploading records from staging files to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): 7861255a-6af2-488e-bab5-c93ca069e82b.csv.gz
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):138 - Uploading staged file: gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/7861255a-6af2-488e-bab5-c93ca069e82b.csv.gz
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m i.a.c.i.d.FlushWorkers(close):220 - Closing flush workers -- all buffers flushed
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m i.a.c.i.d.FlushWorkers(close):226 - Closing flush workers -- Supervisor shutdown status: true
2023-12-22 09:28:53 [43mdestination[0m > 2023-12-22 09:28:53 [32mINFO[m i.a.c.i.d.FlushWorkers(close):228 - Closing flush workers -- Starting worker pool shutdown..
2023-12-22 09:28:54 [43mdestination[0m > 2023-12-22 09:28:54 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):147 - [JobId{project=reporting-340722, job=5ec75816-880f-4b15-94a8-1cfc4748a96c, location=europe-west3}] Created a new job to upload record(s) to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): Job{job=JobId{project=reporting-340722, job=5ec75816-880f-4b15-94a8-1cfc4748a96c, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703237333976, endTime=null, startTime=1703237334090, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=+sS5a844LaPoOf/lizZTrw==, generatedId=reporting-340722:europe-west3.5ec75816-880f-4b15-94a8-1cfc4748a96c, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/5ec75816-880f-4b15-94a8-1cfc4748a96c?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/7861255a-6af2-488e-bab5-c93ca069e82b.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}
2023-12-22 09:28:54 [43mdestination[0m > 2023-12-22 09:28:54 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):451 - Waiting for job finish Job{job=JobId{project=reporting-340722, job=5ec75816-880f-4b15-94a8-1cfc4748a96c, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703237333976, endTime=null, startTime=1703237334090, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=+sS5a844LaPoOf/lizZTrw==, generatedId=reporting-340722:europe-west3.5ec75816-880f-4b15-94a8-1cfc4748a96c, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/5ec75816-880f-4b15-94a8-1cfc4748a96c?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/7861255a-6af2-488e-bab5-c93ca069e82b.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}. Status: JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:28:56 [43mdestination[0m > 2023-12-22 09:28:56 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):453 - Job finish Job{job=JobId{project=reporting-340722, job=5ec75816-880f-4b15-94a8-1cfc4748a96c, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703237333976, endTime=null, startTime=1703237334090, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=+sS5a844LaPoOf/lizZTrw==, generatedId=reporting-340722:europe-west3.5ec75816-880f-4b15-94a8-1cfc4748a96c, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/5ec75816-880f-4b15-94a8-1cfc4748a96c?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/7861255a-6af2-488e-bab5-c93ca069e82b.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}} with status JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:28:56 [43mdestination[0m > 2023-12-22 09:28:56 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):152 - [JobId{project=reporting-340722, job=5ec75816-880f-4b15-94a8-1cfc4748a96c, location=europe-west3}] Target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal) is successfully appended with staging files
2023-12-22 09:28:56 [43mdestination[0m > 2023-12-22 09:28:56 [32mINFO[m i.a.c.i.d.r.FileBuffer(deleteFile):109 - Deleting tempFile data 666b85ad-2ae5-4bcb-8ccd-815b7ef7cced3076691418907267780.csv.gz
2023-12-22 09:28:56 [43mdestination[0m > 2023-12-22 09:28:56 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:28:56 [43mdestination[0m > 2023-12-22 09:28:56 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 1128 bytes..
2023-12-22 09:28:56 [43mdestination[0m > 2023-12-22 09:28:56 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):176 - Flush Worker (350f2) -- Worker finished flushing. Current queue size: 0
2023-12-22 09:28:56 [43mdestination[0m > 2023-12-22 09:28:56 [32mINFO[m i.a.c.i.d.FlushWorkers(close):231 - Closing flush workers -- Workers shutdown status: true
2023-12-22 09:28:56 [43mdestination[0m > 2023-12-22 09:28:56 [32mINFO[m i.a.c.i.d.b.BufferManager(close):92 - Buffers cleared..
2023-12-22 09:28:56 [43mdestination[0m > 2023-12-22 09:28:56 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(typeAndDedupe):242 - Typing and deduping all tables
2023-12-22 09:28:56 [43mdestination[0m > 2023-12-22 09:28:56 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$typeAndDedupeTask$2):216 - Waiting for raw table writes to pause for sources.spendesk_payables
2023-12-22 09:28:56 [43mdestination[0m > 2023-12-22 09:28:56 [32mINFO[m i.a.i.b.d.t.TypeAndDedupeTransaction(executeTypeAndDedupe):36 - Attempting typing and deduping for sources.spendesk_payables with suffix
2023-12-22 09:28:56 [43mdestination[0m > 2023-12-22 09:28:56 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):99 - Executing sql 16c7aea8-2134-4113-8431-e9871440a5e7: BEGIN TRANSACTION;
2023-12-22 09:28:56 [43mdestination[0m > INSERT INTO `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp`
2023-12-22 09:28:56 [43mdestination[0m > (
2023-12-22 09:28:56 [43mdestination[0m > `id`,
2023-12-22 09:28:56 [43mdestination[0m > `type`,
2023-12-22 09:28:56 [43mdestination[0m > `amount`,
2023-12-22 09:28:56 [43mdestination[0m > `teamId`,
2023-12-22 09:28:56 [43mdestination[0m > `userId`,
2023-12-22 09:28:56 [43mdestination[0m > `currency`,
2023-12-22 09:28:56 [43mdestination[0m > `teamName`,
2023-12-22 09:28:56 [43mdestination[0m > `companyId`,
2023-12-22 09:28:56 [43mdestination[0m > `lineItems`,
2023-12-22 09:28:56 [43mdestination[0m > `exportedAt`,
2023-12-22 09:28:56 [43mdestination[0m > `allocations`,
2023-12-22 09:28:56 [43mdestination[0m > `description`,
2023-12-22 09:28:56 [43mdestination[0m > `payableDate`,
2023-12-22 09:28:56 [43mdestination[0m > `costCenterId`,
2023-12-22 09:28:56 [43mdestination[0m > `counterparty`,
2023-12-22 09:28:56 [43mdestination[0m > `invoiceNumber`,
2023-12-22 09:28:56 [43mdestination[0m > `costCenterName`,
2023-12-22 09:28:56 [43mdestination[0m > `invoiceDueDate`,
2023-12-22 09:28:56 [43mdestination[0m > `functionalAmount`,
2023-12-22 09:28:56 [43mdestination[0m > `bookkeepingStatus`,
2023-12-22 09:28:56 [43mdestination[0m > `functionalCurrency`,
2023-12-22 09:28:56 [43mdestination[0m > `documentaryEvidence`,
2023-12-22 09:28:56 [43mdestination[0m > `analyticalProperties`,
2023-12-22 09:28:56 [43mdestination[0m > `functionalExchangeRate`,
2023-12-22 09:28:56 [43mdestination[0m >   _airbyte_meta,
2023-12-22 09:28:56 [43mdestination[0m >   _airbyte_raw_id,
2023-12-22 09:28:56 [43mdestination[0m >   _airbyte_extracted_at
2023-12-22 09:28:56 [43mdestination[0m > )
2023-12-22 09:28:56 [43mdestination[0m > WITH intermediate_data AS (
2023-12-22 09:28:56 [43mdestination[0m >   SELECT
2023-12-22 09:28:56 [43mdestination[0m > (CASE
2023-12-22 09:28:56 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."id"') IS NULL
2023-12-22 09:28:56 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."id"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:28:56 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."id"')
2023-12-22 09:28:56 [43mdestination[0m >     ELSE
2023-12-22 09:28:56 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."id"')
2023-12-22 09:28:56 [43mdestination[0m >   END)
2023-12-22 09:28:56 [43mdestination[0m >  as `id`,
2023-12-22 09:28:56 [43mdestination[0m > (CASE
2023-12-22 09:28:56 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."type"') IS NULL
2023-12-22 09:28:56 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."type"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:28:56 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."type"')
2023-12-22 09:28:56 [43mdestination[0m >     ELSE
2023-12-22 09:28:56 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."type"')
2023-12-22 09:28:56 [43mdestination[0m >   END)
2023-12-22 09:28:56 [43mdestination[0m >  as `type`,
2023-12-22 09:28:56 [43mdestination[0m > CAST(JSON_VALUE(`_airbyte_data`, '$."amount"') as NUMERIC) as `amount`,
2023-12-22 09:28:56 [43mdestination[0m > (CASE
2023-12-22 09:28:56 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."teamId"') IS NULL
2023-12-22 09:28:56 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."teamId"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:28:56 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."teamId"')
2023-12-22 09:28:56 [43mdestination[0m >     ELSE
2023-12-22 09:28:56 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."teamId"')
2023-12-22 09:28:56 [43mdestination[0m >   END)
2023-12-22 09:28:56 [43mdestination[0m >  as `teamId`,
2023-12-22 09:28:56 [43mdestination[0m > (CASE
2023-12-22 09:28:56 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."userId"') IS NULL
2023-12-22 09:28:56 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."userId"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:28:56 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."userId"')
2023-12-22 09:28:56 [43mdestination[0m >     ELSE
2023-12-22 09:28:56 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."userId"')
2023-12-22 09:28:56 [43mdestination[0m >   END)
2023-12-22 09:28:56 [43mdestination[0m >  as `userId`,
2023-12-22 09:28:56 [43mdestination[0m > (CASE
2023-12-22 09:28:56 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."currency"') IS NULL
2023-12-22 09:28:56 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."currency"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:28:56 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."currency"')
2023-12-22 09:28:56 [43mdestination[0m >     ELSE
2023-12-22 09:28:56 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."currency"')
2023-12-22 09:28:56 [43mdestination[0m >   END)
2023-12-22 09:28:56 [43mdestination[0m >  as `currency`,
2023-12-22 09:28:56 [43mdestination[0m > (CASE
2023-12-22 09:28:56 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."teamName"') IS NULL
2023-12-22 09:28:56 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."teamName"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:28:56 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."teamName"')
2023-12-22 09:28:56 [43mdestination[0m >     ELSE
2023-12-22 09:28:56 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."teamName"')
2023-12-22 09:28:56 [43mdestination[0m >   END)
2023-12-22 09:28:56 [43mdestination[0m >  as `teamName`,
2023-12-22 09:28:56 [43mdestination[0m > (CASE
2023-12-22 09:28:56 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."companyId"') IS NULL
2023-12-22 09:28:56 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."companyId"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:28:56 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."companyId"')
2023-12-22 09:28:56 [43mdestination[0m >     ELSE
2023-12-22 09:28:56 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."companyId"')
2023-12-22 09:28:56 [43mdestination[0m >   END)
2023-12-22 09:28:56 [43mdestination[0m >  as `companyId`,
2023-12-22 09:28:56 [43mdestination[0m > PARSE_JSON(CASE
2023-12-22 09:28:56 [43mdestination[0m >   WHEN JSON_QUERY(`_airbyte_data`, '$."lineItems"') IS NULL
2023-12-22 09:28:56 [43mdestination[0m >     OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."lineItems"'), wide_number_mode=>'round')) != 'array'
2023-12-22 09:28:56 [43mdestination[0m >     THEN NULL
2023-12-22 09:28:56 [43mdestination[0m >   ELSE JSON_QUERY(`_airbyte_data`, '$."lineItems"')
2023-12-22 09:28:56 [43mdestination[0m > END, wide_number_mode=>'round')
2023-12-22 09:28:56 [43mdestination[0m >  as `lineItems`,
2023-12-22 09:28:56 [43mdestination[0m > (CASE
2023-12-22 09:28:56 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."exportedAt"') IS NULL
2023-12-22 09:28:56 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."exportedAt"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:28:56 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."exportedAt"')
2023-12-22 09:28:57 [43mdestination[0m >     ELSE
2023-12-22 09:28:57 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."exportedAt"')
2023-12-22 09:28:57 [43mdestination[0m >   END)
2023-12-22 09:28:57 [43mdestination[0m >  as `exportedAt`,
2023-12-22 09:28:57 [43mdestination[0m > PARSE_JSON(CASE
2023-12-22 09:28:57 [43mdestination[0m >   WHEN JSON_QUERY(`_airbyte_data`, '$."allocations"') IS NULL
2023-12-22 09:28:57 [43mdestination[0m >     OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."allocations"'), wide_number_mode=>'round')) != 'array'
2023-12-22 09:28:57 [43mdestination[0m >     THEN NULL
2023-12-22 09:28:57 [43mdestination[0m >   ELSE JSON_QUERY(`_airbyte_data`, '$."allocations"')
2023-12-22 09:28:57 [43mdestination[0m > END, wide_number_mode=>'round')
2023-12-22 09:28:57 [43mdestination[0m >  as `allocations`,
2023-12-22 09:28:57 [43mdestination[0m > (CASE
2023-12-22 09:28:57 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."description"') IS NULL
2023-12-22 09:28:57 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."description"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:28:57 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."description"')
2023-12-22 09:28:57 [43mdestination[0m >     ELSE
2023-12-22 09:28:57 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."description"')
2023-12-22 09:28:57 [43mdestination[0m >   END)
2023-12-22 09:28:57 [43mdestination[0m >  as `description`,
2023-12-22 09:28:57 [43mdestination[0m > (CASE
2023-12-22 09:28:57 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."payableDate"') IS NULL
2023-12-22 09:28:57 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."payableDate"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:28:57 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."payableDate"')
2023-12-22 09:28:57 [43mdestination[0m >     ELSE
2023-12-22 09:28:57 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."payableDate"')
2023-12-22 09:28:57 [43mdestination[0m >   END)
2023-12-22 09:28:57 [43mdestination[0m >  as `payableDate`,
2023-12-22 09:28:57 [43mdestination[0m > (CASE
2023-12-22 09:28:57 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."costCenterId"') IS NULL
2023-12-22 09:28:57 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."costCenterId"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:28:57 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."costCenterId"')
2023-12-22 09:28:57 [43mdestination[0m >     ELSE
2023-12-22 09:28:57 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."costCenterId"')
2023-12-22 09:28:57 [43mdestination[0m >   END)
2023-12-22 09:28:57 [43mdestination[0m >  as `costCenterId`,
2023-12-22 09:28:57 [43mdestination[0m > PARSE_JSON(CASE
2023-12-22 09:28:57 [43mdestination[0m >   WHEN JSON_QUERY(`_airbyte_data`, '$."counterparty"') IS NULL
2023-12-22 09:28:57 [43mdestination[0m >     OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."counterparty"'), wide_number_mode=>'round')) != 'object'
2023-12-22 09:28:57 [43mdestination[0m >     THEN NULL
2023-12-22 09:28:57 [43mdestination[0m >   ELSE JSON_QUERY(`_airbyte_data`, '$."counterparty"')
2023-12-22 09:28:57 [43mdestination[0m > END, wide_number_mode=>'round')
2023-12-22 09:28:57 [43mdestination[0m >  as `counterparty`,
2023-12-22 09:28:57 [43mdestination[0m > (CASE
2023-12-22 09:28:57 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."invoiceNumber"') IS NULL
2023-12-22 09:28:57 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."invoiceNumber"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:28:57 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."invoiceNumber"')
2023-12-22 09:28:57 [43mdestination[0m >     ELSE
2023-12-22 09:28:57 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."invoiceNumber"')
2023-12-22 09:28:57 [43mdestination[0m >   END)
2023-12-22 09:28:57 [43mdestination[0m >  as `invoiceNumber`,
2023-12-22 09:28:57 [43mdestination[0m > (CASE
2023-12-22 09:28:57 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."costCenterName"') IS NULL
2023-12-22 09:28:57 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."costCenterName"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:28:57 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."costCenterName"')
2023-12-22 09:28:57 [43mdestination[0m >     ELSE
2023-12-22 09:28:57 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."costCenterName"')
2023-12-22 09:28:57 [43mdestination[0m >   END)
2023-12-22 09:28:57 [43mdestination[0m >  as `costCenterName`,
2023-12-22 09:28:57 [43mdestination[0m > (CASE
2023-12-22 09:28:57 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."invoiceDueDate"') IS NULL
2023-12-22 09:28:57 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."invoiceDueDate"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:28:57 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."invoiceDueDate"')
2023-12-22 09:28:57 [43mdestination[0m >     ELSE
2023-12-22 09:28:57 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."invoiceDueDate"')
2023-12-22 09:28:57 [43mdestination[0m >   END)
2023-12-22 09:28:57 [43mdestination[0m >  as `invoiceDueDate`,
2023-12-22 09:28:57 [43mdestination[0m > CAST(JSON_VALUE(`_airbyte_data`, '$."functionalAmount"') as NUMERIC) as `functionalAmount`,
2023-12-22 09:28:57 [43mdestination[0m > (CASE
2023-12-22 09:28:57 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."bookkeepingStatus"') IS NULL
2023-12-22 09:28:57 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."bookkeepingStatus"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:28:57 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."bookkeepingStatus"')
2023-12-22 09:28:57 [43mdestination[0m >     ELSE
2023-12-22 09:28:57 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."bookkeepingStatus"')
2023-12-22 09:28:57 [43mdestination[0m >   END)
2023-12-22 09:28:57 [43mdestination[0m >  as `bookkeepingStatus`,
2023-12-22 09:28:57 [43mdestination[0m > (CASE
2023-12-22 09:28:57 [43mdestination[0m >       WHEN JSON_QUERY(`_airbyte_data`, '$."functionalCurrency"') IS NULL
2023-12-22 09:28:57 [43mdestination[0m >         OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."functionalCurrency"'), wide_number_mode=>'round')) != 'string'
2023-12-22 09:28:57 [43mdestination[0m >         THEN JSON_QUERY(`_airbyte_data`, '$."functionalCurrency"')
2023-12-22 09:28:57 [43mdestination[0m >     ELSE
2023-12-22 09:28:57 [43mdestination[0m >     JSON_VALUE(`_airbyte_data`, '$."functionalCurrency"')
2023-12-22 09:28:57 [43mdestination[0m >   END)
2023-12-22 09:28:57 [43mdestination[0m >  as `functionalCurrency`,
2023-12-22 09:28:57 [43mdestination[0m > PARSE_JSON(CASE
2023-12-22 09:28:57 [43mdestination[0m >   WHEN JSON_QUERY(`_airbyte_data`, '$."documentaryEvidence"') IS NULL
2023-12-22 09:28:57 [43mdestination[0m >     OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."documentaryEvidence"'), wide_number_mode=>'round')) != 'object'
2023-12-22 09:28:57 [43mdestination[0m >     THEN NULL
2023-12-22 09:28:57 [43mdestination[0m >   ELSE JSON_QUERY(`_airbyte_data`, '$."documentaryEvidence"')
2023-12-22 09:28:57 [43mdestination[0m > END, wide_number_mode=>'round')
2023-12-22 09:28:57 [43mdestination[0m >  as `documentaryEvidence`,
2023-12-22 09:28:57 [43mdestination[0m > PARSE_JSON(CASE
2023-12-22 09:28:57 [43mdestination[0m >   WHEN JSON_QUERY(`_airbyte_data`, '$."analyticalProperties"') IS NULL
2023-12-22 09:28:57 [43mdestination[0m >     OR JSON_TYPE(PARSE_JSON(JSON_QUERY(`_airbyte_data`, '$."analyticalProperties"'), wide_number_mode=>'round')) != 'array'
2023-12-22 09:28:57 [43mdestination[0m >     THEN NULL
2023-12-22 09:28:57 [43mdestination[0m >   ELSE JSON_QUERY(`_airbyte_data`, '$."analyticalProperties"')
2023-12-22 09:28:57 [43mdestination[0m > END, wide_number_mode=>'round')
2023-12-22 09:28:57 [43mdestination[0m >  as `analyticalProperties`,
2023-12-22 09:28:57 [43mdestination[0m > CAST(JSON_VALUE(`_airbyte_data`, '$."functionalExchangeRate"') as NUMERIC) as `functionalExchangeRate`,
2023-12-22 09:28:57 [43mdestination[0m >   [] AS column_errors,
2023-12-22 09:28:57 [43mdestination[0m >   _airbyte_raw_id,
2023-12-22 09:28:57 [43mdestination[0m >   _airbyte_extracted_at
2023-12-22 09:28:57 [43mdestination[0m >   FROM `reporting-340722`.`airbyte_internal`.`sources_raw__stream_spendesk_payables`
2023-12-22 09:28:57 [43mdestination[0m >   WHERE
2023-12-22 09:28:57 [43mdestination[0m >     _airbyte_loaded_at IS NULL
2023-12-22 09:28:57 [43mdestination[0m >      AND _airbyte_extracted_at > '2023-12-22T09:05:31.164Z'
2023-12-22 09:28:57 [43mdestination[0m > )
2023-12-22 09:28:57 [43mdestination[0m > SELECT
2023-12-22 09:28:57 [43mdestination[0m > `id`,
2023-12-22 09:28:57 [43mdestination[0m > `type`,
2023-12-22 09:28:57 [43mdestination[0m > `amount`,
2023-12-22 09:28:57 [43mdestination[0m > `teamId`,
2023-12-22 09:28:57 [43mdestination[0m > `userId`,
2023-12-22 09:28:57 [43mdestination[0m > `currency`,
2023-12-22 09:28:57 [43mdestination[0m > `teamName`,
2023-12-22 09:28:57 [43mdestination[0m > `companyId`,
2023-12-22 09:28:57 [43mdestination[0m > `lineItems`,
2023-12-22 09:28:57 [43mdestination[0m > `exportedAt`,
2023-12-22 09:28:57 [43mdestination[0m > `allocations`,
2023-12-22 09:28:57 [43mdestination[0m > `description`,
2023-12-22 09:28:57 [43mdestination[0m > `payableDate`,
2023-12-22 09:28:57 [43mdestination[0m > `costCenterId`,
2023-12-22 09:28:57 [43mdestination[0m > `counterparty`,
2023-12-22 09:28:57 [43mdestination[0m > `invoiceNumber`,
2023-12-22 09:28:57 [43mdestination[0m > `costCenterName`,
2023-12-22 09:28:57 [43mdestination[0m > `invoiceDueDate`,
2023-12-22 09:28:57 [43mdestination[0m > `functionalAmount`,
2023-12-22 09:28:57 [43mdestination[0m > `bookkeepingStatus`,
2023-12-22 09:28:57 [43mdestination[0m > `functionalCurrency`,
2023-12-22 09:28:57 [43mdestination[0m > `documentaryEvidence`,
2023-12-22 09:28:57 [43mdestination[0m > `analyticalProperties`,
2023-12-22 09:28:57 [43mdestination[0m > `functionalExchangeRate`,
2023-12-22 09:28:57 [43mdestination[0m >   to_json(struct(COALESCE((SELECT ARRAY_AGG(unnested_column_errors IGNORE NULLS) FROM UNNEST(column_errors) unnested_column_errors), []) AS errors)) AS _airbyte_meta,
2023-12-22 09:28:57 [43mdestination[0m >   _airbyte_raw_id,
2023-12-22 09:28:57 [43mdestination[0m >   _airbyte_extracted_at
2023-12-22 09:28:57 [43mdestination[0m > FROM intermediate_data;
2023-12-22 09:28:57 [43mdestination[0m > UPDATE `reporting-340722`.`airbyte_internal`.`sources_raw__stream_spendesk_payables`
2023-12-22 09:28:57 [43mdestination[0m > SET `_airbyte_loaded_at` = CURRENT_TIMESTAMP()
2023-12-22 09:28:57 [43mdestination[0m > WHERE `_airbyte_loaded_at` IS NULL
2023-12-22 09:28:57 [43mdestination[0m >    AND _airbyte_extracted_at > '2023-12-22T09:05:31.164Z'
2023-12-22 09:28:57 [43mdestination[0m > ;
2023-12-22 09:28:57 [43mdestination[0m > COMMIT TRANSACTION;
2023-12-22 09:28:57 [43mdestination[0m > 
2023-12-22 09:29:02 [43mdestination[0m > 2023-12-22 09:29:02 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):119 - Root-level job 16c7aea8-2134-4113-8431-e9871440a5e7 completed in 4681 ms; processed 64642 bytes; billed for 31457280 bytes
2023-12-22 09:29:02 [43mdestination[0m > 2023-12-22 09:29:02 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql BEGIN TRANSACTION completed in 44 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:29:02 [43mdestination[0m > 2023-12-22 09:29:02 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql INSERT INTO `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` ( `id`, `type`, `amount`, `... completed in 1582 ms; processed 32321 bytes; billed for 20971520 bytes
2023-12-22 09:29:02 [43mdestination[0m > 2023-12-22 09:29:02 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql UPDATE `reporting-340722`.`airbyte_internal`.`sources_raw__stream_spendesk_payables` SET `_airbyte_l... completed in 1486 ms; processed 32321 bytes; billed for 10485760 bytes
2023-12-22 09:29:02 [43mdestination[0m > 2023-12-22 09:29:02 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql COMMIT TRANSACTION completed in 100 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:29:02 [43mdestination[0m > 2023-12-22 09:29:02 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$typeAndDedupeTask$2):224 - Allowing other threads to proceed for sources.spendesk_payables
2023-12-22 09:29:02 [43mdestination[0m > 2023-12-22 09:29:02 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onCloseFunction$4):179 - Cleaning up destination started for 1 streams
2023-12-22 09:29:02 [43mdestination[0m > 2023-12-22 09:29:02 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(dropStageIfExists):186 - Cleaning up staging path for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables
2023-12-22 09:29:02 [43mdestination[0m > 2023-12-22 09:29:02 [32mINFO[m i.a.i.d.g.GcsStorageOperations(cleanUpObjects):43 - Deleting object ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/7861255a-6af2-488e-bab5-c93ca069e82b.csv.gz
2023-12-22 09:29:03 [43mdestination[0m > 2023-12-22 09:29:03 [32mINFO[m i.a.i.d.g.GcsStorageOperations(cleanUpObjects):43 - Deleting object ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/c31d5150-45f8-4252-a47f-b23f9f1cf4a6.csv.gz
2023-12-22 09:29:03 [43mdestination[0m > 2023-12-22 09:29:03 [32mINFO[m i.a.i.d.g.GcsStorageOperations(cleanUpObjects):43 - Deleting object ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/ca0edc46-1bda-4a10-af6d-49b0cd074565/f3c0cce7-1307-4999-8728-4b2237083b20.csv.gz
2023-12-22 09:29:03 [43mdestination[0m > 2023-12-22 09:29:03 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(cleanUpBucketObject):295 - Storage bucket ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables has been cleaned-up (3 objects were deleted)...
2023-12-22 09:29:03 [43mdestination[0m > 2023-12-22 09:29:03 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(commitFinalTables):258 - Committing final tables
2023-12-22 09:29:03 [43mdestination[0m > 2023-12-22 09:29:03 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$commitFinalTableTask$6):281 - Overwriting final table with tmp table for stream sources.spendesk_payables
2023-12-22 09:29:03 [43mdestination[0m > 2023-12-22 09:29:03 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):99 - Executing sql 3ee93a8c-063e-458b-b4e3-43c5d86993cf: DROP TABLE IF EXISTS `reporting-340722`.`sources`.`spendesk_payables`;
2023-12-22 09:29:03 [43mdestination[0m > ALTER TABLE `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` RENAME TO `spendesk_payables`;
2023-12-22 09:29:03 [43mdestination[0m > 
2023-12-22 09:29:05 [43mdestination[0m > 2023-12-22 09:29:05 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):119 - Root-level job 3ee93a8c-063e-458b-b4e3-43c5d86993cf completed in 1362 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:29:05 [43mdestination[0m > 2023-12-22 09:29:05 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql DROP TABLE IF EXISTS `reporting-340722`.`sources`.`spendesk_payables` completed in 109 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:29:05 [43mdestination[0m > 2023-12-22 09:29:05 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql ALTER TABLE `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` RENAME TO `spendesk_payable... completed in 638 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:29:05 [43mdestination[0m > 2023-12-22 09:29:05 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(cleanup):299 - Cleaning Up type-and-dedupe thread pool
2023-12-22 09:29:05 [43mdestination[0m > 2023-12-22 09:29:05 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onCloseFunction$4):185 - Cleaning up destination completed.
2023-12-22 09:29:05 [43mdestination[0m > 2023-12-22 09:29:05 [32mINFO[m i.a.c.i.d.AsyncStreamConsumer(close):211 - class io.airbyte.cdk.integrations.destination_async.AsyncStreamConsumer closed
2023-12-22 09:29:05 [43mdestination[0m > 2023-12-22 09:29:05 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):228 - Completed integration: io.airbyte.integrations.destination.bigquery.BigQueryDestination
2023-12-22 09:29:06 [46mplatform[0m > readFromDestination: done. (writeToDestFailed:false, dest.isFinished:true)
2023-12-22 09:29:06 [46mplatform[0m > thread status... timeout thread: false , replication thread: true
2023-12-22 09:29:06 [46mplatform[0m > sync summary: {
  "status" : "failed",
  "recordsSynced" : 0,
  "bytesSynced" : 0,
  "startTime" : 1703236659765,
  "endTime" : 1703237346102,
  "totalStats" : {
    "bytesCommitted" : 0,
    "bytesEmitted" : 30871,
    "destinationStateMessagesEmitted" : 0,
    "destinationWriteEndTime" : 1703237346099,
    "destinationWriteStartTime" : 1703236659766,
    "meanSecondsBeforeSourceStateMessageEmitted" : 0,
    "maxSecondsBeforeSourceStateMessageEmitted" : 0,
    "maxSecondsBetweenStateMessageEmittedandCommitted" : 0,
    "meanSecondsBetweenStateMessageEmittedandCommitted" : 0,
    "recordsEmitted" : 30,
    "recordsCommitted" : 0,
    "replicationEndTime" : 1703237346102,
    "replicationStartTime" : 1703236659765,
    "sourceReadEndTime" : 0,
    "sourceReadStartTime" : 1703236659766,
    "sourceStateMessagesEmitted" : 0
  },
  "streamStats" : [ {
    "streamName" : "payables",
    "stats" : {
      "bytesCommitted" : 0,
      "bytesEmitted" : 30871,
      "recordsEmitted" : 30,
      "recordsCommitted" : 0
    }
  } ],
  "performanceMetrics" : {
    "processFromSource" : {
      "elapsedTimeInNanos" : 613046699268,
      "executionCount" : 34,
      "avgExecTimeInNanos" : 1.8030785272588234E10
    },
    "readFromSource" : {
      "elapsedTimeInNanos" : 60228980955,
      "executionCount" : 181,
      "avgExecTimeInNanos" : 3.327568008563536E8
    },
    "processFromDest" : {
      "elapsedTimeInNanos" : 0,
      "executionCount" : 0,
      "avgExecTimeInNanos" : "NaN"
    },
    "writeToDest" : {
      "elapsedTimeInNanos" : 1307890,
      "executionCount" : 30,
      "avgExecTimeInNanos" : 43596.333333333336
    },
    "readFromDest" : {
      "elapsedTimeInNanos" : 686268104363,
      "executionCount" : 275,
      "avgExecTimeInNanos" : 2.495520379501818E9
    }
  }
}
2023-12-22 09:29:06 [46mplatform[0m > failures: [ {
  "failureOrigin" : "source",
  "failureType" : "system_error",
  "internalMessage" : "Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {\"errors\":[{\"code\":\"INTERNAL_SERVER_ERROR\",\"detail\":\"Sorry, something has gone wrong at our end. If this persists please contact support.\"}]}",
  "externalMessage" : "Something went wrong in the connector. See the logs for more details.",
  "metadata" : {
    "attemptNumber" : 2,
    "jobId" : 292,
    "from_trace_message" : true,
    "connector_command" : "read"
  },
  "stacktrace" : "Traceback (most recent call last):\n  File \"/airbyte/integration_code/main.py\", line 29, in <module>\n    launch(source, sys.argv[1:])\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py\", line 210, in launch\n    for message in source_entrypoint.run(parsed_args):\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py\", line 117, in run\n    yield from map(AirbyteEntrypoint.airbyte_message_to_string, self.read(source_spec, config, config_catalog, state))\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py\", line 159, in read\n    yield from self.source.read(self.logger, config, catalog, state)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/manifest_declarative_source.py\", line 134, in read\n    yield from super().read(logger, config, catalog, state)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py\", line 141, in read\n    raise e\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py\", line 121, in read\n    yield from self._read_stream(\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py\", line 193, in _read_stream\n    for record in record_iterator:\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py\", line 253, in _read_full_refresh\n    for record_data_or_message in stream_instance.read_full_refresh(configured_stream.cursor_field, logger, self._slice_logger):\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/streams/core.py\", line 121, in read_full_refresh\n    yield from self.read_records(\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/declarative_stream.py\", line 104, in read_records\n    yield from self.retriever.read_records(stream_slice)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py\", line 304, in read_records\n    for stream_data in self._read_pages(self._parse_records, self.state, stream_slice):\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py\", line 282, in _read_pages\n    response = self._fetch_next_page(stream_state, stream_slice, next_page_token)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py\", line 256, in _fetch_next_page\n    return self.requester.send_request(\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py\", line 412, in send_request\n    response = self._send_with_retry(request, log_formatter=log_formatter)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py\", line 458, in _send_with_retry\n    return backoff_handler(user_backoff_handler)(request, log_formatter=log_formatter)  # type: ignore\n  File \"/usr/local/lib/python3.9/site-packages/backoff/_sync.py\", line 105, in retry\n    ret = target(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/backoff/_sync.py\", line 105, in retry\n    ret = target(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py\", line 497, in _send\n    raise UserDefinedBackoffException(backoff=custom_backoff_time, request=request, response=response)\nairbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {\"errors\":[{\"code\":\"INTERNAL_SERVER_ERROR\",\"detail\":\"Sorry, something has gone wrong at our end. If this persists please contact support.\"}]}\n",
  "timestamp" : 1703236719860
}, {
  "failureOrigin" : "source",
  "internalMessage" : "Source process exited with non-zero exit code 1",
  "externalMessage" : "Something went wrong within the source connector",
  "metadata" : {
    "attemptNumber" : 2,
    "jobId" : 292,
    "connector_command" : "read"
  },
  "stacktrace" : "io.airbyte.workers.internal.exception.SourceException: Source process exited with non-zero exit code 1\n\tat io.airbyte.workers.general.BufferedReplicationWorker.readFromSource(BufferedReplicationWorker.java:365)\n\tat io.airbyte.workers.general.BufferedReplicationWorker.lambda$runAsyncWithHeartbeatCheck$3(BufferedReplicationWorker.java:235)\n\tat java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)\n\tat java.base/java.lang.Thread.run(Thread.java:1589)\n",
  "timestamp" : 1703236720051
} ]
2023-12-22 09:29:06 [46mplatform[0m > 
2023-12-22 09:29:06 [46mplatform[0m > ----- END REPLICATION -----
2023-12-22 09:29:06 [46mplatform[0m > 
2023-12-22 09:29:06 [46mplatform[0m > Retry State: RetryManager(completeFailureBackoffPolicy=BackoffPolicy(minInterval=PT10S, maxInterval=PT30M, base=3), partialFailureBackoffPolicy=null, successiveCompleteFailureLimit=5, totalCompleteFailureLimit=10, successivePartialFailureLimit=1000, totalPartialFailureLimit=10, successiveCompleteFailures=3, totalCompleteFailures=3, successivePartialFailures=0, totalPartialFailures=0)
 Backoff before next attempt: 1 minute 30 seconds
2023-12-22 09:29:06 [46mplatform[0m > Retry State: RetryManager(completeFailureBackoffPolicy=BackoffPolicy(minInterval=PT10S, maxInterval=PT30M, base=3), partialFailureBackoffPolicy=null, successiveCompleteFailureLimit=5, totalCompleteFailureLimit=10, successivePartialFailureLimit=1000, totalPartialFailureLimit=10, successiveCompleteFailures=3, totalCompleteFailures=3, successivePartialFailures=0, totalPartialFailures=0)
2023-12-22 09:29:06 [46mplatform[0m > Backing off for: 1 minute 30 seconds.
2023-12-22 09:30:37 [46mplatform[0m > Docker volume job log path: /tmp/workspace/292/3/logs.log
2023-12-22 09:30:37 [46mplatform[0m > Executing worker wrapper. Airbyte version: 0.50.35
2023-12-22 09:30:37 [46mplatform[0m > Attempt 0 to save workflow id for cancellation
2023-12-22 09:30:37 [46mplatform[0m > 
2023-12-22 09:30:37 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:30:37 [46mplatform[0m > ----- START CHECK -----
2023-12-22 09:30:37 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:30:37 [46mplatform[0m > 
2023-12-22 09:30:37 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:30:37 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:30:37 [46mplatform[0m > Using default value for environment variable LAUNCHDARKLY_KEY: ''
2023-12-22 09:30:37 [46mplatform[0m > Checking if airbyte/source-declarative-manifest:0.55.2 exists...
2023-12-22 09:30:37 [46mplatform[0m > airbyte/source-declarative-manifest:0.55.2 was found locally.
2023-12-22 09:30:37 [46mplatform[0m > Creating docker container = source-declarative-manifest-check-292-3-iwhkl with resources io.airbyte.config.ResourceRequirements@f38952c[cpuRequest=,cpuLimit=,memoryRequest=,memoryLimit=,additionalProperties={}] and allowedHosts null
2023-12-22 09:30:37 [46mplatform[0m > Preparing command: docker run --rm --init -i -w /data/292/3 --log-driver none --name source-declarative-manifest-check-292-3-iwhkl --network host -v airbyte_workspace:/data -v /tmp/airbyte_local:/local -e DEPLOYMENT_MODE=OSS -e WORKER_CONNECTOR_IMAGE=airbyte/source-declarative-manifest:0.55.2 -e AUTO_DETECT_SCHEMA=true -e LAUNCHDARKLY_KEY= -e SOCAT_KUBE_CPU_REQUEST=0.1 -e SOCAT_KUBE_CPU_LIMIT=2.0 -e FIELD_SELECTION_WORKSPACES= -e USE_STREAM_CAPABLE_STATE=true -e WORKER_ENVIRONMENT=DOCKER -e AIRBYTE_ROLE= -e APPLY_FIELD_SELECTION=false -e WORKER_JOB_ATTEMPT=3 -e OTEL_COLLECTOR_ENDPOINT=http://host.docker.internal:4317 -e FEATURE_FLAG_CLIENT=config -e AIRBYTE_VERSION=0.50.35 -e WORKER_JOB_ID=292 airbyte/source-declarative-manifest:0.55.2 check --config source_config.json
2023-12-22 09:30:37 [46mplatform[0m > Reading messages from protocol version 0.2.0
2023-12-22 09:30:39 [46mplatform[0m > Check succeeded
2023-12-22 09:30:40 [46mplatform[0m > Check connection job received output: io.airbyte.config.StandardCheckConnectionOutput@96088b[status=succeeded,message=<null>,additionalProperties={}]
2023-12-22 09:30:40 [46mplatform[0m > 
2023-12-22 09:30:40 [46mplatform[0m > ----- END CHECK -----
2023-12-22 09:30:40 [46mplatform[0m > 
2023-12-22 09:30:40 [46mplatform[0m > Docker volume job log path: /tmp/workspace/292/3/logs.log
2023-12-22 09:30:40 [46mplatform[0m > Executing worker wrapper. Airbyte version: 0.50.35
2023-12-22 09:30:40 [46mplatform[0m > Attempt 0 to save workflow id for cancellation
2023-12-22 09:30:40 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:30:40 [46mplatform[0m > 
2023-12-22 09:30:40 [46mplatform[0m > ----- START CHECK -----
2023-12-22 09:30:40 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:30:40 [46mplatform[0m > 
2023-12-22 09:30:40 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:30:40 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:30:40 [46mplatform[0m > Using default value for environment variable LAUNCHDARKLY_KEY: ''
2023-12-22 09:30:40 [46mplatform[0m > Checking if airbyte/destination-bigquery:2.3.16 exists...
2023-12-22 09:30:40 [46mplatform[0m > airbyte/destination-bigquery:2.3.16 was found locally.
2023-12-22 09:30:40 [46mplatform[0m > Creating docker container = destination-bigquery-check-292-3-ytgit with resources io.airbyte.config.ResourceRequirements@63cedd12[cpuRequest=,cpuLimit=,memoryRequest=,memoryLimit=,additionalProperties={}] and allowedHosts null
2023-12-22 09:30:40 [46mplatform[0m > Preparing command: docker run --rm --init -i -w /data/292/3 --log-driver none --name destination-bigquery-check-292-3-ytgit --network host -v airbyte_workspace:/data -v /tmp/airbyte_local:/local -e DEPLOYMENT_MODE=OSS -e WORKER_CONNECTOR_IMAGE=airbyte/destination-bigquery:2.3.16 -e AUTO_DETECT_SCHEMA=true -e LAUNCHDARKLY_KEY= -e SOCAT_KUBE_CPU_REQUEST=0.1 -e SOCAT_KUBE_CPU_LIMIT=2.0 -e FIELD_SELECTION_WORKSPACES= -e USE_STREAM_CAPABLE_STATE=true -e WORKER_ENVIRONMENT=DOCKER -e AIRBYTE_ROLE= -e APPLY_FIELD_SELECTION=false -e WORKER_JOB_ATTEMPT=3 -e OTEL_COLLECTOR_ENDPOINT=http://host.docker.internal:4317 -e FEATURE_FLAG_CLIENT=config -e AIRBYTE_VERSION=0.50.35 -e WORKER_JOB_ID=292 airbyte/destination-bigquery:2.3.16 check --config source_config.json
2023-12-22 09:30:40 [46mplatform[0m > Reading messages from protocol version 0.2.0
2023-12-22 09:30:41 [46mplatform[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:30:41 [46mplatform[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:30:41 [46mplatform[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:30:41 [46mplatform[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:30:42 [46mplatform[0m > 2023-12-22 09:30:42 [32mINFO[m i.a.c.i.b.IntegrationCliParser(parseOptions):126 - integration args: {check=null, config=source_config.json}
2023-12-22 09:30:42 [46mplatform[0m > 2023-12-22 09:30:42 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):132 - Running integration: io.airbyte.integrations.destination.bigquery.BigQueryDestination
2023-12-22 09:30:42 [46mplatform[0m > 2023-12-22 09:30:42 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):133 - Command: CHECK
2023-12-22 09:30:42 [46mplatform[0m > 2023-12-22 09:30:42 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):134 - Integration config: IntegrationConfig{command=CHECK, configPath='source_config.json', catalogPath='null', statePath='null'}
2023-12-22 09:30:42 [46mplatform[0m > 2023-12-22 09:30:42 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword groups - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:30:42 [46mplatform[0m > 2023-12-22 09:30:42 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword group - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:30:42 [46mplatform[0m > 2023-12-22 09:30:42 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword order - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:30:42 [46mplatform[0m > 2023-12-22 09:30:42 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword display_type - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:30:42 [46mplatform[0m > 2023-12-22 09:30:42 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword airbyte_secret - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:30:42 [46mplatform[0m > 2023-12-22 09:30:42 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword always_show - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:30:42 [46mplatform[0m > 2023-12-22 09:30:42 [32mINFO[m i.a.i.d.b.BigQueryUtils(getLoadingMethod):426 - Selected loading method is set to: GCS
2023-12-22 09:30:46 [46mplatform[0m > 2023-12-22 09:30:46 [32mINFO[m i.a.c.i.d.s.S3FormatConfigs(getS3FormatConfig):22 - S3 format config: {"format_type":"CSV","flattening":"No flattening"}
2023-12-22 09:30:47 [46mplatform[0m > 2023-12-22 09:30:47 [32mINFO[m i.a.c.i.d.s.S3BaseChecks(testSingleUpload):40 - Started testing if all required credentials assigned to user for single file uploading
2023-12-22 09:30:47 [46mplatform[0m > 2023-12-22 09:30:47 [32mINFO[m i.a.c.i.d.s.S3BaseChecks(testSingleUpload):48 - Finished checking for normal upload mode
2023-12-22 09:30:47 [46mplatform[0m > 2023-12-22 09:30:47 [32mINFO[m i.a.c.i.d.s.S3BaseChecks(testMultipartUpload):52 - Started testing if all required credentials assigned to user for multipart upload
2023-12-22 09:30:47 [46mplatform[0m > 2023-12-22 09:30:47 [32mINFO[m a.m.s.StreamTransferManager(getMultiPartOutputStreams):329 - Initiated multipart upload to ucm-analytics-bucket/ucm-analytics-bucket/sources/test_1703237447630 with full ID ABPnzm4jL9Qt6bVaEhu1b1gIVVAKlhhaqi8aGMbOyzwhoJljTnAQicR-OkSPpWVvWCiFgNO9
2023-12-22 09:30:47 [46mplatform[0m > 2023-12-22 09:30:47 [32mINFO[m a.m.s.MultiPartOutputStream(close):158 - Called close() on [MultipartOutputStream for parts 1 - 10000]
2023-12-22 09:30:47 [46mplatform[0m > 2023-12-22 09:30:47 [32mINFO[m a.m.s.MultiPartOutputStream(close):158 - Called close() on [MultipartOutputStream for parts 1 - 10000]
2023-12-22 09:30:47 [46mplatform[0m > 2023-12-22 09:30:47 [33mWARN[m a.m.s.MultiPartOutputStream(close):160 - [MultipartOutputStream for parts 1 - 10000] is already closed
2023-12-22 09:30:47 [46mplatform[0m > 2023-12-22 09:30:47 [32mINFO[m a.m.s.StreamTransferManager(complete):367 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/test_1703237447630 with id ABPnzm4jL...vWCiFgNO9]: Uploading leftover stream [Part number 1 containing 3.34 MB]
2023-12-22 09:30:48 [46mplatform[0m > 2023-12-22 09:30:48 [32mINFO[m a.m.s.StreamTransferManager(uploadStreamPart):558 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/test_1703237447630 with id ABPnzm4jL...vWCiFgNO9]: Finished uploading [Part number 1 containing 3.34 MB]
2023-12-22 09:30:48 [46mplatform[0m > 2023-12-22 09:30:48 [32mINFO[m a.m.s.StreamTransferManager(complete):395 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/test_1703237447630 with id ABPnzm4jL...vWCiFgNO9]: Completed
2023-12-22 09:30:48 [46mplatform[0m > 2023-12-22 09:30:48 [32mINFO[m i.a.c.i.d.s.S3BaseChecks(testMultipartUpload):74 - Finished verification for multipart upload mode
2023-12-22 09:30:49 [46mplatform[0m > 2023-12-22 09:30:49 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):228 - Completed integration: io.airbyte.integrations.destination.bigquery.BigQueryDestination
2023-12-22 09:30:49 [46mplatform[0m > Check connection job received output: io.airbyte.config.StandardCheckConnectionOutput@73133f62[status=succeeded,message=<null>,additionalProperties={}]
2023-12-22 09:30:49 [46mplatform[0m > 
2023-12-22 09:30:49 [46mplatform[0m > ----- END CHECK -----
2023-12-22 09:30:49 [46mplatform[0m > 
2023-12-22 09:30:50 [46mplatform[0m > Docker volume job log path: /tmp/workspace/292/3/logs.log
2023-12-22 09:30:50 [46mplatform[0m > Executing worker wrapper. Airbyte version: 0.50.35
2023-12-22 09:30:50 [46mplatform[0m > Attempt 0 to save workflow id for cancellation
2023-12-22 09:30:50 [46mplatform[0m > start sync worker. job id: 292 attempt id: 3
2023-12-22 09:30:50 [46mplatform[0m > 
2023-12-22 09:30:50 [46mplatform[0m > ----- START REPLICATION -----
2023-12-22 09:30:50 [46mplatform[0m > Running destination...
2023-12-22 09:30:50 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:30:50 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:30:50 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:30:50 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:30:50 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_LIMIT: '2.0'
2023-12-22 09:30:50 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:30:50 [46mplatform[0m > 
2023-12-22 09:30:50 [46mplatform[0m > Using default value for environment variable SIDECAR_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:30:50 [46mplatform[0m > Using default value for environment variable LAUNCHDARKLY_KEY: ''
2023-12-22 09:30:50 [46mplatform[0m > Using default value for environment variable SOCAT_KUBE_CPU_REQUEST: '0.1'
2023-12-22 09:30:50 [46mplatform[0m > Using default value for environment variable LAUNCHDARKLY_KEY: ''
2023-12-22 09:30:50 [46mplatform[0m > Checking if airbyte/source-declarative-manifest:0.55.2 exists...
2023-12-22 09:30:50 [46mplatform[0m > Checking if airbyte/destination-bigquery:2.3.16 exists...
2023-12-22 09:30:50 [46mplatform[0m > airbyte/destination-bigquery:2.3.16 was found locally.
2023-12-22 09:30:50 [46mplatform[0m > Creating docker container = destination-bigquery-write-292-3-hvjny with resources io.airbyte.config.ResourceRequirements@1dfaf6c5[cpuRequest=,cpuLimit=,memoryRequest=,memoryLimit=,additionalProperties={}] and allowedHosts null
2023-12-22 09:30:50 [46mplatform[0m > Preparing command: docker run --rm --init -i -w /data/292/3 --log-driver none --name destination-bigquery-write-292-3-hvjny --network host -v airbyte_workspace:/data -v /tmp/airbyte_local:/local -e DEPLOYMENT_MODE=OSS -e WORKER_CONNECTOR_IMAGE=airbyte/destination-bigquery:2.3.16 -e AUTO_DETECT_SCHEMA=true -e LAUNCHDARKLY_KEY= -e SOCAT_KUBE_CPU_REQUEST=0.1 -e SOCAT_KUBE_CPU_LIMIT=2.0 -e FIELD_SELECTION_WORKSPACES= -e USE_STREAM_CAPABLE_STATE=true -e WORKER_ENVIRONMENT=DOCKER -e AIRBYTE_ROLE= -e APPLY_FIELD_SELECTION=false -e WORKER_JOB_ATTEMPT=3 -e OTEL_COLLECTOR_ENDPOINT=http://host.docker.internal:4317 -e FEATURE_FLAG_CLIENT=config -e AIRBYTE_VERSION=0.50.35 -e WORKER_JOB_ID=292 airbyte/destination-bigquery:2.3.16 write --config destination_config.json --catalog destination_catalog.json
2023-12-22 09:30:50 [46mplatform[0m > airbyte/source-declarative-manifest:0.55.2 was found locally.
2023-12-22 09:30:50 [46mplatform[0m > Creating docker container = source-declarative-manifest-read-292-3-uwnwr with resources io.airbyte.config.ResourceRequirements@e814124[cpuRequest=,cpuLimit=,memoryRequest=,memoryLimit=,additionalProperties={}] and allowedHosts null
2023-12-22 09:30:50 [46mplatform[0m > Preparing command: docker run --rm --init -i -w /data/292/3 --log-driver none --name source-declarative-manifest-read-292-3-uwnwr -e CONCURRENT_SOURCE_STREAM_READ=false --network host -v airbyte_workspace:/data -v /tmp/airbyte_local:/local -e DEPLOYMENT_MODE=OSS -e WORKER_CONNECTOR_IMAGE=airbyte/source-declarative-manifest:0.55.2 -e AUTO_DETECT_SCHEMA=true -e LAUNCHDARKLY_KEY= -e SOCAT_KUBE_CPU_REQUEST=0.1 -e SOCAT_KUBE_CPU_LIMIT=2.0 -e FIELD_SELECTION_WORKSPACES= -e USE_STREAM_CAPABLE_STATE=true -e WORKER_ENVIRONMENT=DOCKER -e AIRBYTE_ROLE= -e APPLY_FIELD_SELECTION=false -e WORKER_JOB_ATTEMPT=3 -e OTEL_COLLECTOR_ENDPOINT=http://host.docker.internal:4317 -e FEATURE_FLAG_CLIENT=config -e AIRBYTE_VERSION=0.50.35 -e WORKER_JOB_ID=292 airbyte/source-declarative-manifest:0.55.2 read --config source_config.json --catalog source_catalog.json
2023-12-22 09:30:50 [46mplatform[0m > Writing messages to protocol version 0.2.0
2023-12-22 09:30:50 [46mplatform[0m > Reading messages from protocol version 0.2.0
2023-12-22 09:30:50 [46mplatform[0m > Reading messages from protocol version 0.2.0
2023-12-22 09:30:50 [46mplatform[0m > readFromSource: start
2023-12-22 09:30:50 [46mplatform[0m > Starting source heartbeat check. Will check every 1 minutes.
2023-12-22 09:30:50 [46mplatform[0m > writeToDestination: start
2023-12-22 09:30:50 [46mplatform[0m > processMessage: start
2023-12-22 09:30:50 [46mplatform[0m > readFromDestination: start
2023-12-22 09:30:54 [44msource[0m > Starting syncing ManifestDeclarativeSource
2023-12-22 09:30:54 [44msource[0m > Marking stream payables as STARTED
2023-12-22 09:30:54 [44msource[0m > Syncing stream: payables 
2023-12-22 09:30:54 [43mdestination[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:30:54 [43mdestination[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:30:54 [43mdestination[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:30:54 [43mdestination[0m > WARN StatusConsoleListener The use of package scanning to locate plugins is deprecated and will be removed in a future release
2023-12-22 09:30:54 [44msource[0m > Marking stream payables as RUNNING
2023-12-22 09:30:54 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:30:54 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 09:30:55 [43mdestination[0m > 2023-12-22 09:30:55 [32mINFO[m i.a.c.i.b.IntegrationCliParser(parseOptions):126 - integration args: {catalog=destination_catalog.json, write=null, config=destination_config.json}
2023-12-22 09:30:55 [43mdestination[0m > 2023-12-22 09:30:55 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):132 - Running integration: io.airbyte.integrations.destination.bigquery.BigQueryDestination
2023-12-22 09:30:55 [43mdestination[0m > 2023-12-22 09:30:55 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):133 - Command: WRITE
2023-12-22 09:30:55 [43mdestination[0m > 2023-12-22 09:30:55 [32mINFO[m i.a.c.i.b.IntegrationRunner(runInternal):134 - Integration config: IntegrationConfig{command=WRITE, configPath='destination_config.json', catalogPath='destination_catalog.json', statePath='null'}
2023-12-22 09:30:56 [43mdestination[0m > 2023-12-22 09:30:56 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword groups - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:30:56 [43mdestination[0m > 2023-12-22 09:30:56 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword group - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:30:56 [43mdestination[0m > 2023-12-22 09:30:56 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword order - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:30:56 [43mdestination[0m > 2023-12-22 09:30:56 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword display_type - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:30:56 [43mdestination[0m > 2023-12-22 09:30:56 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword airbyte_secret - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:30:56 [43mdestination[0m > 2023-12-22 09:30:56 [33mWARN[m c.n.s.JsonMetaSchema(newValidator):278 - Unknown keyword always_show - you should define your own Meta Schema. If the keyword is irrelevant for validation, just use a NonValidationKeyword
2023-12-22 09:30:56 [43mdestination[0m > 2023-12-22 09:30:56 [32mINFO[m i.a.i.d.b.BigQueryUtils(getLoadingMethod):426 - Selected loading method is set to: GCS
2023-12-22 09:30:56 [43mdestination[0m > 2023-12-22 09:30:56 [32mINFO[m i.a.c.i.d.s.S3FormatConfigs(getS3FormatConfig):22 - S3 format config: {"format_type":"CSV","flattening":"No flattening"}
2023-12-22 09:30:56 [43mdestination[0m > 2023-12-22 09:30:56 [32mINFO[m i.a.i.d.b.BigQueryUtils(isKeepFilesInGcs):442 - All tmp files will be removed from GCS when replication is finished
2023-12-22 09:30:57 [43mdestination[0m > 2023-12-22 09:30:57 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$createWriteConfigs$1):114 - BigQuery write config: BigQueryWriteConfig[streamName=spendesk_payables, namespace=sources, datasetId=airbyte_internal, datasetLocation=europe-west3, tmpTableId=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=_airbyte_tmp_vmz_spendesk_payables}}, targetTableId=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}, tableSchema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, syncMode=overwrite]
2023-12-22 09:30:57 [43mdestination[0m > 2023-12-22 09:30:57 [32mINFO[m i.a.c.i.d.b.BufferManager(<init>):53 - Max 'memory' available for buffer allocation 2 GB
2023-12-22 09:30:57 [43mdestination[0m > 2023-12-22 09:30:57 [32mINFO[m i.a.c.i.d.FlushWorkers(start):98 - Start async buffer supervisor
2023-12-22 09:30:57 [43mdestination[0m > 2023-12-22 09:30:57 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:30:57 [43mdestination[0m > 2023-12-22 09:30:57 [32mINFO[m i.a.c.i.d.AsyncStreamConsumer(start):137 - class io.airbyte.cdk.integrations.destination_async.AsyncStreamConsumer started.
2023-12-22 09:30:57 [43mdestination[0m > 2023-12-22 09:30:57 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onStartFunction$3):137 - Preparing airbyte_raw tables in destination started for 1 streams
2023-12-22 09:30:57 [43mdestination[0m > 2023-12-22 09:30:57 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(prepareTables):108 - Preparing final tables
2023-12-22 09:30:57 [43mdestination[0m > 2023-12-22 09:30:57 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:30:57 [43mdestination[0m > 2023-12-22 09:30:57 [32mINFO[m i.a.i.b.d.t.BaseDestinationV1V2Migrator(migrateIfNecessary):26 - Assessing whether migration is necessary for stream spendesk_payables
2023-12-22 09:30:57 [43mdestination[0m > 2023-12-22 09:30:57 [32mINFO[m i.a.i.b.d.t.BaseDestinationV1V2Migrator(shouldMigrate):45 - Checking whether v1 raw table _airbyte_raw_spendesk_payables in dataset sources exists
2023-12-22 09:30:59 [43mdestination[0m > 2023-12-22 09:30:59 [32mINFO[m i.a.i.b.d.t.BaseDestinationV1V2Migrator(shouldMigrate):49 - Migration Info: Required for Sync mode: false, No existing v2 raw tables: false, A v1 raw table exists: false
2023-12-22 09:30:59 [43mdestination[0m > 2023-12-22 09:30:59 [32mINFO[m i.a.i.b.d.t.BaseDestinationV1V2Migrator(migrateIfNecessary):32 - No Migration Required for stream: spendesk_payables
2023-12-22 09:30:59 [43mdestination[0m > 2023-12-22 09:30:59 [32mINFO[m i.a.i.d.b.t.BigQueryV2TableMigrator(migrateIfNecessary):76 - No Data column Migration Required for stream sources_raw__stream_spendesk_payables
2023-12-22 09:30:59 [43mdestination[0m > 2023-12-22 09:30:59 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$prepareTablesFuture$1):129 - Final Table exists for stream spendesk_payables
2023-12-22 09:31:00 [43mdestination[0m > 2023-12-22 09:31:00 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):99 - Executing sql 1862ebb5-435e-40ba-9153-73308b97daf7: CREATE SCHEMA IF NOT EXISTS `reporting-340722`.`sources`
2023-12-22 09:31:00 [43mdestination[0m > OPTIONS(location="europe-west3");
2023-12-22 09:31:00 [43mdestination[0m > 
2023-12-22 09:31:00 [43mdestination[0m > CREATE OR REPLACE TABLE `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` (
2023-12-22 09:31:00 [43mdestination[0m >   _airbyte_raw_id STRING NOT NULL,
2023-12-22 09:31:00 [43mdestination[0m >   _airbyte_extracted_at TIMESTAMP NOT NULL,
2023-12-22 09:31:00 [43mdestination[0m >   _airbyte_meta JSON NOT NULL,
2023-12-22 09:31:00 [43mdestination[0m > `id` STRING,
2023-12-22 09:31:00 [43mdestination[0m > `type` STRING,
2023-12-22 09:31:00 [43mdestination[0m > `amount` NUMERIC,
2023-12-22 09:31:00 [43mdestination[0m > `teamId` STRING,
2023-12-22 09:31:00 [43mdestination[0m > `userId` STRING,
2023-12-22 09:31:00 [43mdestination[0m > `currency` STRING,
2023-12-22 09:31:00 [43mdestination[0m > `teamName` STRING,
2023-12-22 09:31:00 [43mdestination[0m > `companyId` STRING,
2023-12-22 09:31:00 [43mdestination[0m > `lineItems` JSON,
2023-12-22 09:31:00 [43mdestination[0m > `exportedAt` STRING,
2023-12-22 09:31:00 [43mdestination[0m > `allocations` JSON,
2023-12-22 09:31:00 [43mdestination[0m > `description` STRING,
2023-12-22 09:31:00 [43mdestination[0m > `payableDate` STRING,
2023-12-22 09:31:00 [43mdestination[0m > `costCenterId` STRING,
2023-12-22 09:31:00 [43mdestination[0m > `counterparty` JSON,
2023-12-22 09:31:00 [43mdestination[0m > `invoiceNumber` STRING,
2023-12-22 09:31:00 [43mdestination[0m > `costCenterName` STRING,
2023-12-22 09:31:00 [43mdestination[0m > `invoiceDueDate` STRING,
2023-12-22 09:31:00 [43mdestination[0m > `functionalAmount` NUMERIC,
2023-12-22 09:31:00 [43mdestination[0m > `bookkeepingStatus` STRING,
2023-12-22 09:31:00 [43mdestination[0m > `functionalCurrency` STRING,
2023-12-22 09:31:00 [43mdestination[0m > `documentaryEvidence` JSON,
2023-12-22 09:31:00 [43mdestination[0m > `analyticalProperties` JSON,
2023-12-22 09:31:00 [43mdestination[0m > `functionalExchangeRate` NUMERIC
2023-12-22 09:31:00 [43mdestination[0m > )
2023-12-22 09:31:00 [43mdestination[0m > PARTITION BY (DATE_TRUNC(_airbyte_extracted_at, DAY))
2023-12-22 09:31:00 [43mdestination[0m > CLUSTER BY `_airbyte_extracted_at`;
2023-12-22 09:31:00 [43mdestination[0m > 
2023-12-22 09:31:01 [43mdestination[0m > 2023-12-22 09:31:01 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(execute):119 - Root-level job 1862ebb5-435e-40ba-9153-73308b97daf7 completed in 854 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:31:01 [43mdestination[0m > 2023-12-22 09:31:01 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql CREATE SCHEMA IF NOT EXISTS `reporting-340722`.`sources` OPTIONS(location="europe-west3")... completed in 81 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:31:01 [43mdestination[0m > 2023-12-22 09:31:01 [32mINFO[m i.a.i.d.b.t.BigQueryDestinationHandler(lambda$execute$1):141 - Child sql CREATE OR REPLACE TABLE `reporting-340722`.`sources`.`spendesk_payables_airbyte_tmp` ( _airbyte_raw_... completed in 102 ms; processed 0 bytes; billed for 0 bytes
2023-12-22 09:31:01 [43mdestination[0m > 2023-12-22 09:31:01 [32mINFO[m i.a.i.b.d.t.DefaultTyperDeduper(lambda$prepareTablesFuture$1):138 - Using temp final table for stream spendesk_payables, will overwrite existing table at end of sync
2023-12-22 09:31:02 [43mdestination[0m > 2023-12-22 09:31:02 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onStartFunction$3):140 - Preparing staging are in destination for schema: Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, stream: spendesk_payables, target table: GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}, stage: spendesk_payables
2023-12-22 09:31:02 [43mdestination[0m > 2023-12-22 09:31:02 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(createSchemaIfNotExists):86 - Creating dataset airbyte_internal
2023-12-22 09:31:02 [43mdestination[0m > 2023-12-22 09:31:02 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(createTableIfNotExists):102 - Creating target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}
2023-12-22 09:31:02 [43mdestination[0m > 2023-12-22 09:31:02 [32mINFO[m i.a.i.d.b.BigQueryUtils(createPartitionedTableIfNotExists):228 - Partitioned table ALREADY EXISTS: GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}
2023-12-22 09:31:02 [43mdestination[0m > 2023-12-22 09:31:02 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(createStageIfNotExists):109 - Creating staging path for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/9a92e89f-1340-451b-b41c-f30326e6f048/
2023-12-22 09:31:03 [43mdestination[0m > 2023-12-22 09:31:03 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(truncateTableIfExists):207 - Truncating target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal)
2023-12-22 09:31:03 [43mdestination[0m > 2023-12-22 09:31:03 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(dropTableIfExists):175 - Deleting target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal)
2023-12-22 09:31:03 [43mdestination[0m > 2023-12-22 09:31:03 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(createTableIfNotExists):102 - Creating target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}
2023-12-22 09:31:03 [43mdestination[0m > 2023-12-22 09:31:03 [32mINFO[m i.a.i.d.b.BigQueryUtils(createPartitionedTableIfNotExists):231 - Partitioned table created successfully: GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}}
2023-12-22 09:31:03 [43mdestination[0m > 2023-12-22 09:31:03 [32mINFO[m i.a.i.d.b.BigQueryStagingConsumerFactory(lambda$onStartFunction$3):159 - Preparing tables in destination completed.
2023-12-22 09:31:06 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:31:06 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 09:31:17 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:31:17 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 09:31:28 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:31:28 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 09:31:39 [44msource[0m > Backing off _send(...) for 0.0s (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:31:39 [44msource[0m > Retrying. Sleeping for 10 seconds
2023-12-22 09:31:50 [44msource[0m > Giving up _send(...) after 6 tries (airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]})
2023-12-22 09:31:50 [44msource[0m > Max retry limit reached. Request: <PreparedRequest [GET]>, Response: <Response [500]>
2023-12-22 09:31:50 [44msource[0m > Encountered an exception while reading stream payables
Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 121, in read
    yield from self._read_stream(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 193, in _read_stream
    for record in record_iterator:
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 253, in _read_full_refresh
    for record_data_or_message in stream_instance.read_full_refresh(configured_stream.cursor_field, logger, self._slice_logger):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/streams/core.py", line 121, in read_full_refresh
    yield from self.read_records(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/declarative_stream.py", line 104, in read_records
    yield from self.retriever.read_records(stream_slice)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 304, in read_records
    for stream_data in self._read_pages(self._parse_records, self.state, stream_slice):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 282, in _read_pages
    response = self._fetch_next_page(stream_state, stream_slice, next_page_token)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 256, in _fetch_next_page
    return self.requester.send_request(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 412, in send_request
    response = self._send_with_retry(request, log_formatter=log_formatter)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 458, in _send_with_retry
    return backoff_handler(user_backoff_handler)(request, log_formatter=log_formatter)  # type: ignore
  File "/usr/local/lib/python3.9/site-packages/backoff/_sync.py", line 105, in retry
    ret = target(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/backoff/_sync.py", line 105, in retry
    ret = target(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 497, in _send
    raise UserDefinedBackoffException(backoff=custom_backoff_time, request=request, response=response)
airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]}
2023-12-22 09:31:50 [44msource[0m > Marking stream payables as STOPPED
2023-12-22 09:31:50 [44msource[0m > Finished syncing payables
2023-12-22 09:31:50 [44msource[0m > ManifestDeclarativeSource runtimes:
Syncing stream payables 0:00:56.247355
2023-12-22 09:31:50 [44msource[0m > Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]}
Traceback (most recent call last):
  File "/airbyte/integration_code/main.py", line 29, in <module>
    launch(source, sys.argv[1:])
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py", line 210, in launch
    for message in source_entrypoint.run(parsed_args):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py", line 117, in run
    yield from map(AirbyteEntrypoint.airbyte_message_to_string, self.read(source_spec, config, config_catalog, state))
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/entrypoint.py", line 159, in read
    yield from self.source.read(self.logger, config, catalog, state)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/manifest_declarative_source.py", line 134, in read
    yield from super().read(logger, config, catalog, state)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 141, in read
    raise e
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 121, in read
    yield from self._read_stream(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 193, in _read_stream
    for record in record_iterator:
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/abstract_source.py", line 253, in _read_full_refresh
    for record_data_or_message in stream_instance.read_full_refresh(configured_stream.cursor_field, logger, self._slice_logger):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/streams/core.py", line 121, in read_full_refresh
    yield from self.read_records(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/declarative_stream.py", line 104, in read_records
    yield from self.retriever.read_records(stream_slice)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 304, in read_records
    for stream_data in self._read_pages(self._parse_records, self.state, stream_slice):
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 282, in _read_pages
    response = self._fetch_next_page(stream_state, stream_slice, next_page_token)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py", line 256, in _fetch_next_page
    return self.requester.send_request(
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 412, in send_request
    response = self._send_with_retry(request, log_formatter=log_formatter)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 458, in _send_with_retry
    return backoff_handler(user_backoff_handler)(request, log_formatter=log_formatter)  # type: ignore
  File "/usr/local/lib/python3.9/site-packages/backoff/_sync.py", line 105, in retry
    ret = target(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/backoff/_sync.py", line 105, in retry
    ret = target(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/airbyte_cdk/sources/declarative/requesters/http_requester.py", line 497, in _send
    raise UserDefinedBackoffException(backoff=custom_backoff_time, request=request, response=response)
airbyte_cdk.sources.streams.http.exceptions.UserDefinedBackoffException: Request URL: http://public-api.spendesk.com/v0/payables?cursor=NDk4ODM%3D, Response Code: 500, Response Text: {"errors":[{"code":"INTERNAL_SERVER_ERROR","detail":"Sorry, something has gone wrong at our end. If this persists please contact support."}]}
2023-12-22 09:31:50 [46mplatform[0m > readFromSource: source exception
io.airbyte.workers.internal.exception.SourceException: Source process exited with non-zero exit code 1
	at io.airbyte.workers.general.BufferedReplicationWorker.readFromSource(BufferedReplicationWorker.java:365) ~[io.airbyte-airbyte-commons-worker-0.50.35.jar:?]
	at io.airbyte.workers.general.BufferedReplicationWorker.lambda$runAsyncWithHeartbeatCheck$3(BufferedReplicationWorker.java:235) ~[io.airbyte-airbyte-commons-worker-0.50.35.jar:?]
	at java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[?:?]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[?:?]
	at java.lang.Thread.run(Thread.java:1589) ~[?:?]
2023-12-22 09:31:50 [46mplatform[0m > readFromSource: done. (source.isFinished:true, fromSource.isClosed:false)
2023-12-22 09:31:57 [43mdestination[0m > 2023-12-22 09:31:57 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:31:57 [43mdestination[0m > 2023-12-22 09:31:57 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:32:57 [43mdestination[0m > 2023-12-22 09:32:57 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:32:57 [43mdestination[0m > 2023-12-22 09:32:57 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:33:57 [43mdestination[0m > 2023-12-22 09:33:57 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:33:57 [43mdestination[0m > 2023-12-22 09:33:57 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:34:57 [43mdestination[0m > 2023-12-22 09:34:57 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:34:57 [43mdestination[0m > 2023-12-22 09:34:57 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:35:57 [43mdestination[0m > 2023-12-22 09:35:57 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 20 MB (20.0 MB), % used: 0.008486082826915466 | Queue `spendesk_payables`, num records: 29, num bytes: 34.09 KB, allocated bytes: 10 MB | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:35:57 [43mdestination[0m > 2023-12-22 09:35:57 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:36:04 [43mdestination[0m > 2023-12-22 09:36:04 [32mINFO[m i.a.c.i.d.DetectStreamToFlush(getNextStreamToFlush):122 - flushing: trigger info: sources - spendesk_payables, time trigger: true , size trigger: false current threshold b: 200 MB, queue size b: 34.09 KB, penalty b: 0 bytes, after penalty b: 34.09 KB
2023-12-22 09:36:04 [43mdestination[0m > 2023-12-22 09:36:04 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):152 - Flush Worker (a26e6) -- Worker picked up work.
2023-12-22 09:36:04 [43mdestination[0m > 2023-12-22 09:36:04 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):154 - Flush Worker (a26e6) -- Attempting to read from queue namespace: sources, stream: spendesk_payables.
2023-12-22 09:36:04 [43mdestination[0m > 2023-12-22 09:36:04 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 10450847 bytes..
2023-12-22 09:36:04 [43mdestination[0m > 2023-12-22 09:36:04 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):167 - Flush Worker (a26e6) -- Batch contains: 29 records, 34.09 KB bytes.
2023-12-22 09:36:04 [43mdestination[0m > 2023-12-22 09:36:04 [32mINFO[m i.a.c.i.d.r.BaseSerializedBuffer(flush):172 - Finished writing data to becf611a-13d3-48a9-abb8-c0d9fd72700e10852944678804956003.csv.gz (5 KB)
2023-12-22 09:36:04 [43mdestination[0m > 2023-12-22 09:36:04 [32mINFO[m i.a.i.d.b.BigQueryAsyncFlush(flush):61 - Flushing CSV buffer for stream spendesk_payables (5 KB) to staging
2023-12-22 09:36:04 [43mdestination[0m > 2023-12-22 09:36:04 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(uploadRecordsToStage):116 - Uploading records to staging for stream spendesk_payables (dataset airbyte_internal): ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/9a92e89f-1340-451b-b41c-f30326e6f048/
2023-12-22 09:36:05 [43mdestination[0m > 2023-12-22 09:36:05 [32mINFO[m a.m.s.StreamTransferManager(getMultiPartOutputStreams):329 - Initiated multipart upload to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/9a92e89f-1340-451b-b41c-f30326e6f048/985b69f7-aaca-4cd4-a1c9-65dcf70952e9.csv.gz with full ID ABPnzm7dLhQMw78UUnTuUIIrZw1EgFNBZxTY2-4k00grLgDCTOV54MdnMmMJzTYJROajZgVc
2023-12-22 09:36:05 [43mdestination[0m > 2023-12-22 09:36:05 [32mINFO[m a.m.s.MultiPartOutputStream(close):158 - Called close() on [MultipartOutputStream for parts 1 - 10000]
2023-12-22 09:36:05 [43mdestination[0m > 2023-12-22 09:36:05 [32mINFO[m a.m.s.StreamTransferManager(complete):367 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/9a92e89f-1340-451b-b41c-f30326e6f048/985b69f7-aaca-4cd4-a1c9-65dcf70952e9.csv.gz with id ABPnzm7dL...JROajZgVc]: Uploading leftover stream [Part number 1 containing 0.01 MB]
2023-12-22 09:36:05 [43mdestination[0m > 2023-12-22 09:36:05 [32mINFO[m a.m.s.StreamTransferManager(uploadStreamPart):558 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/9a92e89f-1340-451b-b41c-f30326e6f048/985b69f7-aaca-4cd4-a1c9-65dcf70952e9.csv.gz with id ABPnzm7dL...JROajZgVc]: Finished uploading [Part number 1 containing 0.01 MB]
2023-12-22 09:36:05 [43mdestination[0m > 2023-12-22 09:36:05 [32mINFO[m a.m.s.StreamTransferManager(complete):395 - [Manager uploading to ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/9a92e89f-1340-451b-b41c-f30326e6f048/985b69f7-aaca-4cd4-a1c9-65dcf70952e9.csv.gz with id ABPnzm7dL...JROajZgVc]: Completed
2023-12-22 09:36:05 [43mdestination[0m > 2023-12-22 09:36:05 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(loadDataIntoBucket):214 - Uploaded buffer file to storage: becf611a-13d3-48a9-abb8-c0d9fd72700e10852944678804956003.csv.gz -> ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/9a92e89f-1340-451b-b41c-f30326e6f048/985b69f7-aaca-4cd4-a1c9-65dcf70952e9.csv.gz (filename: 985b69f7-aaca-4cd4-a1c9-65dcf70952e9.csv.gz)
2023-12-22 09:36:05 [43mdestination[0m > 2023-12-22 09:36:05 [32mINFO[m i.a.c.i.d.s.S3StorageOperations(uploadRecordsToBucket):131 - Successfully loaded records to stage ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/9a92e89f-1340-451b-b41c-f30326e6f048/ with 0 re-attempt(s)
2023-12-22 09:36:05 [43mdestination[0m > 2023-12-22 09:36:05 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):134 - Uploading records from staging files to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): 985b69f7-aaca-4cd4-a1c9-65dcf70952e9.csv.gz
2023-12-22 09:36:05 [43mdestination[0m > 2023-12-22 09:36:05 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):138 - Uploading staged file: gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/9a92e89f-1340-451b-b41c-f30326e6f048/985b69f7-aaca-4cd4-a1c9-65dcf70952e9.csv.gz
2023-12-22 09:36:05 [43mdestination[0m > 2023-12-22 09:36:05 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):147 - [JobId{project=reporting-340722, job=95275556-5bbb-4761-aa45-c4a364058cd3, location=europe-west3}] Created a new job to upload record(s) to target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal): Job{job=JobId{project=reporting-340722, job=95275556-5bbb-4761-aa45-c4a364058cd3, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703237765788, endTime=null, startTime=1703237765876, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=jyMaO0QyWUcqlx8Bt855Cg==, generatedId=reporting-340722:europe-west3.95275556-5bbb-4761-aa45-c4a364058cd3, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/95275556-5bbb-4761-aa45-c4a364058cd3?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/9a92e89f-1340-451b-b41c-f30326e6f048/985b69f7-aaca-4cd4-a1c9-65dcf70952e9.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}
2023-12-22 09:36:05 [43mdestination[0m > 2023-12-22 09:36:05 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):451 - Waiting for job finish Job{job=JobId{project=reporting-340722, job=95275556-5bbb-4761-aa45-c4a364058cd3, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703237765788, endTime=null, startTime=1703237765876, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=jyMaO0QyWUcqlx8Bt855Cg==, generatedId=reporting-340722:europe-west3.95275556-5bbb-4761-aa45-c4a364058cd3, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/95275556-5bbb-4761-aa45-c4a364058cd3?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/9a92e89f-1340-451b-b41c-f30326e6f048/985b69f7-aaca-4cd4-a1c9-65dcf70952e9.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}}. Status: JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:36:08 [43mdestination[0m > 2023-12-22 09:36:08 [32mINFO[m i.a.i.d.b.BigQueryUtils(waitForJobFinish):453 - Job finish Job{job=JobId{project=reporting-340722, job=95275556-5bbb-4761-aa45-c4a364058cd3, location=europe-west3}, status=JobStatus{state=RUNNING, error=null, executionErrors=null}, statistics=LoadStatistics{creationTime=1703237765788, endTime=null, startTime=1703237765876, numChildJobs=null, parentJobId=null, scriptStatistics=null, reservationUsage=null, transactionInfo=null, sessionInfo=null, inputBytes=null, inputFiles=null, outputBytes=null, outputRows=null, badRecords=null}, userEmail=analytics@reporting-340722.iam.gserviceaccount.com, etag=jyMaO0QyWUcqlx8Bt855Cg==, generatedId=reporting-340722:europe-west3.95275556-5bbb-4761-aa45-c4a364058cd3, selfLink=https://www.googleapis.com/bigquery/v2/projects/reporting-340722/jobs/95275556-5bbb-4761-aa45-c4a364058cd3?location=europe-west3, configuration=LoadJobConfiguration{type=LOAD, destinationTable=GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, projectId=reporting-340722, tableId=sources_raw__stream_spendesk_payables}}, decimalTargetTypes=null, destinationEncryptionConfiguration=null, createDisposition=null, writeDisposition=WRITE_APPEND, formatOptions=CsvOptions{type=CSV, allowJaggedRows=null, allowQuotedNewLines=null, encoding=null, fieldDelimiter=null, quote=null, skipLeadingRows=null, preserveAsciiControlCharacters=null}, nullMarker=null, maxBadRecords=null, schema=Schema{fields=[Field{name=_airbyte_raw_id, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_extracted_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_loaded_at, type=TIMESTAMP, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}, Field{name=_airbyte_data, type=STRING, mode=null, description=null, policyTags=null, maxLength=null, scale=null, precision=null, defaultValueExpression=null, collation=null}]}, ignoreUnknownValue=null, sourceUris=[gs://ucm-analytics-bucket/ucm-analytics-bucket/sources/airbyte_internal_spendesk_payables/2023/12/22/09/9a92e89f-1340-451b-b41c-f30326e6f048/985b69f7-aaca-4cd4-a1c9-65dcf70952e9.csv.gz], schemaUpdateOptions=null, autodetect=null, timePartitioning=null, clustering=null, useAvroLogicalTypes=null, labels=null, jobTimeoutMs=300000, rangePartitioning=null, hivePartitioningOptions=null, referenceFileSchemaUri=null, connectionProperties=null, createSession=null}} with status JobStatus{state=RUNNING, error=null, executionErrors=null}
2023-12-22 09:36:08 [43mdestination[0m > 2023-12-22 09:36:08 [32mINFO[m i.a.i.d.b.BigQueryGcsOperations(copyIntoTableFromStage):152 - [JobId{project=reporting-340722, job=95275556-5bbb-4761-aa45-c4a364058cd3, location=europe-west3}] Target table GenericData{classInfo=[datasetId, projectId, tableId], {datasetId=airbyte_internal, tableId=sources_raw__stream_spendesk_payables}} (dataset airbyte_internal) is successfully appended with staging files
2023-12-22 09:36:08 [43mdestination[0m > 2023-12-22 09:36:08 [32mINFO[m i.a.c.i.d.r.FileBuffer(deleteFile):109 - Deleting tempFile data becf611a-13d3-48a9-abb8-c0d9fd72700e10852944678804956003.csv.gz
2023-12-22 09:36:08 [43mdestination[0m > 2023-12-22 09:36:08 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 0 bytes..
2023-12-22 09:36:08 [43mdestination[0m > 2023-12-22 09:36:08 [32mINFO[m i.a.c.i.d.GlobalMemoryManager(free):88 - Freeing 34913 bytes..
2023-12-22 09:36:08 [43mdestination[0m > 2023-12-22 09:36:08 [32mINFO[m i.a.c.i.d.FlushWorkers(lambda$flush$1):176 - Flush Worker (a26e6) -- Worker finished flushing. Current queue size: 0
2023-12-22 09:36:57 [43mdestination[0m > 2023-12-22 09:36:57 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:36:57 [43mdestination[0m > 2023-12-22 09:36:57 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
2023-12-22 09:37:57 [43mdestination[0m > 2023-12-22 09:37:57 [32mINFO[m i.a.c.i.d.b.BufferManager(printQueueInfo):118 - [ASYNC QUEUE INFO] Global: max: 2.3 GB, allocated: 10 MB (10.0 MB), % used: 0.004243041413457733 | Queue `spendesk_payables`, num records: 0, num bytes: 0 bytes, allocated bytes: 0 bytes | State Manager memory usage: Allocated: 10 MB, Used: 0 bytes, percentage Used 0.000000
2023-12-22 09:37:57 [43mdestination[0m > 2023-12-22 09:37:57 [32mINFO[m i.a.c.i.d.FlushWorkers(printWorkerInfo):146 - [ASYNC WORKER INFO] Pool queue size: 0, Active threads: 0
